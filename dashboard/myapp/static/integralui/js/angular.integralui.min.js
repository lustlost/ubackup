/*
 filename: angular.integralui.min.js
 version : 3.0.0
 Copyright ï¿½ 2014-2016 Lidor Systems. All rights reserved.

 This file is part of the "IntegralUI" Library.

 The contents of this file are subject to the IntegralUI Studio for Web License, and may not be used except in compliance with the License.
 A copy of the License should have been installed in the product's root installation directory or it can be found at
 http://www.lidorsystems.com/products/web/studio/license-agreement.aspx.

 This SOFTWARE is provided "AS IS", WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language
 governing rights and limitations under the License. Any infringement will be prosecuted under applicable laws.
 */
angular.module("integralui", []).directive("iuiTransclude", ["$timeout", "IntegralUIInternalService", function (e, d) {
    return {
        link: function (b, a, f) {
            var c = null, h = e(function () {
                for (var b = a.parent(); "body" !== b[0].tagName.toLowerCase();) {
                    if (b[0].attributes.name) {
                        c = d.getCtrl(b[0].attributes.name.value);
                        break
                    }
                    b = b.parent()
                }
                e.cancel(h)
            }, 1);
            b.$watch(function () {
                return c ? c[f.iuiTransclude] : null
            }, function (b) {
                a.empty();
                a.append(b)
            })
        }
    }
}]).directive("iuiFocus", ["$timeout", "IntegralUIInternalService", function (e, d) {
    return {
        restrict: "A", link: function (b, a, f) {
            var c = {active: !1};
            b.$watch(f.iuiFocus, function (a, b) {
                a != b && h(a)
            }, !0);
            var h = function (a) {
                c = a ? {active: d.isFieldAvailable(a.active, !1)} : {active: !1};
                n()
            }, n = function () {
                if (c && 0 != c.active)var g = e(function () {
                    a[0].focus();
                    e.cancel(g)
                }, 1)
            };
            h(b.$eval(f.iuiFocus))
        }
    }
}]).directive("iuiResize", ["$window", "$timeout", "$interval", "IntegralUIInternalService", function (e, d, b, a) {
    return {
        restrict: "A", link: function (f, c, h, n) {
            var g = c.parent(), p = angular.element(e), m = getComputedStyle(c[0]).opacity, m = m && "" != m ? m : 1;
            c.css("opacity", "0");
            var t = g[0].offsetWidth, l = g[0].offsetHeight, u = parseInt(getComputedStyle(c[0]).height, 10), x = parseInt(getComputedStyle(c[0]).width, 10), k = f.$eval(h.iuiResize), v = void 0 != k.delay ? k.delay : 100, q = function () {
                if (k = f.$eval(h.iuiResize)) {
                    var b = a.isFieldAvailable(k.ref, "window"), m = x, e = u, t = parseInt(a.isFieldAvailable(k.minWidth, 0), 10), l = parseInt(a.isFieldAvailable(k.minHeight, 0), 10), n = parseInt(a.isFieldAvailable(k.maxWidth, 9999999), 10), q = parseInt(a.isFieldAvailable(k.maxHeight, 9999999), 10);
                    switch (b) {
                        case "parent":
                            var r = a.getPadding(g[0]), b = g[0].clientWidth - (r.left + r.right), r = g[0].clientHeight - (r.top + r.bottom);
                            g && (k.width && (m = Math.floor(k.width * b)), k.height && (e = Math.floor(k.height * r)));
                            break;
                        case "page":
                            k.width && (m = Math.floor(k.width * p[0].innerWidth));
                            k.height && (e = Math.floor(k.height * p[0].innerHeight));
                            break;
                        default:
                            k.width && (m = Math.floor(k.width * p[0].outerWidth)), k.height && (e = Math.floor(k.height * p[0].outerHeight))
                    }
                    m < t && (m = t);
                    m > n && (m = n);
                    e < l && (e = l);
                    e > q && (e = q);
                    c.css("width", m + "px");
                    c.css("height", e + "px");
                    var v = d(function () {
                        f.$apply();
                        d.cancel(v)
                    }, 1)
                }
            }, y = d(function () {
                q();
                if (0 == v)c.css("opacity", m); else var a = m / 3, g = b(function () {
                    a > m ? (c.css("opacity", m), b.cancel(g)) : (c.css("opacity", a / m), a += m / 3)
                }, 10);
                d.cancel(y)
            }, v), w = b(function () {
                k = f.$eval(h.iuiResize);
                if ("parent" == a.isFieldAvailable(k.ref, "window") && g[0].offsetWidth != t || g[0].offsetHeight != l)q(), t = g[0].offsetWidth, l = g[0].offsetHeight
            }, v);
            f.$watch(h.iuiResize, function (a, g) {
                a != g && q()
            }, !0);
            p.bind("resize", function (g) {
                k = f.$eval(h.iuiResize);
                "parent" != a.isFieldAvailable(k.ref, "window") && q()
            });
            f.$on("$destroy", function (a) {
                w && b.cancel(w);
                p && p.unbind("resize")
            })
        }
    }
}]).directive("iuiClass", function () {
    return {
        restrict: "A", link: function (e, d, b) {
            b.$observe("iuiClass", function (a, b) {
                a != b && (d.removeAttr("class"), "" != a && d.addClass(a))
            })
        }
    }
}).directive("iuiStyle", function () {
    return {
        restrict: "A", link: function (e, d, b) {
            b.$observe("iuiStyle", function (a, b) {
                if (a != b)for (var c = a.split(";"), e = 0; e < c.length; e++) {
                    var n = c[e].split(":");
                    2 == n.length && d.css(n[0], n[1])
                }
            })
        }
    }
}).directive("iuiShow", function () {
    return {
        restrict: "A", link: function (e, d, b) {
            b.$observe("iuiShow", function (a, f) {
                a != f && ("false" != a ? "true" == b.showDefault ? d.css("display", "inline") : d.css("display", "block") : d.css("display", "none"))
            })
        }
    }
}).factory("IntegralUIPublicService", function () {
    var e = null;
    return {
        clearTempData: function () {
            e = null
        }, getTempData: function () {
            return e
        }, setTempData: function (d) {
            e = d
        }
    }
}).factory("IntegralUIDataService", function () {
    return function (e) {
        if (!e)return null;
        var d = e, b = "id", a = "pid", f = "items", c = "text";
        this.updateDataFields = function (g) {
            g && (b = g.id ? g.id : "id", a = g.pid ? g.pid : "pid", f = g.objects ? g.objects : "items", c = g.text ? g.text : "text")
        };
        this.updateDataFields(d.fields);
        this.update = function (a) {
            a && (d = a, this.updateDataFields(d.fields))
        };
        var h = angular.isDefined(d.objects);
        this.clear = function (a, b) {
            var c = this.getList(a);
            0 < c.length && d.events && d.events.clear({e: {parent: a}});
            c.length = 0;
            b && b(a)
        };
        this.insertAt = function (a, b, c, f) {
            this.insert(a, b, c, null, !1, f)
        };
        this.insert = function (g, c, f, e, l, n) {
            h && !1 !== (d.events ? d.events.objAdding({e: {obj: g}}) : !0) && g && (g[a] = f ? f[b] : "", f = this.getList(f), 0 > c || null === c || void 0 === c ? f.push(g) : (c = Math.max(Math.min(c, f.length), 0), f.splice(c, 0, g)), g[b] || (g[b] = this.getUniqueId()), d.events && d.events.objAdded({e: {obj: g}}), n && n())
        };
        this.insertByRef = function (a, b, c, f) {
            if (h && a && b) {
                var d = this.getParent(b), e = this.getList(d), e = this.getIndexOf(b, e);
                c && (e += 1);
                this.insert(a, e, d, b, c, f);
                return e
            }
        };
        this.removeAt = function (b, c, f, e) {
            if (h) {
                var l = null;
                b && (f = this.getParent(b), l = this.getList(f), c = this.getIndexOf(b, l));
                if (null === c || void 0 === c)return !1;
                l = this.getList(f);
                if (0 <= c && c < l.length && (b = l[c], !1 !== (d.events ? d.events.objRemoving({e: {obj: b}}) : !0)))return b[a] = "", l.splice(c, 1), d.events && d.events.objRemoved({e: {obj: b}}), e && e(b, l, c, f), !0
            }
            return !1
        };
        this.isIndexinRange = function (a) {
            return h && 0 <= a && a < d.objects.length ? !0 : !1
        };
        this.moveObject = function (a, b) {
            h && this.isIndexinRange(a) && this.isIndexinRange(b) && d.objects.splice(b, 0, d.objects.splice(a, 1)[0])
        };
        this.getNewIndex = function (a, b, c) {
            if (h && a && b)return a = this.getParent(b), a = this.getList(a), b = this.getIndexOf(b, a), c && (b += 1), b
        };
        this.getObjectByIndex = function (a) {
            return h && this.isIndexinRange(a) ? d.objects[a] : null
        };
        this.findObjectById = function (a) {
            return a ? n(d.objects, a) : null
        };
        this.findObjectByText = function (a) {
            return a ? n(d.objects, a, "text") : null
        };
        var n = function (a, d, e) {
            var h = null;
            if (a && d)for (var l = 0, u = !1; !h && l < a.length;) {
                switch (e) {
                    case "text":
                        a[l][c] && (u = a[l][c].toString() === d.toString());
                        break;
                    default:
                        a[l][b] && (u = a[l][b].toString() === d.toString())
                }
                h = u ? a[l] : n(a[l][f], d, e);
                l++
            }
            return h
        };
        this.getIndexOf = function (a, c) {
            var f = -1;
            c || (c = this.getList());
            if (a && c)for (var d = 0; d < c.length; d++)if (c[d][b] && a[b] && c[d][b].toString() === a[b].toString()) {
                f = d;
                break
            }
            return f
        };
        this.getList = function (a) {
            return a ? (a[f] || (a[f] = []), a[f]) : d.objects
        };
        this.findParent = function (c, d) {
            var e = null;
            if (c && d)for (var h = 0; !e && h < d.length;)e = d[h][b] && c[a] && d[h][b].toString() === c[a].toString() ? d[h] : this.findParent(c, d[h][f]), h++;
            return e
        };
        this.getParent = function (a) {
            return a ? this.findParent(a, d.objects) : null
        };
        this.getUniqueId = function (a) {
            function b() {
                return (65536 * (1 + Math.random()) | 0).toString(16).substring(1)
            }

            a = a || "-";
            return b() + b() + a + b() + a + b() + a + b() + a + b() + b() + b()
        }
    }
}).factory("IntegralUIDragDrop", function () {
    var e = {
        dropPos: -1,
        source: null,
        sourceCtrl: null,
        sourceCollection: null,
        sourceIndex: -1,
        target: null,
        type: ""
    }, d = function (b, a, f) {
        return b >= f.left && b <= f.right && a >= f.top && a <= f.bottom ? !0 : !1
    };
    return {
        clearData: function () {
            e = {
                dropPos: -1,
                source: null,
                sourceCtrl: null,
                sourceCollection: null,
                sourceIndex: -1,
                target: null,
                type: ""
            }
        }, getData: function () {
            return e
        }, setData: function (b) {
            b && (isNaN(b.dropPos) || (e.dropPos = b.dropPos), b.source && (e.source = b.source), b.sourceCtrl && (e.sourceCtrl = b.sourceCtrl), b.sourceCollection && (e.sourceCollection = b.sourceCollection), isNaN(b.sourceIndex) || (e.sourceIndex = b.sourceIndex), b.target && (e.target = b.target), b.type && (e.type = b.type))
        }, hitTest: function (b, a, f) {
            return d(b, a, f)
        }, getDropPos: function (b, a, f, c) {
            if (f)a:{
                f = {left: a.x, top: a.y, right: a.x + a.width, bottom: a.y + a.height};
                if ("horizontal" === c) {
                    f.right = a.x + a.width / 2;
                    if (d(b.x, b.y, f)) {
                        b = 1;
                        break a
                    }
                    f.left = f.right;
                    f.right = a.x + a.width
                } else {
                    f.bottom = a.y + a.height / 2;
                    if (d(b.x, b.y, f)) {
                        b = 1;
                        break a
                    }
                    f.top = f.bottom;
                    f.bottom = a.y + a.height
                }
                b = d(b.x, b.y, f) ? 2 : -1
            } else"horizontal" === c ? (c = {
                left: a.x + a.width / 4,
                top: a.y,
                right: a.x + 3 * a.width / 4,
                bottom: a.y + a.height
            }, d(b.x, b.y, c) ? b = 0 : (c.right = c.left, c.left = a.x, d(b.x, b.y, c) ? b = 1 : (c.left = a.x + 3 * a.width / 4, c.right = a.x + a.width, b = d(b.x, b.y, c) ? 2 : -1))) : (c = {
                left: a.x,
                top: a.y + a.height / 4,
                right: a.x + a.width,
                bottom: a.y + 3 * a.height / 4
            }, d(b.x, b.y, c) ? b = 0 : (c.bottom = c.top, c.top = a.y, d(b.x, b.y, c) ? b = 1 : (c.top = a.y + 3 * a.height / 4, c.bottom = a.y + a.height, b = d(b.x, b.y, c) ? 2 : -1)));
            return b
        }
    }
}).factory("IntegralUIInternalService", ["$rootScope", "$window", function (e, d) {
    var b = null;
    return {
        getCtrl: function (a) {
            e.$broadcast(a + "-get-ctrl");
            a = this.getTempData();
            this.clearTempData();
            return a ? a : null
        }, getUniqueId: function (a, b) {
            function c() {
                return (65536 * (1 + Math.random()) | 0).toString(16).substring(1)
            }

            var d = b || "-", d = c() + c() + d + c() + d + c() + d + c() + d + c() + c() + c();
            a && (d = d.substring(0, a));
            return d
        }, isBoolean: function (a) {
            return a ? "boolean" == typeof a : !1
        }, isEnabled: function (a) {
            return a || void 0 === a ? !0 : !1
        }, isEqual: function (a, b) {
            return a && b ? a.toString() === b.toString() : !1
        }, isFieldAvailable: function (a, b) {
            return void 0 != a ? a : b
        }, isImage: function (a) {
            return a ? a instanceof HTMLImageElement : !1
        }, isNumber: function (a) {
            return a ? "number" == typeof a : !1
        }, isObject: function (a) {
            return a ? "object" == typeof a && null != a && !Array.isArray(a) : !1
        }, isPercent: function (a) {
            return a && (a = a.toString(), "%" == a.substring(a.length - 1)) ? !0 : !1
        }, isSelected: function (a) {
            return a && a.selected ? !0 : !1
        }, isString: function (a) {
            return a ? "string" == typeof a || a instanceof String : !1
        }, clearTempData: function () {
            b = null
        }, getTempData: function () {
            return b
        }, setTempData: function (a) {
            b = a
        }, getBodyElem: function (a) {
            for (var b = null; a;) {
                if (a === document.getElementsByTagName("body")[0]) {
                    b = a;
                    break
                }
                a = a.offsetParent
            }
            return b
        }, checkHit: function (a, b, c) {
            return a >= c.left && a <= c.right && b >= c.top && b <= c.bottom ? !0 : !1
        }, getBorderWidth: function (a) {
            return a ? {
                top: parseInt(getComputedStyle(a)["border-top-width"], 10),
                right: parseInt(getComputedStyle(a)["border-right-width"], 10),
                bottom: parseInt(getComputedStyle(a)["border-bottom-width"], 10),
                left: parseInt(getComputedStyle(a)["border-left-width"], 10)
            } : {top: 0, right: 0, bottom: 0, left: 0}
        }, getMargin: function (a) {
            return a ? {
                top: parseInt(getComputedStyle(a)["margin-top"], 10),
                right: parseInt(getComputedStyle(a)["margin-right"], 10),
                bottom: parseInt(getComputedStyle(a)["margin-bottom"], 10),
                left: parseInt(getComputedStyle(a)["margin-left"], 10)
            } : {top: 0, right: 0, bottom: 0, left: 0}
        }, getPadding: function (a) {
            return a ? {
                top: parseInt(getComputedStyle(a)["padding-top"], 10),
                right: parseInt(getComputedStyle(a)["padding-right"], 10),
                bottom: parseInt(getComputedStyle(a)["padding-bottom"], 10),
                left: parseInt(getComputedStyle(a)["padding-left"], 10)
            } : {top: 0, right: 0, bottom: 0, left: 0}
        }, getMousePos: function (a) {
            return {
                x: a.pageX ? a.pageX : a.originalEvent ? a.originalEvent.pageX : 0,
                y: a.pageY ? a.pageY : a.originalEvent ? a.originalEvent.pageY : 0
            }
        }, getClientMousePos: function (a, b) {
            if (a && b) {
                b = angular.element(b);
                var c = b[0].getBoundingClientRect(), e = angular.element(d)[0].pageXOffset, n = angular.element(d)[0].pageYOffset, g = this.getMousePos(a);
                g.x -= c.left + e;
                g.y -= c.top + n;
                return g
            }
            return {x: 0, y: 0}
        }, getPageRect: function (a) {
            if (a) {
                a = angular.element(a);
                a = a[0].getBoundingClientRect();
                var b = angular.element(d)[0].pageXOffset, c = angular.element(d)[0].pageYOffset;
                a.left -= b;
                a.top -= c;
                a.right = a.left + a.width;
                a.bottom = a.top + a.height;
                return a
            }
            return {left: 0, top: 0, right: 0, bottom: 0}
        }, getTouchData: function (a) {
            return a.changedTouches ? a.changedTouches : a.originalEvent ? a.originalEvent.changedTouches : null
        }
    }
}]);