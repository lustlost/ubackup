/*
  filename: angular.integralui.treegrid.min.js
  version : 3.0.003
  Copyright © 2014-2016 Lidor Systems. All rights reserved.

  This file is part of the "IntegralUI" Library. 
                                                                   
  The contents of this file are subject to the IntegralUI Studio for Web License, and may not be used except in compliance with the License.
  A copy of the License should have been installed in the product's root installation directory or it can be found at
  http://www.lidorsystems.com/products/web/studio/license-agreement.aspx.
                                                            
  This SOFTWARE is provided "AS IS", WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language 
  governing rights and limitations under the License. Any infringement will be prosecuted under applicable laws.                           
*/
angular.module("integralui").factory("IntegralUITreeGridService",["$rootScope",function(c){var n=null;return{addColumn:function(e,f){c.$broadcast(e+"-add-column",f)},clearColumns:function(e){c.$broadcast(e+"-clear-columns")},insertColumnAt:function(e,f,p){c.$broadcast(e+"-insert-column-at",f,p)},insertColumnBefore:function(e,f,p){c.$broadcast(e+"-insert-column-before",f,p)},insertColumnAfter:function(e,f,p){c.$broadcast(e+"-insert-column-after",f,p)},removeColumn:function(e,f){c.$broadcast(e+"-remove-column",
f)},removeColumnAt:function(e,f){c.$broadcast(e+"-remove-column-at",f)},addRow:function(e,f,p){c.$broadcast(e+"-add-row",f,p)},clearRows:function(e,f){c.$broadcast(e+"-clear-rows",f)},insertRowAt:function(e,f,p,l){c.$broadcast(e+"-insert-row-at",f,p,l)},insertRowBefore:function(e,f,p){c.$broadcast(e+"-insert-row-before",f,p)},insertRowAfter:function(e,f,p){c.$broadcast(e+"-insert-row-after",f,p)},removeRow:function(e,f){c.$broadcast(e+"-remove-row",f)},removeRowAt:function(e,f,p){c.$broadcast(e+"-remove-row-at",
f,p)},exportToJSON:function(e,f,p,l,n){c.$broadcast(e+"-export-json",f,p,l,n);e=this.getTempData();this.clearTempData();return e?e:""},loadData:function(e,f,p,l,n){c.$broadcast(e+"-load-data",f,p,l,n)},openEditor:function(e,f){c.$broadcast(e+"-open-editor",f)},closeEditor:function(e,f){c.$broadcast(e+"-close-editor",f)},collapse:function(e,f){c.$broadcast(e+"-collapse",f)},expand:function(e,f){c.$broadcast(e+"-expand",f)},expandColIndex:function(e,f){c.$broadcast(e+"-expand-col-index",f)},toggle:function(e,
f){c.$broadcast(e+"-toggle",f)},filter:function(e,f,p){c.$broadcast(e+"-filter",f,p)},findRowById:function(e,f){c.$broadcast(e+"-find-row-by-id",f);var p=this.getTempData();this.clearTempData();return p?p:null},findRowByPath:function(e,f,p){c.$broadcast(e+"-find-row-by-path",f,p);e=this.getTempData();this.clearTempData();return e?e:null},findRowByText:function(e,f){c.$broadcast(e+"-find-row-by-text",f);var p=this.getTempData();this.clearTempData();return p?p:null},getCellAt:function(e,f){c.$broadcast(e+
"-get-cell-at",f);var p=this.getTempData();this.clearTempData();return p?p:null},getRowAt:function(e,f){c.$broadcast(e+"-get-row-at",f);var p=this.getTempData();this.clearTempData();return p?p:null},getRowParent:function(e,f){c.$broadcast(e+"-get-row-parent",f);var p=this.getTempData();this.clearTempData();return p?p:null},focus:function(e,f){c.$broadcast(e+"-focus",f)},clearTempData:function(){n=null},ensureVisible:function(e,f){c.$broadcast(e+"-ensure-visible",f)},getTempData:function(){return n},
getRowLevel:function(e,f){c.$broadcast(e+"-get-row-level",f);var p=this.getTempData();this.clearTempData();return p?p:0},getFlatList:function(e,f){c.$broadcast(e+"-get-flat-list",f);var p=this.getTempData();this.clearTempData();return p?p:[]},getFullPath:function(e,f){c.$broadcast(e+"-get-full-path",f);var p=this.getTempData();this.clearTempData();return p?p:""},getHoverColumn:function(e,f){c.$broadcast(e+"-get-hover-column",f);var p=this.getTempData();this.clearTempData();return p?p:null},getList:function(e,
f){c.$broadcast(e+"-get-list",f);var p=this.getTempData();this.clearTempData();return p?p:[]},setTempData:function(c){n=c},topRow:function(e,f){if(f)c.$broadcast(e+"-set-top-row",f);else return c.$broadcast(e+"-get-top-row"),f=this.getTempData(),this.clearTempData(),f?f:null},beginLoad:function(e,f,p){c.$broadcast(e+"-begin-load",f,p)},endLoad:function(e,f){c.$broadcast(e+"-end-load",f)},moveColumn:function(e,f,p){c.$broadcast(e+"-move-column",f,p)},moveRow:function(e,f,p,l,n){c.$broadcast(e+"-move-row",
f,p,l,n)},getScrollPos:function(e){c.$broadcast(e+"-get-scroll-pos");e=this.getTempData();this.clearTempData();return e?e:{x:0,y:0}},getMaxScrollPos:function(e){c.$broadcast(e+"-get-max-scroll-pos");e=this.getTempData();this.clearTempData();return e?e:{x:0,y:0}},setScrollPos:function(e,f){c.$broadcast(e+"-set-scroll-pos",f)},scrollTo:function(e,f,p){c.$broadcast(e+"-scroll-to",f,p)},currentPage:function(e,f){if(void 0!=f&&null!=f)c.$broadcast(e+"-set-current-page",f);else{c.$broadcast(e+"-get-current-page");
var p=this.getTempData();this.clearTempData();return void 0!=p?p:-1}},firstPage:function(e){c.$broadcast(e+"-first-page")},lastPage:function(e){c.$broadcast(e+"-last-page")},nextPage:function(e){c.$broadcast(e+"-next-page")},prevPage:function(e){c.$broadcast(e+"-prev-page")},clearSelection:function(e){c.$broadcast(e+"-clear-selection")},selectedColumn:function(e,f){if(f)c.$broadcast(e+"-set-selected-column",f);else{c.$broadcast(e+"-get-selected-column");var p=this.getTempData();this.clearTempData();
return p?p:null}},selectedRow:function(e,f){if(f)c.$broadcast(e+"-set-selected-row",f);else{c.$broadcast(e+"-get-selected-row");var p=this.getTempData();this.clearTempData();return p?p:null}},selectedRows:function(e,f){if(f)c.$broadcast(e+"-set-selected-rows",f);else{c.$broadcast(e+"-get-selected-rows");var p=this.getTempData();this.clearTempData();return p?p:null}},sort:function(e,f,p,l){c.$broadcast(e+"-sort",f,p,l)},refresh:function(e,f,p){c.$broadcast(e+"-refresh",f,p)},resumeLayout:function(e){c.$broadcast(e+
"-resume-layout")},suspendLayout:function(e){c.$broadcast(e+"-suspend-layout")},updateLayout:function(e){c.$broadcast(e+"-update-layout")},updateView:function(e){c.$broadcast(e+"-update-view")}}}]).controller("IntegralUITreeGridController",["$scope","$element","$timeout","$window","$interval","IntegralUIInternalService","IntegralUIDataService","IntegralUITreeGridService","IntegralUIDragDrop","IntegralUIFilter",function(c,n,e,f,p,l,oa,h,r,Qb){var a=this;this.suppressProcess=!1;this.hoverCell=this.hoverRow=
this.hoverColumn=null;a.defaultCheckBoxStyle={general:"iui-checkbox",box:{general:"iui-checkbox-box",disabled:"iui-checkbox-box-disabled",checked:"iui-checkbox-checked",indeterminate:"iui-checkbox-indeterminate",unchecked:"iui-checkbox-unchecked"}};a.defaultStyle={general:"iui-treegrid",column:{general:{content:"iui-treegrid-column-cell-content",disabled:"iui-treegrid-column-disabled",normal:"iui-treegrid-column",hovered:"iui-treegrid-column-hovered",selected:"iui-treegrid-column-selected"},header:{content:"iui-treegrid-column-header-cell-content",
disabled:"iui-treegrid-column-header-disabled",normal:"iui-treegrid-column-header",hovered:"iui-treegrid-column-header-hovered",selected:"iui-treegrid-column-header-selected"},body:{content:"iui-treegrid-column-body-cell-content",disabled:"iui-treegrid-column-body-disabled",normal:"iui-treegrid-column-body",hovered:"iui-treegrid-column-body-hovered",selected:"iui-treegrid-column-body-selected"},footer:{content:"iui-treegrid-column-footer-cell-content",disabled:"iui-treegrid-column-footer-disabled",
normal:"iui-treegrid-column-footer",hovered:"iui-treegrid-column-footer-hovered",selected:"iui-treegrid-column-footer-selected"}},row:{general:{disabled:"iui-treegrid-row-disabled",focused:"iui-treegrid-row-focused",normal:"iui-treegrid-row",hovered:"iui-treegrid-row-hovered",selected:"iui-treegrid-row-selected"},checkBox:{general:"iui-checkbox",box:{general:"iui-checkbox-box",disabled:"iui-checkbox-box-disabled",checked:"iui-checkbox-checked",indeterminate:"iui-checkbox-indeterminate",unchecked:"iui-checkbox-unchecked"}},
expandBox:{general:"iui-treegrid-expand-box",animated:"iui-treegrid-expand-box-load",expanded:"iui-treegrid-expand-box-open",collapsed:"iui-treegrid-expand-box-close"},cell:{content:"iui-treegrid-row-cell-content",general:"iui-treegrid-row-cell",disabled:"iui-treegrid-row-cell-disabled",focused:"iui-treegrid-row-cell-focused",normal:"iui-treegrid-row-cell",hovered:"iui-treegrid-row-cell-hovered",selected:"iui-treegrid-row-cell-selected"}},cell:{content:"iui-treegrid-row-cell-content",general:"iui-treegrid-row-cell",
disabled:"iui-treegrid-row-cell-disabled",focused:"iui-treegrid-row-cell-focused",normal:"iui-treegrid-row-cell",hovered:"iui-treegrid-row-cell-hovered",selected:"iui-treegrid-row-cell-selected"}};this.updatePaging=function(b){a.options.paging=b?{enabled:l.isFieldAvailable(b.enabled,!1),showControlPanel:l.isFieldAvailable(b.showControlPanel,!0),pageSize:l.isFieldAvailable(b.pageSize,100)}:{enabled:!1,showControlPanel:!0,pageSize:100}};this.updateOptions=function(b){b?(a.options={allowAnimation:l.isFieldAvailable(b.allowAnimation,
!0),allowCellFocus:l.isFieldAvailable(b.allowCellFocus,!0),allowColumnReorder:l.isFieldAvailable(b.allowColumnReorder,!1),allowDrag:l.isFieldAvailable(b.allowDrag,!1),allowDrop:l.isFieldAvailable(b.allowDrop,!0),allowFilter:l.isFieldAvailable(b.allowFilter,!1),allowFocus:l.isFieldAvailable(b.allowFocus,!0),animationSpeed:200,autoExpand:l.isFieldAvailable(b.autoExpand,!0),controlStyle:a.defaultStyle,editorSettings:{activate:"click"},expandColIndex:l.isFieldAvailable(b.expandColIndex,void 0!=a.options.expandColIndex?
a.options.expandColIndex:0),fillSpace:l.isFieldAvailable(b.fillSpace,!1),gridLines:l.isFieldAvailable(b.gridLines,"both"),hoverSelection:l.isFieldAvailable(b.hoverSelection,!1),indent:l.isFieldAvailable(b.indent,15),labelEdit:l.isFieldAvailable(b.labelEdit,!1),loadRows:[],pathSeparator:l.isFieldAvailable(b.pathSeparator,"\\"),rtl:l.isFieldAvailable(b.rtl,!1),selectedColumn:l.isFieldAvailable(b.selectedColumn,a.options.selectedColumn?a.options.selectedColumn:null),selectedIndex:-1,selectedRow:l.isFieldAvailable(b.selectedRow,
a.options.selectedRow?a.options.selectedRow:null),selectedRows:a.options.selectedRows?a.options.selectedRows:[],selectionMode:l.isFieldAvailable(b.selectionMode,"one"),showExpandBoxes:l.isFieldAvailable(b.showExpandBoxes,!0),showFooter:l.isFieldAvailable(b.showFooter,!0),showHeader:l.isFieldAvailable(b.showHeader,!0),showIcons:l.isFieldAvailable(b.showIcons,!0),sorting:l.isFieldAvailable(b.sorting,"none")},a.updatePaging(b.paging),a.updateDataFields(b.dataFields),a.updateControlStyle(b.controlStyle)):
(a.options={allowAnimation:!0,allowCellFocus:!0,allowColumnReorder:!1,allowDrag:!1,allowDrop:!0,allowFilter:!1,allowFocus:!0,animationSpeed:200,autoExpand:!0,controlStyle:a.defaultStyle,editorSettings:{activate:"click"},expandColIndex:0,fillSpace:!1,gridLines:"both",hoverSelection:!1,indent:15,labelEdit:!1,loadRows:[],pathSeparator:"\\",rtl:!1,selectedColumn:null,selectedIndex:-1,selectedRow:null,selectedRows:[],selectionMode:"one",showExpandBoxes:!0,showFooter:!0,showHeader:!0,showIcons:!0,sorting:"none"},
a.updatePaging(),a.updateDataFields())};a.options={};this.updateColumnFields=function(b){a.options.columnFields=b?{allowDrag:b.allowDrag?b.allowDrag:"allowDrag",allowDrop:b.allowDrop?b.allowDrop:"allowDrop",allowFilter:b.allowFilter?b.allowFilter:"allowFilter",cellTemplateUrl:b.cellTemplateUrl?b.cellTemplateUrl:"cellTemplateUrl",comparer:b.comparer?b.comparer:"comparer",contentAlignment:b.contentAlignment?b.contentAlignment:"contentAlignment",contextMenu:b.contextMenu?b.contextMenu:"contextMenu",
editorType:b.editorType?b.editorType:"editorType",editorSettings:b.editorSettings?b.editorSettings:"editorSettings",editorTemplate:b.editorTemplate?b.editorTemplate:"editorTemplate",filterParams:b.filterParams?b.filterParams:"filterParams",filterTemplate:b.filterTemplate?b.filterTemplate:"filterTemplate",fixed:b.fixed?b.fixed:"fixed",fixedWidth:b.fixedWidth?b.fixedWidth:"fixedWidth",footerAlignment:b.footerAlignment?b.footerAlignment:"footerAlignment",footerContent:b.footerContent?b.footerContent:
"footerContent",footerTemplate:b.footerTemplate?b.footerTemplate:"footerTemplate",footerTemplateModel:b.footerTemplateModel?b.footerTemplateModel:"footerTemplateModel",footerText:b.footerText?b.footerText:"footerText",headerAlignment:b.headerAlignment?b.headerAlignment:"headerAlignment",headerContent:b.headerContent?b.headerContent:"headerContent",headerTemplate:b.headerTemplate?b.headerTemplate:"headerTemplate",headerTemplateModel:b.headerTemplateModel?b.headerTemplateModel:"headerTemplateModel",
headerText:b.headerText?b.headerText:"headerText",icon:b.icon?b.icon:"icon",id:b.id?b.id:"id",minWidth:b.minWidth?b.minWidth:"minWidth",maxWidth:b.maxWidth?b.maxWidth:"maxWidth",style:b.style?b.style:"style",visible:b.visible?b.visible:"visible",width:b.width?b.width:"width"}:{allowDrag:"allowDrag",allowDrop:"allowDrop",allowFilter:"allowFilter",cellTemplateUrl:"cellTemplateUrl",comparer:"comparer",contentAlignment:"contentAlignment",contextMenu:"contextMenu",editorType:"editorType",editorSettings:"editorSettings",
editorTemplate:"editorTemplate",filterParams:"filterParams",filterTemplate:"filterTemplate",footerTemplateModel:"footerTemplateModel",fixed:"fixed",fixedWidth:"fixedWidth",footerAlignment:"footerAlignment",footerContent:"footerContent",footerTemplate:"footerTemplate",footerText:"footerText",headerAlignment:"headerAlignment",headerContent:"headerContent",headerTemplate:"headerTemplate",headerTemplateModel:"headerTemplateModel",headerText:"headerText",icon:"icon",id:"id",minWidth:"minWidth",maxWidth:"maxWidth",
style:"style",visible:"visible",width:"width"};a.columnsObj&&a.columnsObj.updateDataFields(a.options.columnFields)};this.updateRowFields=function(b){a.options.rowFields=b?{allowDrag:b.allowDrag?b.allowDrag:"allowDrag",allowDrop:b.allowDrop?b.allowDrop:"allowDrop",allowFocus:b.allowFocus?b.allowFocus:"allowFocus",cells:b.cells?b.cells:"cells",content:b.content?b.content:"content",contextMenu:b.contextMenu?b.contextMenu:"contextMenu",enabled:b.enabled?b.enabled:"enabled",expanded:b.expanded?b.expanded:
"expanded",hasChildren:b.hasChildren?b.hasChildren:"hasChildren",icon:b.icon?b.icon:"icon",id:b.id?b.id:"id",pid:b.pid?b.pid:"pid",rows:b.rows?b.rows:"rows",statusIcon:b.statusIcon?b.statusIcon:"statusIcon",style:b.style?b.style:"style",text:b.text?b.text:"text"}:{allowDrag:"allowDrag",allowDrop:"allowDrop",allowFocus:"allowFocus",cells:"cells",content:"content",contextMenu:"contextMenu",enabled:"enabled",expanded:"expanded",hasChildren:"hasChildren",icon:"icon",id:"id",pid:"pid",rows:"rows",statusIcon:"statusIcon",
style:"style",text:"text"};a.rowsObj&&a.rowsObj.updateDataFields(a.options.rowFields)};this.updateCellFields=function(b){a.options.cellFields=b?{allowEdit:b.allowEdit?b.allowEdit:"allowEdit",cid:b.cid?b.cid:"cid",content:b.content?b.content:"content",contextMenu:b.contextMenu?b.contextMenu:"contextMenu",enabled:b.enabled?b.enabled:"enabled",labelEdit:b.labelEdit?b.labelEdit:"labelEdit",rid:b.rid?b.rid:"rid",style:b.style?b.style:"style",templateObj:b.templateObj?b.templateObj:"templateObj",text:b.text?
b.text:"text",value:b.value?b.value:"value"}:{allowEdit:"allowEdit",cid:"cid",content:"content",contextMenu:"contextMenu",enabled:"enabled",labelEdit:"labelEdit",rid:"rid",style:"style",templateObj:"templateObj",text:"text",value:"value"}};this.updateDataFields=function(b){b?(a.updateColumnFields(b.column),a.updateRowFields(b.row),a.updateCellFields(b.cell)):(a.updateColumnFields(),a.updateRowFields(),a.updateCellFields())};a.updateOptions();c.$on(c.name+"-add-column",function(b,d){a.columnsObj.insertAt(d,
-1,null,a.columnIsAdded)});c.$on(c.name+"-clear-columns",function(b){a.columnsObj.clear(null,a.columnsAreCleared)});c.$on(c.name+"-insert-column-at",function(b,d,c){a.columnsObj.insertAt(d,c,null,a.columnIsAdded)});c.$on(c.name+"-insert-column-after",function(b,d,c){a.columnsObj.insertByRef(d,c,!0,a.columnIsAdded)});c.$on(c.name+"-insert-column-before",function(b,d,c){a.columnsObj.insertByRef(d,c,!1,a.columnIsAdded)});c.$on(c.name+"-remove-column",function(b,d){a.columnsObj.removeAt(d,-1,null,a.columnIsRemoved)});
c.$on(c.name+"-remove-column-at",function(b,d){a.columnsObj.removeAt(null,d,null,a.columnIsRemoved)});this.columnsAreCleared=function(b){a.options.selectedColumn&&(a.options.selectedColumn.selected=!1);a.options.selectedColumn=null;a.updateLayout()};a.columnIsAdded=function(){a.updateLayout()};a.columnIsRemoved=function(b,d){a.updateLayout()};c.$on(c.name+"-add-row",function(b,d,c){a.rowsObj.insertAt(d,-1,c,a.rowIsAdded)});c.$on(c.name+"-clear-rows",function(b,d){a.rowsObj.clear(d,a.rowsAreCleared)});
c.$on(c.name+"-insert-row-at",function(b,d,c,g){a.rowsObj.insertAt(d,c,g,a.rowIsAdded)});c.$on(c.name+"-insert-row-after",function(b,d,c){a.rowsObj.insertByRef(d,c,!0,a.rowIsAdded)});c.$on(c.name+"-insert-row-before",function(b,d,c){a.rowsObj.insertByRef(d,c,!1,a.rowIsAdded)});c.$on(c.name+"-remove-row",function(b,d){a.rowsObj.removeAt(d,-1,null,a.rowIsRemoved)});c.$on(c.name+"-remove-row-at",function(b,d,c){a.rowsObj.removeAt(null,d,c,a.rowIsRemoved)});this.rowsAreCleared=function(b){b||(a.clearPrevSelection(),
a.options.selectedRow=null,a.setScrollPos({x:0,y:0}));a.updateCurrentLayout()};this.rowIsAdded=function(){a.updateCurrentLayout()};this.rowIsRemoved=function(b,d,c){a.updateCurrentLayout()};this.objIsRemoved=function(b,d,c){a.updateCurrentLayout()};a.columnList=[];a.columnFilterList=[];a.isThereLeftFixedColumns=!1;a.isThereRightFixedColumns=!1;this.updateColumnList=function(){a.columnList.length=0;a.columnFilterList.length=0;a.isThereLeftFixedColumns=!1;a.isThereRightFixedColumns=!1;var b=a.columnsObj.getList();
if(b)for(var d=0;d<b.length;d++){var c=b[d];c.type="column";c[a.options.columnFields.id]||(c[a.options.columnFields.id]=l.getUniqueId());if(0!=c[a.options.columnFields.visible]){var g=c[a.options.columnFields.filterParams],g=g?Qb.createTree(g.conditions,g.formula):null;a.columnFilterList.push({cid:c[a.options.columnFields.id],tree:g});a.columnList.push(c);switch(c[a.options.columnFields.fixed]){case "left":a.isThereLeftFixedColumns||(a.isThereLeftFixedColumns=!0);break;case "right":a.isThereRightFixedColumns||
(a.isThereRightFixedColumns=!0)}}}};var lc=function(b){for(var d=null,c=0;c<a.columnFilterList.length;c++)if(a.columnFilterList[c].cid==b){d=a.columnFilterList[c].tree;break}return d},F=function(b,d){if(0==a.options.allowFilter)return!0;var c=!0;if(b){for(var g=-1,v=null,e=null,f=0;f<b[a.options.rowFields.cells].length&&(c=!0,e=b[a.options.rowFields.cells][f],g=e[a.options.cellFields.cid],v=a.getColumnById(g),!v&&f<a.columnList.length&&(v=a.columnList[f]),v&&v[a.options.columnFields.filterParams]&&
(c=v[a.options.columnFields.filterParams],v=e[a.options.cellFields.value]?e[a.options.cellFields.value]:e[a.options.cellFields.text],c=c.callback?c.callback(v,e,b):Qb.match(v,c.conditions,c.formula,lc(g))),c);f++);if(c&&(d||a.isRowExpanded(b))&&(g=b[a.options.rowFields.rows])&&0<g.length){for(f=e=0;f<g.length;f++)(childPass=F(g[f],d))&&e++;0==e&&(c=!1)}}return c},U=a.options.indent;a.currentPageList=[];a.pageList=[];a.onlyCurrentPage=!1;a.currentList=[];a.fullIndentList=[];a.fullList=[];a.indentList=
[];a.longestRow=null;a.isThereChildRows=!1;a.pageRowCount=0;a.pageNumber=0;a.currentPageNumber=1;this.isThereVisibleChildren=function(b){var d=!1;if(b&&(b=b[a.options.rowFields.rows])&&0<b.length)for(var c=0;c<b.length;c++)if(F(b[c])){d=!0;break}return d};var J=function(b,d,c,g){b.type="row";b[a.options.rowFields.id]||(b[a.options.rowFields.id]=l.getUniqueId());c&&(b[a.options.rowFields.pid]=c);c=!0;var v=b[a.options.rowFields.cells];if(v&&0<v.length){c=F(b,g);a.isRowExpanded(b)&&b[a.options.rowFields.rows]&&
0<b[a.options.rowFields.rows].length&&(c=c&&a.isThereVisibleChildren(b));for(var e=-1,f="label",h=null,h=null,p=0;p<a.columnList.length;p++){var h=a.columnList[p],e=h[a.options.columnFields.id],f=h[a.options.columnFields.editorType],h=h[a.options.columnFields.editorSettings],n=p;e&&(n=a.getCellIndexById(v,p,e));0<=n&&n<v.length&&(v[n].type="cell",v[n][a.options.cellFields.rid]=b[a.options.rowFields.id],a.setDefaultCellValue(v[n],f,h))}}c&&(g?(a.fullList.push(b),a.fullIndentList.push(d)):a.options.paging.enabled?
a.onlyCurrentPage?a.currentPageList.push({row:b,indent:d}):(b[a.options.rowFields.pid]||a.pageRowCount++,a.pageRowCount>a.options.paging.pageSize&&(a.pageRowCount=1,a.pageNumber++,a.pageList.push([])),a.pageList[a.pageNumber].push({row:b,indent:d})):(a.currentList.push(b),a.indentList.push(d)));return c},w=function(b,d,c,g){var v=!0;if(!b[a.options.rowFields.rows])return v=J(b,d,c,g);if(v=J(b,d,c,g)){c=0;var e=!0;if(g||a.isRowExpanded(b)){var f=b[a.options.rowFields.rows];if(f){a.applySorting(f);
for(var h=0;h<f.length;h++)(e=w(f[h],d+U,b[a.options.rowFields.id],g))&&c++}}g||a.isThereChildRows||!(0<c||!a.isRowExpanded(b)&&b[a.options.rowFields.rows]&&0<b[a.options.rowFields.rows].length&&a.isThereVisibleChildren(b))||(a.isThereChildRows=!0)}return v};this.getFullList=function(){a.fullList.length=0;a.fullIndentList.length=0;for(var b=a.rowsObj.getList(),d=0;d<b.length;d++)w(b[d],0,null,!0);return a.fullList};this.getCurrentList=function(){return a.currentList};this.updateCurrentList=function(){a.currentList.length=
0;a.indentList.length=0;U=a.options.indent;if(a.options.paging.enabled){if(1<=a.currentPageNumber&&a.currentPageNumber<=a.pageList.length)for(var b=0;b<a.pageList[a.currentPageNumber-1].length;b++)a.currentList.push(a.pageList[a.currentPageNumber-1][b].row),a.indentList.push(a.pageList[a.currentPageNumber-1][b].indent)}else{a.isThereChildRows=!1;var d=a.rowsObj.getList();if(d)for(a.applySorting(d),b=0;b<d.length;b++)w(d[b],0,null,!1)}};this.updateCurrentPageList=function(){a.currentPageList.length=
0;a.isThereChildRows=!1;a.onlyCurrentPage=!0;U=a.options.indent;if(1<a.currentPageNumber){var b=a.pageList[a.currentPageNumber-1];if(b&&0<b.length){a.applySorting(b);for(var d=0;d<b.length;d++)w(b[d],0,null,!1)}a.pageList[a.currentPageNumber-1]=a.currentPageList}a.onlyCurrentPage=!1};this.updatePageList=function(){a.pageList.length=0;a.pageRowCount=0;a.pageNumber=0;a.isThereChildRows=!1;U=a.options.indent;var b=a.rowsObj.getList();if(b&&0<b.length){a.applySorting(b);a.pageList.push([]);for(var d=
0;d<b.length;d++)w(b[d],0,null,!1);0<a.pageList.length&&0==a.pageList[a.pageList.length-1].length&&a.pageList.splice(a.pageList.length-1,1)}};this.columnEvents={clear:function(a){return angular.isDefined(c.events)&&c.events.clearColumns?c.events.clearColumns({parent:a.e.parent}):c.clearColumns(a)},objAdded:function(a){return angular.isDefined(c.events)&&c.events.columnAdded?c.events.columnAdded({column:a.e.column}):c.columnAdded(a)},objAdding:function(a){return angular.isDefined(c.events)&&c.events.rowAdding?
c.events.columnAdding({column:a.e.column}):c.columnAdding(a)},objRemoved:function(a){return angular.isDefined(c.events)&&c.events.rowRemoved?c.events.columnRemoved({column:a.e.column}):c.columnRemoved(a)},objRemoving:function(a){return angular.isDefined(c.events)&&c.events.rowRemoving?c.events.columnRemoving({column:a.e.column}):c.columnRemoving(a)}};this.rowEvents={clear:function(a){return angular.isDefined(c.events)&&c.events.clearRows?c.events.clearRows({parent:a.e.parent}):c.clearRows(a)},objAdded:function(a){return angular.isDefined(c.events)&&
c.events.rowAdded?c.events.rowAdded({row:a.e.row}):c.rowAdded(a)},objAdding:function(a){return angular.isDefined(c.events)&&c.events.rowAdding?c.events.rowAdding({row:a.e.row}):c.rowAdding(a)},objRemoved:function(a){return angular.isDefined(c.events)&&c.events.rowRemoved?c.events.rowRemoved({row:a.e.row}):c.rowRemoved(a)},objRemoving:function(a){return angular.isDefined(c.events)&&c.events.rowRemoving?c.events.rowRemoving({row:a.e.row}):c.rowRemoving(a)}};this.getRowFields=function(a){return{content:a.content?
a.content:"content",icon:a.icon?a.icon:"icon",id:a.id?a.id:"id",pid:a.pid?a.pid:"pid",objects:a.rows?a.rows:"rows",subobjects:a.cells?a.cells:"cells",text:a.text?a.text:"text"}};a.columnsObj=new oa({objects:c.columns,events:a.columnEvents,fields:a.options.columnFields});a.rowsObj=new oa({objects:c.rows,events:a.rowEvents,fields:a.getRowFields(a.options.rowFields)});c.$on(c.name+"-load-data",function(b,d,c,g,v){a.loadData(d,c,g,v)});c.$on(c.name+"-export-json",function(b,d,c,g,v){h.setTempData(a.exportToJSON(d,
c,g,v))});this.exportToJSON=function(b,d,c,g){var v=g,v=v?v:null,e=a.columnsObj.getList();b=JSON.stringify(e,b?b:[a.options.columnFields.allowDrag,a.options.columnFields.allowDrop,a.options.columnFields.allowFilter,a.options.columnFields.cellTemplateUrl,a.options.columnFields.contentAlignment,a.options.columnFields.contextMenu,a.options.columnFields.editorType,a.options.columnFields.editorSettings,a.options.columnFields.editorTemplate,a.options.columnFields.filterParams,a.options.columnFields.filterTemplate,
a.options.columnFields.fixed,a.options.columnFields.fixedWidth,a.options.columnFields.footerAlignment,a.options.columnFields.footerContent,a.options.columnFields.footerTemplate,a.options.columnFields.footerText,a.options.columnFields.headerAlignment,a.options.columnFields.headerContent,a.options.columnFields.headerTemplate,a.options.columnFields.headerText,a.options.columnFields.icon,a.options.columnFields.id,a.options.columnFields.style,a.options.columnFields.visible,a.options.columnFields.width],
v);g=g?g:null;v=!1!==c?a.getFullList():a.rowsObj.getList();d=d?d:[a.options.rowFields.allowCellFocus,a.options.rowFields.allowDrag,a.options.rowFields.allowDrop,a.options.rowFields.allowFocus,a.options.rowFields.cells,a.options.rowFields.content,a.options.rowFields.contextMenu,a.options.rowFields.enabled,a.options.rowFields.expanded,a.options.rowFields.hasChildren,a.options.rowFields.icon,a.options.rowFields.id,a.options.rowFields.pid,a.options.rowFields.statusIcon,a.options.rowFields.style,a.options.rowFields.text,
a.options.cellFields.rid];0==c&&d.push(a.options.rowFields.rows);c=JSON.stringify(v,d,g);return'[\n{ "columns": '+b+' },\n{ "rows": '+c+" }\n]"};this.loadData=function(b,d,C,g){a.suspendLayout();a.updateDataFields(C);var v=[],e=a.options.rowFields;a.rowsObj.clear(d,a.rowsAreCleared);if(b)if(!1!==g){var f=[];b.forEach(function(a,b){var d=a[e.pid];f[d]?(f[d][e.rows]||(f[d][e.rows]=[]),f[a[e.id]]=a,f[d][e.rows].push(a)):(f[a[e.id]]=a,v.push(a))});f.length=0}else v=b;if(d)for(d[a.options.rowFields.rows]=
v,b=0;b<d[a.options.rowFields.rows].length;b++)d[a.options.rowFields.rows][b][a.options.rowFields.pid]=d[a.options.rowFields.id];else if(angular.isDefined(c.rows))for(b=c.rows.length=0;b<v.length;b++)c.rows.push(v[b]);a.rowsObj=new oa({objects:c.rows,events:a.rowEvents,fields:a.getRowFields(a.options.rowFields)});a.resumeLayout()};this.updateData=function(){a.options.rowFields.dataSource&&(a.loadData(a.options.rowFields.dataSource),a.rowsObj=new oa({objects:c.rows,events:a.rowEvents,fields:a.getRowFields(a.options.rowFields)}))};
var va=!1;this.dragDropStatus=function(a){if(void 0!=a)va=a;else return va};this.getDnDSource=function(a){return{text:a.dataTransfer?a.dataTransfer.getData("text"):a.originalEvent.dataTransfer?a.originalEvent.dataTransfer.getData("text"):""}};this.getTouchData=function(a){return a.changedTouches?a.changedTouches:a.originalEvent?a.originalEvent.changedTouches:null};var Ca=angular.element('<div class="iui-drop-marker" data-element="dropmark"></div>');this.getDropMarkLine=function(){return dropMarkLine};
angular.element(f).bind("dragenter",function(b){a.dropMark()});angular.element(f).bind("dragend",function(b){a.removeDropMark();a.dragIcon&&angular.element(a.dragIcon).remove();a.cancelScrollTimer();a.dragDropStatus(!1)});a.getMousePos=function(a){return{x:a.pageX?a.pageX:a.originalEvent?a.originalEvent.pageX:0,y:a.pageY?a.pageY:a.originalEvent?a.originalEvent.pageY:0}};this.getCtrlName=function(){return angular.isDefined(c.name)?c.name:""};n.bind("dragenter",function(b){b.preventDefault();var d=
r.getData();d.source||(d.source=a.getDnDSource(b));b={event:b,sourceTree:d.sourceCtrl?d.sourceCtrl.getCtrlName():"",dragRow:d.source,targetTree:a.getCtrlName(),targetRow:d.target,mousePos:a.getMousePos(b)};a.callDragEnter(b)});n.bind("dragover",function(b){b.preventDefault();if(a.isDropInRange(b)){var d=!0;b.dataTransfer?d="none"===b.dataTransfer.effectAllowed?!1:!0:b.originalEvent&&b.originalEvent.dataTransfer&&(d="none"===b.originalEvent.dataTransfer.effectAllowed?!1:!0);if(d)if(b.dataTransfer?
b.dataTransfer.dropEffect=a.options.allowDrop?"move":"none":b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.dropEffect=a.options.allowDrop?"move":"none"),d=r.getData(),d.source||(d.source=a.getDnDSource(b)),r.setData({source:d.source,sourceCtrl:d.sourceCtrl,target:null,dropPos:-1}),d={event:b,sourceTree:d.sourceCtrl?d.sourceCtrl.getCtrlName():"",dragRow:d.source,targetTree:a.getCtrlName(),targetRow:null,isDropAllowed:a.options.allowDrop,dropPos:-1,mousePos:a.getMousePos(b)},
0==a.callDragOver(d))b.dataTransfer?b.dataTransfer.dropEffect="none":b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.dropEffect="none"),a.dropMark();else{d=a.getMousePos(b);b=d.y+16;var d=d.x+20,C=a.getDropMarkWindow();C.empty();C.append("<span class='iui-drop-marker-move-end'></span><span class='iui-drop-marker-title'>"+(c.name?c.name:"TreeGrid")+"</span>");a.updateDropMarkElem(a.getDropMarkWindow(),{top:b,left:d});a.dropMark(!0)}}else a.dropMark(),b.dataTransfer?b.dataTransfer.dropEffect=
"none":b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.dropEffect="none")});n.bind("drop",function(b){b.preventDefault();a.dropMark();if(a.isDropInRange(b)){var d=!0;b.dataTransfer?d="none"===b.dataTransfer.effectAllowed?!1:!0:b.originalEvent&&b.originalEvent.dataTransfer&&(d="none"===b.originalEvent.dataTransfer.effectAllowed?!1:!0);if(d&&(d=r.getData(),d.source||(d.source=a.getDnDSource(b)),d.source)){var C={event:b,sourceTree:d.sourceCtrl?d.sourceCtrl.getCtrlName():
"",dragRow:d.source,targetTree:a.getCtrlName(),targetRow:null,isDropAllowed:a.options.allowDrop,dropPos:-1,mousePos:a.getMousePos(b)};!1!==a.callDragDrop(C)&&(a.drop(d),c.$$phase||c.$apply())}}r.clearData();b.stopPropagation()});n.bind("dragleave",function(b){b.preventDefault();a.dropMark();var d=r.getData();d.source||(d.source=a.getDnDSource(b));b={event:b,sourceTree:d.sourceCtrl?d.sourceCtrl.getCtrlName():"",dragRow:d.source,targetTree:a.getCtrlName(),targetRow:d.target,mousePos:a.getMousePos(b)};
a.callDragLeave(b);a.cancelScrollTimer()});n.bind("dragend",function(b){b.preventDefault();a.dropMark();r.getData().source||r.clearData();a.dragDropStatus(!1)});n.bind("mouseleave",function(b){b.preventDefault();a.dropMark();a.hoverColumn=null;a.hoverRow=null;a.hoverCell=null});this.containsMousePos=function(a,d){return r.hitTest(a,d,{left:0,top:0,right:n[0].clientWidth,bottom:n[0].clientHeight})};this.isPopupActive=function(){return!1};var wa=function(b,d){var c=a.options.rowFields;if(!b[c.cells]){b[c.cells]=
[];var g={};g[a.options.cellFields.text]=b[d.text];b[c.cells].push(g)}b[c.rows]||(b[c.rows]=[]);b[c.rows].length=0;if(b[d.items]&&0<b[d.items].length)for(g=0;g<b[d.items].length;g++)b[c.rows].push(wa(b[d.items][g],d));return b},xa=function(b,d){var c=!1;d.sourceCtrl&&(c=d.sourceCollection.removeAt(b,-1,null,d.sourceCtrl.objIsRemoved));c&&("item"==b.type&&(b=wa(b,d.sourceCtrl.options.dataFields)),0===d.dropPos?a.rowsObj.insertAt(b,-1,d.target,a.rowIsAdded):1===d.dropPos||2===d.dropPos?1===d.dropPos?
a.rowsObj.insertByRef(b,d.target,!1,a.rowIsAdded):a.rowsObj.insertByRef(b,d.target,!0,a.rowIsAdded):a.rowsObj.insertAt(b,-1,null,a.rowIsAdded))};this.setDropSelection=function(b,d){var c=b;!c&&0<=d&&d<a.currentList.length&&(c=a.currentList[d]);a.clearPrevSelection(c);a.rowSelection(c)};this.drop=function(b){if(b&&b.sourceCtrl){b.sourceCtrl.suppressProcess=!0;a.allowUpdate=!1;b.sourceCtrl.allowUpdate=!1;var d=b.source,c=-1;if(Array.isArray(b.source)){0<b.source.length&&(c=b.sourceCtrl.getObjCurrentIndex(b.source[b.source.length-
1]));for(var g=[],v=0;v<b.source.length;v++){for(var f=!1,h=b.sourceCollection.getParent(b.source[v]);h;){if(b.sourceCtrl.isObjInSelList(h)){f=!0;break}h=b.sourceCollection.getParent(h)}f||g.push(b.source[v])}if(0<g.length)if(d=g[g.length-1],v=b.sourceCtrl.getObjCurrentIndex(g[0]),f=b.sourceCtrl.getObjCurrentIndex(d),v<=f)for(v=0;v<g.length;v++)xa(g[v],b);else for(v=g.length-1;0<=v;v--)xa(g[v],b)}else c=b.sourceCtrl.getObjCurrentIndex(b.source),xa(b.source,b);b.sourceCtrl!==a?(a.allowUpdate=!0,b.sourceCtrl.allowUpdate=
!0,a.updateCurrentLayout(),b.sourceCtrl.updateCurrentLayout()):(a.allowUpdate=!0,a.updateCurrentLayout());b.sourceCtrl.multiSelection(!1);var l=e(function(){b.sourceCtrl!==a&&b.sourceCtrl.setDropSelection(null,c);a.setDropSelection(d);a.updateFocus(a.getObjCurrentIndex(d),0);e.cancel(l)},1);b.sourceCtrl.suppressProcess=!1}};this.isDragAllowed=function(b){return a.options.allowDrag?b&&(b[a.options.rowFields.allowDrag]||void 0===b[a.options.rowFields.allowDrag])?!0:!1:!1};this.isChildOf=function(b,
d){var c=!1;if(b&&d){var g=d[a.options.rowFields.rows];if(g&&0<g.length)for(var e=0;e<g.length;e++){if(l.isEqual(b[a.options.rowFields.id],g[e][a.options.rowFields.id])){c=!0;break}else c=a.isChildOf(b,g[e]);if(c)break}}return c};this.isParentOf=function(b,d){var c=a.rowsObj.getParent(d);return b&&d&&c&&l.isEqual(b[a.options.rowFields.id],c[a.options.rowFields.id])?!0:!1};this.isDropAllowed=function(b,d,c){var g=a.options.allowDrop;if(g&&b&&d&&(g=d[a.options.rowFields.allowDrop]||void 0===d[a.options.rowFields.allowDrop]?
!0:!1))if(Array.isArray(b))for(var e=0;e<b.length;e++){if(l.isEqual(b[e][a.options.rowFields.id],d[a.options.rowFields.id])||0===c&&a.isParentOf(d,b[e])||a.isChildOf(d,b[e])){g=!1;break}if(!g)break}else if(l.isEqual(b[a.options.rowFields.id],d[a.options.rowFields.id])||0===c&&a.isParentOf(d,b)||a.isChildOf(d,b))g=!1;return g};this.getDropMarkWindow=function(){for(var a=Ca,d=angular.element(document.body).children(),c=0;c<d.length;c++){var g=angular.element(d[c]);if(g[0].attributes&&g[0].attributes["data-element"]&&
"dropmark"===g[0].attributes["data-element"].value){a=g;break}}return a};this.dropMark=function(b,d){d||(d=a.getDropMarkWindow());if(d){var c="none";this.options.allowDrop&&(c=b?"block":"none");angular.element(d).css("display",c)}};this.updateDropMarkElem=function(a,d){a&&d&&(a.css("top",d.top+"px"),a.css("left",d.left+"px"),a.css("width",d.width+"px"))};c.$on(c.name+"-open-editor",function(b,d){a.openEditor(d)});c.$on(c.name+"-close-editor",function(b,d){a.closeEditor(d)});this.updateEditorSettings=
function(b){a.options.editorSettings=b?{activate:l.isFieldAvailable(b.activate,"click")}:{activate:"click"}};this.allowEvents=!0;this.callAfterCollapse=function(a){angular.isDefined(c.events)&&c.events.afterCollapse&&c.events.afterCollapse({row:a});c.afterCollapse({e:{row:a}})};this.callAfterExpand=function(a){angular.isDefined(c.events)&&c.events.afterExpand&&c.events.afterExpand({row:a});c.afterExpand({e:{row:a}})};this.callAfterEdit=function(a){angular.isDefined(c.events)&&c.events.afterEdit&&
c.events.afterEdit({cell:a});c.afterEdit({e:{cell:a}})};this.callAfterLabelEdit=function(a){angular.isDefined(c.events)&&c.events.afterLabelEdit&&c.events.afterLabelEdit({cell:a});c.afterLabelEdit({e:{cell:a}})};this.callAfterSelect=function(a){angular.isDefined(c.events)&&c.events.afterSelect?c.events.afterSelect({object:a}):c.afterSelect({e:{object:a}});angular.isDefined(c.events)&&c.events.selectionChanged?c.events.selectionChanged({object:a}):c.selectionChanged({e:{object:a}})};this.callBeforeCollapse=
function(a){var d=!0;return d=angular.isDefined(c.events)&&c.events.beforeCollapse?c.events.beforeCollapse({row:a}):c.beforeCollapse({e:{row:a}})};this.callBeforeExpand=function(a){var d=!0;return d=angular.isDefined(c.events)&&c.events.beforeExpand?c.events.beforeExpand({row:a}):c.beforeExpand({e:{row:a}})};this.callBeforeEdit=function(a){var d=!0;return d=angular.isDefined(c.events)&&c.events.beforeEdit?c.events.beforeEdit({cell:a}):c.beforeEdit({e:{cell:a}})};this.callBeforeLabelEdit=function(a){var d=
!0;return d=angular.isDefined(c.events)&&c.events.beforeLabelEdit?c.events.beforeLabelEdit({cell:a}):c.beforeLabelEdit({e:{cell:a}})};this.callCellValueChanging=function(b,d,C){var g=!0;a.allowEvents&&(g=angular.isDefined(c.events)&&c.events.cellvalueChanging?c.events.cellvalueChanging({row:b,cell:d,value:C}):c.cellvalueChanging({e:{row:b,cell:d,value:C}}));return g};this.callCellValueChanged=function(b,d,C){a.allowEvents&&(angular.isDefined(c.events)&&c.events.cellvalueChanged?c.events.cellvalueChanged({row:b,
cell:d,value:C}):c.cellvalueChanged({e:{row:b,cell:d,value:C}}))};this.callChange=function(){angular.isDefined(c.events)&&c.events.change?c.events.change():c.change()};this.callColumnClick=function(a,d){angular.isDefined(c.events)&&c.events.columnClick&&c.events.columnClick({column:a,mousePos:d});c.columnClick({e:{column:a,mousePos:d}})};this.callColumnDblClick=function(a,d){angular.isDefined(c.events)&&c.events.columnDblclick&&c.events.columnDblclick({column:a,mousePos:d});c.columnDblclick({e:{column:a,
mousePos:d}})};this.callColumnHover=function(a){angular.isDefined(c.events)&&c.events.columnHover&&c.events.columnHover({column:a});c.columnHover({e:{column:a}})};this.callColumnPosChanging=function(a,d){var C=!0;return C=angular.isDefined(c.events)&&c.events.columnPoschanging?c.events.columnPoschanging({sourceColumn:a,targetColumn:d}):c.columnPoschanging({e:{sourceColumn:a,targetColumn:d}})};this.callColumnPosChanged=function(a,d){angular.isDefined(c.events)&&c.events.columnPoschanged&&c.events.columnPoschanged({sourceColumn:a,
targetColumn:d});c.columnPoschanged({e:{sourceColumn:a,targetColumn:d}})};this.callColumnRightClick=function(a,d){angular.isDefined(c.events)&&c.events.columnRightclick&&c.events.columnRightclick({column:a,mousePos:d});c.columnRightclick({e:{column:a,mousePos:d}})};this.callColumnSizeChanged=function(a,d){angular.isDefined(c.events)&&c.events.columnSizechanged&&c.events.columnSizechanged({column:a});c.columnSizechanged({e:{column:a}})};this.callDragEnter=function(a){angular.isDefined(c.events)&&c.events.dragEnter?
c.events.dragEnter({event:a.event,sourceTree:a.sourceTree,dragRow:a.dragRow,targetTree:a.targetTree,targetRow:a.targetRow,mousePos:a.mousePos}):c.dragEnter({e:{event:a.event,sourceTree:a.sourceTree,dragRow:a.dragRow,targetTree:a.targetTree,targetRow:a.targetRow,mousePos:a.mousePos}})};this.callDragOver=function(b){var d=!0,d=a.getCellAt(b.mousePos.x,b.mousePos.y);return d=angular.isDefined(c.events)&&c.events.dragOver?c.events.dragOver({event:b.event,sourceTree:b.sourceTree,dragRow:b.dragRow,targetTree:b.targetTree,
targetRow:b.targetRow,targetCell:d,isDropAllowed:b.isDropAllowed,dropPos:b.dropPos,mousePos:b.mousePos}):c.dragOver({e:{event:b.event,sourceTree:b.sourceTree,dragRow:b.dragRow,targetTree:b.targetTree,targetRow:b.targetRow,targetCell:d,isDropAllowed:b.isDropAllowed,dropPos:b.dropPos,mousePos:b.mousePos}})};this.callDragDrop=function(b){var d=!0,d=a.getCellAt(b.mousePos.x,b.mousePos.y);return d=angular.isDefined(c.events)&&c.events.dragDrop?c.events.dragDrop({event:b.event,sourceTree:b.sourceTree,dragRow:b.dragRow,
targetTree:b.targetTree,targetRow:b.targetRow,targetCell:d,isDropAllowed:b.isDropAllowed,dropPos:b.dropPos,mousePos:b.mousePos}):c.dragDrop({e:{event:b.event,sourceTree:b.sourceTree,dragRow:b.dragRow,targetTree:b.targetTree,targetRow:b.targetRow,targetCell:d,isDropAllowed:b.isDropAllowed,dropPos:b.dropPos,mousePos:b.mousePos}})};this.callDragLeave=function(a){angular.isDefined(c.events)&&c.events.dragLeave?c.events.dragLeave({event:a.event,sourceTree:a.sourceTree,dragRow:a.dragRow,targetTree:a.targetTree,
targetRow:a.targetRow,mousePos:a.mousePos}):c.dragLeave({e:{event:a.event,sourceTree:a.sourceTree,dragRow:a.dragRow,targetTree:a.targetTree,targetRow:a.targetRow,mousePos:a.mousePos}})};this.callCellClick=function(a,d,C,g){angular.isDefined(c.events)&&c.events.cellClick&&c.events.cellClick({event:a,row:d,cell:C,mousePos:g});c.cellClick({e:{event:a,row:d,cell:C,mousePos:g}})};this.callCellHover=function(a,d){angular.isDefined(c.events)&&c.events.cellHover?c.events.cellHover({event:a,cell:d}):c.cellHover({e:{event:a,
cell:d}})};this.callRowClick=function(a,d,C){angular.isDefined(c.events)&&c.events.rowClick?c.events.rowClick({event:a,row:d,mousePos:C}):c.rowClick({e:{event:a,row:d,mousePos:C}})};this.callRowDblClick=function(a,d){var C=!0;return C=angular.isDefined(c.events)&&c.events.rowDblClick?c.events.rowDblClick({row:a,mousePos:d}):c.rowDblclick({e:{row:a,mousePos:d}})};this.callRowHover=function(a,d){angular.isDefined(c.events)&&c.events.rowHover?c.events.rowHover({event:a,row:d}):c.rowHover({e:{event:a,
row:d}})};this.callRowRightClick=function(a,d){angular.isDefined(c.events)&&c.events.rowRightClick&&c.events.rowRightClick({row:a,mousePos:d});c.rowRightclick({e:{row:a,mousePos:d}})};this.callKeyDown=function(a,d){angular.isDefined(c.events)&&c.events.keyDown?c.events.keyDown({event:a,row:d}):c.keyDown({e:{event:a,row:d}})};this.callKeyPress=function(a,d){angular.isDefined(c.events)&&c.events.keyPress?c.events.keyPress({event:a,row:d}):c.keyPress({e:{event:a,row:d}})};this.callKeyUp=function(a,d){angular.isDefined(c.events)&&
c.events.keyUp?c.events.keyUp({event:a,row:d}):c.keyUp({e:{event:a,row:d}})};this.callScrollPosChanged=function(){angular.isDefined(c.events)&&c.events.scrollPosChanged?c.events.scrollPosChanged({scrollPos:a.scrollPos}):c.scrollposChanged({e:{scrollPos:a.scrollPos}})};n.bind("click",function(b){1===b.which&&a.callRowClick(b,null,a.getMousePos(b))});n.bind("dblclick",function(b){b.preventDefault();1===b.which&&a.callRowDblClick(null,a.getMousePos(b));b.stopPropagation()});n.bind("mousedown",function(b){3===
b.which&&a.callRowRightClick(null,a.getMousePos(b));a.removeDropDownList();a.closeFilterWindow();a.closeEditor();b.stopPropagation()});this.expandList=[];this.expandIndentList=[];var ib=function(b,d,c){b.type="row";b[a.options.rowFields.id]||(b[a.options.rowFields.id]=l.getUniqueId());c&&(b[a.options.rowFields.pid]=c);c=!0;var g=b[a.options.rowFields.cells];if(g&&0<g.length){c=F(b);a.isRowExpanded(b)&&b[a.options.rowFields.rows]&&0<b[a.options.rowFields.rows].length&&(c=c&&a.isThereVisibleChildren(b));
for(var e=-1,f="label",h=null,h=null,n=0;n<a.columnList.length;n++){var h=a.columnList[n],e=h[a.options.columnFields.id],f=h[a.options.columnFields.editorType],h=h[a.options.columnFields.editorSettings],p=n;e&&(p=a.getCellIndexById(g,n,e));0<=p&&p<g.length&&(g[p].type="cell",a.setDefaultCellValue(g[p],f,h))}}c&&(a.expandList.push(b),a.expandIndentList.push(d));return c},y=function(b,d,c){var g=!0;if(!b[a.options.rowFields.rows])return g=ib(b,d+U,c);if(g=ib(b,d+U,c)){c=0;var e=!0;if(a.isRowExpanded(b)){var f=
b[a.options.rowFields.rows];if(f){a.applySorting(f);for(var h=0;h<f.length;h++)(e=y(f[h],d+U,b[a.options.rowFields.id]))&&c++}}!a.isThereChildRows&&(0<c||!a.isRowExpanded(b)&&b[a.options.rowFields.rows]&&0<b[a.options.rowFields.rows].length&&a.isThereVisibleChildren(b))&&(a.isThereChildRows=!0)}return g};this.expand=function(b){a.expandList.length=[];a.expandIndentList.length=[];if(!a.isRowExpanded(b)){var d=a.getRowCurrentIndex(b);if(b=a.getList(b)){a.applySorting(b);for(var c=0;c<b.length;c++)y(b[c],
a.indentList[d],null)}if(0<a.expandList.length){a.allowEvents=!1;d++;Array.prototype.splice.apply(a.currentList,[d,0].concat(a.expandList));Array.prototype.splice.apply(a.indentList,[d,0].concat(a.expandIndentList));a.getRowScope()?a.updateView():a.updateLayout();var g=e(function(){a.updateViewSize();a.updateViewSize();a.updateScrollView();e.cancel(g);a.allowEvents=!0},1)}}};this.collapse=function(b){a.expandList.length=[];a.expandIndentList.length=[];if(a.isRowExpanded(b)){var d=null,c=!1,g=b,f=
-1,h=a.getRowCurrentIndex(b);for(b=a.getParent(b);b&&!c;){d=a.getList(b);for(f=d.indexOf(g)+1;!c&&f<d.length;)g=d[f],0<a.getRowCurrentIndex(g)&&(c=!0),f++;c||(g=b);b=a.getParent(b)}if(!c&&g)for(d=a.getList(),f=d.indexOf(g)+1;f<d.length;)if(g=d[f],0<a.getRowCurrentIndex(g)){c=!0;break}else f++;h++;d=a.currentList.length-h;c&&(d=a.getRowCurrentIndex(g)-h);if(0<d){a.currentList.splice(h,d);a.indentList.splice(h,d);a.getRowScope()?a.updateView():a.updateLayout();var l=e(function(){a.updateViewSize();
a.updateViewSize();a.updateScrollView();e.cancel(l);a.allowEvents=!0},1)}}};this.toggle=function(b,d){if(b){if(b[a.options.rowFields.hasChildren]||b[a.options.rowFields.rows]&&0!=b[a.options.rowFields.rows].length)if(!d||0==b[a.options.rowFields.expanded])if(!1!==d||0!=b[a.options.rowFields.expanded]){a.updateType="view";var c=void 0!==d?d:!1!==b[a.options.rowFields.expanded]?!0:!1,g=!0,g=void 0!==d?d?a.callBeforeExpand(b):a.callBeforeCollapse(b):c?a.callBeforeCollapse(b):a.callBeforeExpand(b);!1!==
g&&(c=void 0!=d?d:!c,c!=b[a.options.rowFields.expanded]&&(0!=c?a.expand(b):a.collapse(b),b[a.options.rowFields.expanded]=c),a.isRowExpanded(b)?a.callAfterExpand(b):a.callAfterCollapse(b))}}else{c=a.getFullList();for(g=0;g<c.length;g++)c[g][a.options.rowFields.expanded]=d;a.updateCurrentLayout()}};c.$on(c.name+"-collapse",function(b,d){a.toggle(d,!1)});c.$on(c.name+"-expand",function(b,d){a.toggle(d,!0)});c.$on(c.name+"-expand-col-index",function(b,d){0<=d&&d<a.columnList.length&&(a.options.expandColIndex=
d)});c.$on(c.name+"-toggle",function(b,d){a.toggle(d)});this.isFilteringAllowed=function(b){return b&&b[a.options.columnFields.allowFilter]};c.$on(c.name+"-filter",function(b,d,c){a.filter(d,c)});this.filter=function(b,d){if(b)b[a.options.columnFields.filterParams]=d;else for(var c=0;c<a.columnList.length;c++)b[a.options.columnFields.filterParams]=null;a.closeFilterWindow();a.updateCurrentLayout();a.callChange()};this.callGotFocus=function(a,d,e,g,f){angular.isDefined(c.events)&&c.events.gotFocus?
c.events.gotFocus({event:a,row:d,cell:e,edit:void 0!=g?!0:!1,editValue:f}):c.gotFocus({e:{event:a,row:d,cell:e,edit:void 0!=g?!0:!1,editValue:f}})};this.callLostFocus=function(a,d,e,g,f){angular.isDefined(c.events)&&c.events.lostFocus?c.events.lostFocus({event:a,row:d,cell:e,edit:void 0!=g?!0:!1,editValue:f}):c.lostFocus({e:{event:a,row:d,cell:e,edit:void 0!=g?!0:!1,editValue:f}})};this.getTabIndex=function(){return n[0].attributes&&n[0].attributes.tabindex?n[0].attributes.tabindex.value:""};this.updateFocus=
function(b,d){if(1==a.options.allowFocus)var c=e(function(){if(a.isRowIndexInRange(b)){var g="none";0<=d&&d<a.columnList.length&&(g=a.columnList[d][a.options.columnFields.fixed]);var f=a.getElemFromRow(a.currentList[b],g);f&&(1==a.options.allowCellFocus&&0<=d&&d<a.columnList.length?(g=a.getElemFromCell(b,d,g))&&g[0].focus():f[0].focus())}else n[0].focus();e.cancel(c)},5)};c.$on(c.name+"-focus",function(b,d){if(d){var c=-1,g=-1;switch(d.type){case "row":c=a.getRowCurrentIndex(d);a.updateFocus(c);break;
case "cell":c=a.getCellRowIndex(d),g=a.getCellColumnIndex(d),a.updateFocus(c,g)}}else a.updateFocus()});var Ua=!1;this.getCell=function(b,d){if(0<=b&&b<a.currentList.length){var c=a.currentList[b],g=a.getColumnRealIndex(d);0<=d&&d<a.columnList.length&&(g=a.getCellIndexById(c[a.options.rowFields.cells],d,a.columnList[d].id));if(c[a.options.rowFields.cells]&&0<=g&&g<c[a.options.rowFields.cells].length)return c[a.options.rowFields.cells][g]}return null};this.getCellObject=function(b,d){if(0<=b&&b<a.currentList.length){var c=
a.currentList[b],g=a.getColumnRealIndex(d);0<=d&&d<a.columnList.length&&(g=a.getCellIndexById(c[a.options.rowFields.cells],d,a.columnList[d].id));if(c[a.options.rowFields.cells]&&0<=g&&g<c[a.options.rowFields.cells].length)return c[a.options.rowFields.cells][g]}return null};this.getCellIndexById=function(b,d,c){var g=-1;if(b){d=a.getColumnRealIndex(d);for(var e=0;e<b.length;e++)if(void 0==b[e][a.options.cellFields.cid]){g=d;break}else if(b[e][a.options.cellFields.cid]==c){g=e;break}}return g};this.getCellIndexFromRow=
function(b,d){var c=-1;if(b&&d&&d[a.options.rowFields.cells])for(var g=0;g<d[a.options.rowFields.cells].length;g++)if(d[a.options.rowFields.cells][g]==b){c=g;break}return c};this.getCellColumnIndex=function(b){if(b)if(b[a.options.cellFields.cid]){if(b=a.getColumnById(b[a.options.cellFields.cid]))return a.getColumnCurrentIndex(b)}else return a.getCellColumnIndexFromRow(b);return-1};this.getCellColumnIndexFromRow=function(b){if(b&&b[a.options.cellFields.rid]){var d=a.findRowById(b[a.options.cellFields.rid]);
if(d&&(d=d[a.options.rowFields.cells])&&0<d.length)return d.indexOf(b)}return-1};this.getCellRowIndex=function(b){return b&&b[a.options.cellFields.rid]&&(b=a.findRowById(b[a.options.cellFields.rid]))?a.getRowCurrentIndex(b):-1};this.getColumnById=function(b){for(var d=null,c=0;c<a.columnList.length;c++)if(a.columnList[c][a.options.columnFields.id]==b){d=a.columnList[c];break}return d};this.getColumnObject=function(b){return 0<=b&&b<a.columnList.length?a.columnList[b]:null};this.getRowObject=function(b){return 0<=
b&&b<a.currentList.length?a.currentList[b]:null};this.isRowExpanded=function(b){return b?b[a.options.rowFields.expanded]||void 0===b[a.options.rowFields.expanded]?!0:!1:!0};this.getContentElement=function(a,c){var e=null;c||(c="cell-content");if(a&&0<a.children().length)for(var g=a.children(),f=0;f<g.length;f++){var h=angular.element(g.eq(f));if(h[0].attributes&&h[0].attributes["data-element"]&&h[0].attributes["data-element"].value==c){e=h;break}}return e};this.getElement=function(a,c){var e=null;
c||(c="cell-content");if(a&&0<a.children().length){a=a.children().eq(0);for(var g=a.children(),f=0;f<g.length;f++){var h=angular.element(g.eq(f));if(h[0].attributes&&h[0].attributes["data-element"]&&h[0].attributes["data-element"].value==c){e=h;break}}}return e};this.getChildElement=function(a,c){var e=null;c||(c="content");if(a&&0<a.children().length)for(var g=a.children(),f=0;f<g.length;f++){var h=angular.element(g.eq(f));if(h[0].attributes&&h[0].attributes["data-element"]&&h[0].attributes["data-element"].value==
c){e=h;break}}return e};this.getElemFromColumn=function(b,c,e){var g=null;if(b){b=a.getColumnCurrentIndex(b);var f=a.getHeaderElem(c);"footer"==e&&(f=a.getFooterElem(c));if(f&&(c=f.find("td"))&&0<c.length)for(e=0;e<c.length;e++)if(f=angular.element(c[e]),f[0].attributes["data-index"]&&f[0].attributes["data-index"].value.toString()===b.toString()){g=f;break}}return g};this.getElemFromRow=function(b,c){var e=null;if(b){var g=a.getRowCurrentIndex(b),f=a.getRowElems(c);if(f&&0<f.length)for(var h=0;h<
f.length;h++){var l=angular.element(f[h]);if(l[0].attributes["data-index"]&&l[0].attributes["data-index"].value.toString()===g.toString()){e=l;break}}}return e};this.getElemFromCell=function(b,c,e){var g=null;if(0<=b&&b<a.currentList.length&&(b=a.getElemFromRow(a.currentList[b],e))&&(b=b.find("td"))&&0<b.length)for(e=0;e<b.length;e++){var f=angular.element(b[e]);if(f[0].attributes["data-index"]&&f[0].attributes["data-index"].value.toString()===c.toString()){g=f;break}}return g};this.getElemFromColumnCell=
function(b,c,e){var g=null,f=null;if((f=e?a.getFooterElem(c):a.getHeaderElem(c))&&(c=f.find("td"))&&0<c.length)for(e=0;e<c.length;e++)if(f=angular.element(c[e]),f[0].attributes["data-index"]&&f[0].attributes["data-index"].value.toString()===b.toString()){g=f;break}return g};this.getIndent=function(b){var c=0;if(b)for(parent=a.rowsObj.getParent(b);parent;)c+=a.options.indent,parent=a.rowsObj.getParent(parent);return c};this.getObjState=function(b){if(b)switch(b.type){case "column":if(1==b.selected)return"selected";
if(b==a.hoverColumn)return"hovered";break;case "row":if(0==b[a.options.rowFields.enabled])return"disabled";if(1==b.selected)return"selected";if(b==a.hoverRow)return"hovered";break;case "cell":if(0==b[a.options.cellFields.enabled])return"disabled";if(1==b.selected)return"selected";if(b==a.hoverCell)return"hovered"}return"normal"};this.getColumnAt=function(b,c){if(void 0==b||void 0==c)return a.hoverColumn;for(var e=null,g=null,f=null,e="left",h=0;!f&&3>h;){if(e=a.getHeaderElem(e)){var n=e.find("td");
if(n&&0<n.length)for(var p=0;p<n.length;p++)if(e=angular.element(n[p]),g=l.getPageRect(e),l.checkHit(b,c,g)){f=a.getColumnFromElem(e);break}}h++;e=1==h?"right":"none"}return f};this.getCellAt=function(b,c){var e=null,g=a.getRowAt(b,c);if(g){var f=null,h=null,n=a.getElemFromRow(g).find("td");if(n&&0<n.length)for(var p=0;p<n.length&&!(f=angular.element(n[p]),h=l.getPageRect(f),l.checkHit(b,c,h)&&(e=a.getRowCurrentIndex(g),f=a.getIndexFromElem(f),e=a.getCellObject(e,f)));p++);}return e};this.getRowAt=
function(b,c){for(var e=null,g=null,f=null,e="none",h=0;!f&&3>h;){var n=a.getRowElems(e);if(n&&0<n.length)for(var p=0;p<n.length;p++)if(e=angular.element(n[p]),g=l.getPageRect(e),l.checkHit(b,c,g)){f=a.getRowFromElem(e);break}h++;e=1==h?"left":"right"}return f};this.getRowCurrentIndex=function(b){return b&&a.currentList?a.currentList.indexOf(b):-1};this.getObjCurrentIndex=function(b){return a.getRowCurrentIndex(b)};this.getRowFromChildElem=function(b){if(b&&(b=angular.element(b))){for(b=b.parent();b&&
b[0].tagName&&"tr"!==b[0].tagName.toLowerCase();)b=b.parent();return b?a.getRowFromElem(b):null}return null};this.getColumnCurrentIndex=function(b){return b&&a.columnList?a.columnList.indexOf(b):-1};this.getFullColumnList=function(){return a.columnsObj.getList()};this.getColumnRealIndex=function(b){var c=a.getFullColumnList();return 0<=b&&b<c.length&&b<a.columnList.length?c.indexOf(a.columnList[b]):-1};this.getColumnFromChildElem=function(b){return b?a.getColumnFromElem(b):null};this.getColumnFromElem=
function(b){return b&&(b=angular.element(b))&&b[0].attributes["data-index"]&&(b=b[0].attributes["data-index"].value,0<=b&&b<a.columnList.length)?a.columnList[b]:null};this.getIndexFromElem=function(a){return a&&(a=angular.element(a))&&a[0].attributes["data-index"]?a[0].attributes["data-index"].value:-1};this.getRowFromElem=function(b){if(b&&(b=angular.element(b))&&b[0].attributes["data-index"]&&(b=b[0].attributes["data-index"].value,a.isRowIndexInRange(b)))return a.currentList[b]};this.isRowIndexInRange=
function(b){return 0<=b&&b<a.currentList.length};this.isColIndexInRange=function(b){return 0<=b&&b<a.columnList.length};this.isRowEnabled=function(b){return b&&l.isEnabled(b[a.options.rowFields.enabled])};this.mouseButtonStatus=function(a){Ua=a};c.$on(c.name+"-ensure-visible",function(b,c){a.ensureVisible(c)});c.$on(c.name+"-find-row-by-id",function(b,c){h.setTempData(a.findRowById(c))});c.$on(c.name+"-find-row-by-path",function(b,c,e){h.setTempData(a.findRowByPath(c,e))});c.$on(c.name+"-find-row-by-text",
function(b,c){h.setTempData(a.findRowByText(c))});c.$on(c.name+"-get-full-path",function(b,c){h.setTempData(a.getFullPath(c))});c.$on(c.name+"-get-cell-at",function(b,c){c?h.setTempData(a.getCellAt(c.x,c.y)):h.setTempData(null)});c.$on(c.name+"-get-row-at",function(b,c){c?h.setTempData(a.getRowAt(c.x,c.y)):h.setTempData(null)});c.$on(c.name+"-get-row-level",function(b,c){h.setTempData(a.getLevel(c))});c.$on(c.name+"-get-row-parent",function(b,c){h.setTempData(a.getParent(c))});c.$on(c.name+"-get-flat-list",
function(b,c){c?h.setTempData(a.getFullList()):h.setTempData(a.currentList)});c.$on(c.name+"-get-list",function(b,c){h.setTempData(a.getList(c))});c.$on(c.name+"-get-top-row",function(b){h.setTempData(a.getTopRow())});c.$on(c.name+"-set-top-row",function(b,c){a.ensureVisible(c)});this.ensureVisible=function(b,c){if(b){for(var f=[],g=a.getParent(b);g;)f.push(g),g=a.getParent(g);for(g=f.length-1;0<=g;g--)f[g][a.options.rowFields.expanded]=!0;a.updateCurrentLayout();var h=e(function(){c=void 0!=c?c:
"center";a.scrollTo(b,c);e.cancel(h)},100)}};this.findRowById=function(b){return a.rowsObj.findObjectById(b)};this.findRowByText=function(b){return a.rowsObj.findObjectByText(b)};this.findRowByPath=function(b,c){var e=null;c||(c=a.getFullList());for(var g=0;g<c.length;g++)if(a.getFullPath(c[g])==b){e=c[g];break}return e};this.getFullPath=function(b){var c="";if(b)for(c=b[a.options.rowFields.text],b=a.getParent(b);b;)c=[b[a.options.rowFields.text],a.options.pathSeparator,c].join(""),b=a.getParent(b);
return c};this.getLevel=function(a){var c=0;for(a=this.getParent(a);a;)c++,a=this.getParent(a);return c};this.getParent=function(b){return a.rowsObj.getParent(b)};this.getList=function(b){return a.rowsObj.getList(b)};this.getFirstRow=function(){for(var b=null,c=0;c<a.currentList.length;c++)if(l.isEnabled(a.currentList[c][a.options.rowFields.enabled])){b=a.currentList[c];break}return b};this.getPrevRow=function(b){var c=null;if(0<=b&&b<a.currentList.length)for(--b;0<=b;b--)if(l.isEnabled(a.currentList[b][a.options.rowFields.enabled])){c=
a.currentList[b];break}return c};this.getNextRow=function(b){var c=null;for(b+=1;b<a.currentList.length;b++)if(l.isEnabled(a.currentList[b][a.options.rowFields.enabled])){c=a.currentList[b];break}return c};this.getLastRow=function(){for(var b=null,c=a.currentList.length-1;0<=c;c--)if(l.isEnabled(a.currentList[c][a.options.rowFields.enabled])){b=a.currentList[c];break}return b};this.updateSelectionStatus=function(b){switch(b){case "shift":switch(a.options.selectionMode){case "multi-simple":a.multiSelection(!0);
break;case "multi-extended":a.multiSelection(!0);break;default:a.multiSelection(!1)}break;case "ctrl":switch(a.options.selectionMode){case "multi-simple":a.multiSelection(!0);break;case "multi-extended":a.multiSelection(!0);break;default:a.multiSelection(!1)}}};n.bind("keydown",function(b){switch(b.keyCode){case 16:a.updateSelectionStatus("shift");break;case 17:a.updateSelectionStatus("ctrl");break;default:(b.ctrlKey||b.metaKey)&&a.updateSelectionStatus("ctrl"),b.shiftKey&&a.updateSelectionStatus("shift")}});
this.allowUpdate=!0;this.updateType="all";this.suspendLayout=function(){a.allowUpdate=!1};this.resumeLayout=function(){a.allowUpdate=!0;a.updateLayout()};c.$on(c.name+"-refresh",function(b,c,e){a.refresh(c,e)});c.$on(c.name+"-resume-layout",function(b){a.resumeLayout()});c.$on(c.name+"-suspend-layout",function(b){a.suspendLayout()});c.$on(c.name+"-update-layout",function(b){a.updateLayout()});c.$on(c.name+"-update-view",function(b){a.updateView()});c.$on(c.name+"-begin-load",function(b,c,e){c?(0>
a.options.loadRows.indexOf(c)&&a.options.loadRows.push(c),a.updateView()):a.beginLoad(e)});c.$on(c.name+"-end-load",function(b,c){a.endLoad(c)});this.callLoadComplete=function(a){angular.isDefined(c.events)&&c.events.loadComplete?c.events.loadComplete():c.loadComplete()};this.callUpdateComplete=function(){angular.isDefined(c.events)&&c.events.updateComplete?c.events.updateComplete():c.updateComplete()};c.$on(c.name+"-get-current-page",function(b){h.setTempData(a.currentPageNumber)});c.$on(c.name+
"-set-current-page",function(b,c){a.setCurrentPage(c)});c.$on(c.name+"-first-page",function(b){a.firstPage()});c.$on(c.name+"-last-page",function(b){a.lastPage()});c.$on(c.name+"-next-page",function(b){a.nextPage()});c.$on(c.name+"-prev-page",function(b){a.prevPage()});this.setCurrentPage=function(b){a.currentPageNumber!=b&&1<=b&&b<=a.pageList.length&&(a.currentPageNumber=b,a.updateCurrentLayout())};this.firstPage=function(){1!=a.currentPageNumber&&(a.currentPageNumber=1,a.updateCurrentLayout())};
this.lastPage=function(){a.currentPageNumber!=a.pageList.length&&(a.currentPageNumber=a.pageList.length,a.updateCurrentLayout())};this.nextPage=function(){a.currentPageNumber<a.pageList.length&&(a.currentPageNumber++,a.updateCurrentLayout())};this.prevPage=function(){1<a.currentPageNumber&&(a.currentPageNumber--,a.updateCurrentLayout())};c.$on(c.name+"-get-max-scroll-pos",function(b){h.setTempData(a.getMaxScrollPos())});c.$on(c.name+"-get-scroll-pos",function(b){h.setTempData(a.getScrollPos())});
c.$on(c.name+"-set-scroll-pos",function(b,c){a.setScrollPos(c)});c.$on(c.name+"-scroll-to",function(b,c,e){a.scrollTo(c,e)});var pa=!1;this.multiSelection=function(a){if(void 0!=a)pa=a;else return pa};this.columnSelection=function(b,d){if(b){var e=!0;a.options.selectedColumn&&(e=!l.isEqual(a.options.selectedColumn[a.options.columnFields.id],b[a.options.columnFields.id]));var g=!0,g=angular.isDefined(c.events)&&c.events.beforeSelect?c.events.beforeSelect({object:b}):c.beforeSelect({e:{object:b}});
e&&!1!==g&&(a.options.selectedColumn&&(a.options.selectedColumn.selected=!1,a.refresh(a.options.selectedColumn)),a.options.selectedColumn=b,b.selected=!0,angular.isDefined(c.selectedColumn)&&(c.selectedColumn=b),a.refresh(a.options.selectedColumn),a.callAfterSelect(b))}else return a.options.selectedColumn};this.isRowSelected=function(a){return l.isSelected(a)};this.clearPrevSelection=function(b){for(var c=0;c<a.options.selectedRows.length;c++)b&&!l.isEqual(a.options.selectedRows[c][a.options.rowFields.id],
b[a.options.rowFields.id])?a.options.selectedRows[c].selected=!1:b||(a.options.selectedRows[c].selected=!1);a.options.selectedRows.length=0;b&&0!=b[a.options.rowFields.enabled]&&a.options.selectedRows.push(b);a.refreshRows()};this.markSelColumn=function(){for(var b=0;b<a.columnList.length;b++)a.refresh(a.columnList[b])};this.rowSelection=function(b,d,e,g){if(b){if("none"!=a.options.selectionMode)if(a.isRowEnabled(b)){e=a.rowSelection();var f=!0;e&&(f=!l.isEqual(e[a.options.rowFields.id],b[a.options.rowFields.id]));
var h=!0,h=angular.isDefined(c.events)&&c.events.beforeSelect?c.events.beforeSelect({object:b}):c.beforeSelect({e:{object:b}});if(!1!==h)if(f){var n=event&&(event.shiftKey||event.ctrlKey||event.metaKey)?!0:!1,f=!0;"multi-extended"==a.options.selectionMode&&(f=!a.isObjInSelList(b));f&&(Ua&&d?a.clearPrevSelection():pa||n||"multi-simple"===a.options.selectionMode||a.clearPrevSelection());a.options.selectedRow=b;if(Ua&&d&&"one"!=a.options.selectionMode){if(d=a.getRowCurrentIndex(e),g=a.getRowCurrentIndex(b),
d>g&&(n=d,d=g,g=n),a.isRowIndexInRange(d)&&a.isRowIndexInRange(g))for(;d<=g;d++)a.currentList[d].selected=!0,a.options.selectedRows.push(a.currentList[d])}else Ua&&(pa||n||"multi-simple"===a.options.selectionMode)?(d=null===b.selected||"undefined"===b.selected?!1:b.selected,b.selected=!d,b.selected?a.isObjInSelList(b)||a.options.selectedRows.push(b):a.options.selectedRows=a.options.selectedRows.filter(function(a){return a!=b})):(b.selected=!0,a.isObjInSelList(b)||a.options.selectedRows.push(b));angular.isDefined(c.selectedRow)&&
(c.selectedRow=b);a.callAfterSelect(b);a.refresh(null,null,!0)}else if(pa||n||"multi-simple"===a.options.selectionMode)d=null===b.selected||"undefined"===b.selected?!1:b.selected,g&&"undefined"!==g&&(d=g),b.selected=!d,b.selected?a.isObjInSelList(b)||a.options.selectedRows.push(b):a.options.selectedRows=a.options.selectedRows.filter(function(a){return a!=b}),a.callAfterSelect(b),a.refresh(null,null,!0)}else a.clearPrevSelection()}else return a.options.selectedRow};this.updateSelection=function(b,
c,e){b=b&&(b.shiftKey||b.ctrlKey||b.metaKey)?!0:!1;"multi-extended"==a.options.selectionMode&&0<a.options.selectedRows.length&&!e&&!pa&&!b&&(a.clearPrevSelection(c),a.refresh(null,null,!0))};this.isObjInSelList=function(b){var c=!1,e=a.options.selectedRows;if(b&&e)for(var g=0;g<e.length;g++)if(l.isEqual(e[g][a.options.rowFields.id],b[a.options.rowFields.id])){c=!0;break}return c};c.$on(c.name+"-clear-selection",function(b){a.options.selectedColumn&&(a.options.selectedColumn.selected=!1);a.options.selectedColumn=
null;a.clearPrevSelection();a.options.selectedRow=null});c.$on(c.name+"-get-hover-column",function(b,c){a.hoverColumn?h.setTempData(a.hoverColumn):c&&h.setTempData(a.getColumnAt({x:c.x,y:c.y}))});c.$on(c.name+"-get-selected-column",function(b){h.setTempData(a.columnSelection())});c.$on(c.name+"-set-selected-column",function(b,c){a.columnSelection(c)});c.$on(c.name+"-get-selected-row",function(b){h.setTempData(a.rowSelection())});c.$on(c.name+"-set-selected-row",function(b,c){var f=e(function(){a.rowSelection(c);
e.cancel(f)},1)});c.$on(c.name+"-get-selected-rows",function(b){h.setTempData(a.options.selectedRows)});c.$on(c.name+"-set-selected-rows",function(b,c){c&&Array.isArray(c)&&e(function(){for(var b=a.options.selectedRows.length=0;b<c.length;b++)c[b].selected=!0,a.options.selectedRows.push(c[b]);0<c.length?(a.options.selectedRow=c[c.length-1],a.callAfterSelect(a.options.selectedRow)):a.options.selectedRow=null;a.refresh(null,null,!0)},1)});c.$on(c.name+"-move-column",function(b,c,e){a.moveColumn(c,e)});
c.$on(c.name+"-move-row",function(b,c,e,g,f){a.moveRow(c,e,g,f)});c.$watch("options",function(b,c){b!==c&&(a.updateOptions(b),a.updateLayout())},!0);c.$watch("allowCellFocus",function(b,c){b!==c&&(a.options.allowCellFocus=b)});c.$watch("allowColumnReorder",function(b,c){b!==c&&(a.options.allowColumnReorder=b)});c.$watch("allowFilter",function(b,c){b!==c&&(a.options.allowFilter=b)});c.$watch("allowFocus",function(b,c){b!==c&&(a.options.allowFocus=b)});c.$watch("allowDrag",function(b,c){b!==c&&(a.options.allowDrag=
b,a.updateView())});c.$watch("allowDrop",function(b,c){b!==c&&(a.options.allowDrop=b,a.updateView())});c.$watch("autoExpand",function(b,c){b!==c&&(a.options.autoExpand=b)});c.$watch("controlStyle",function(b,c){b!==c&&a.updateControlStyle(b)});c.$watch("editorSettings",function(b,c){b!==c&&a.updateEditorSettings(b)});c.$watch("expandingColumnIndex",function(b,c){b!==c&&(a.options.expandColIndex=b)});c.$watch("fields",function(b,c){b!==c&&(a.updateDataFields(b),a.UpdateData())});c.$watch("fillSpace",
function(b,c){b!==c&&(a.options.fillSpace=b)});c.$watch("gridLines",function(b,c){b!==c&&(a.options.gridLines=b,a.updateView())});c.$watch("hoverSelection",function(b,c){b!==c&&(a.options.hoverSelection=b)});c.$watch("indent",function(b,c){b!==c&&(a.options.indent=b,a.updateLayout())});c.$watch("rowIcon",function(b,c){b!==c&&(a.options.rowIcon=b,a.updateLayout())});c.$watch("labelEdit",function(b,c){b!==c&&(a.options.labelEdit=b)});c.$watch("paging",function(b,c){b!==c&&(a.updatePaging(b),a.resetPageNumber(),
a.updateCurrentLayout())},!0);c.$watch("pathSeparator",function(b,c){b!==c&&(a.options.pathSeparator=b)});c.$watch("rtl",function(b,c){b!==c&&(a.options.rtl=b,a.updateLayout())});a.resetSelection=function(){switch(a.options.selectionMode){case "none":a.clearPrevSelection();break;default:a.clearPrevSelection(a.rowSelection())}};c.$watch("selectionMode",function(b,c){b!==c&&(a.options.selectionMode=b,a.resetSelection())});c.$watch("showExpandBoxes",function(b,c){b!==c&&(a.options.showExpandBoxes=b,
a.updateLayout())});c.$watch("showFooter",function(b,c){b!==c&&(a.options.showFooter=b,a.updateLayout())});c.$watch("showHeader",function(b,c){b!==c&&(a.options.showHeader=b,a.updateLayout())});c.$watch("showIcons",function(b,c){b!==c&&(a.options.showIcons=b,a.updateLayout())});c.$watch("selectedRow",function(b,c){b!==c&&(c&&(c.selected=!1),a.options.selectedRow=b,a.callAfterSelect(b))});this.sortComparer=this.sortColumn=null;c.$watch("sorting",function(b,c){b!==c&&(a.options.sorting=b)});c.$on(c.name+
"-sort",function(b,c,e,g){a.sort(c,e,g)});this.sort=function(b,c,e){a.sortColumn=b;a.sortComparer=e;if("ascending"==c||"descending"==c||"none"==c)a.options.sorting=c;a.updateCurrentLayout();a.callChange()};this.getCellIndexInCollection=function(b,c,e){var g=-1;if(b)for(var f=0;f<b.length;f++)if(void 0==b[f][a.options.cellFields.cid]){g=c;break}else if(b[f][a.options.cellFields.cid]==e){g=f;break}return g};this.isSortingAllowed=function(){return"ascending"==a.options.sorting||"descending"==a.options.sorting};
this.applySorting=function(b){if(b&&(!a.sortColumn||0!=a.sortColumn[a.options.columnFields.visible])){var c=a.getColumnCurrentIndex(a.sortColumn),e=0<=c?c:a.options.expandColIndex;if(e<a.columnList.length){var f=a.columnList[e][a.options.columnFields.id];a.sortColumn&&a.sortColumn[a.options.columnFields.comparer]?b.sort(a.sortColumn[a.options.columnFields.comparer]):a.sortComparer?b.sort(a.sortComparer):a.isSortingAllowed()&&b.sort(function(b,c){var d=null,h=null;if(b[a.options.rowFields.cells]){var n=
a.getCellIndexInCollection(b[a.options.rowFields.cells],e,f);0<=n&&((d=b[a.options.rowFields.cells][n][a.options.cellFields.value])||(d=b[a.options.rowFields.cells][n][a.options.cellFields.text]),l.isObject(d)&&(d=d.value?d.value:d.text))}c[a.options.rowFields.cells]&&(n=a.getCellIndexInCollection(c[a.options.rowFields.cells],e,f),0<=n&&((h=c[a.options.rowFields.cells][n][a.options.cellFields.value])||(h=c[a.options.rowFields.cells][n][a.options.cellFields.text]),l.isObject(h)&&(h=h.value?h.value:
h.text)));d=void 0!=d?d:null;h=void 0!=h?h:null;switch(a.options.sorting){case "ascending":if(d<h)return-1;if(d>h)return 1;break;case "descending":if(d>h)return-1;if(d<h)return 1;break;default:return 0}})}}};var A=function(b){if(b){var c=l.isFieldAvailable(b.general,"iui-treegrid-column"),e;e=(e=b.header)?{content:l.isFieldAvailable(e.content,"iui-treegrid-column-header-cell-content"),disabled:l.isFieldAvailable(e.disabled,"iui-treegrid-column-header-disabled"),normal:l.isFieldAvailable(e.normal,
"iui-treegrid-column-header"),hovered:l.isFieldAvailable(e.hovered,"iui-treegrid-column-header-hovered"),selected:l.isFieldAvailable(e.selected,"iui-treegrid-column-header-selected")}:a.options.controlStyle.column.header;b=(b=b.footer)?{content:l.isFieldAvailable(b.content,"iui-treegrid-column-footer-cell-content"),disabled:l.isFieldAvailable(b.disabled,"iui-treegrid-column-footer-disabled"),normal:l.isFieldAvailable(b.normal,"iui-treegrid-column-footer"),hovered:l.isFieldAvailable(b.hovered,"iui-treegrid-column-footer-hovered"),
selected:l.isFieldAvailable(b.selected,"iui-treegrid-column-footer-selected")}:a.options.controlStyle.column.footer;return{general:c,header:e,footer:b}}return a.options.controlStyle.column};this.getExpandBoxStyle=function(b){return b?{general:l.isFieldAvailable(b.general,"iui-treegrid-expand-box"),animated:l.isFieldAvailable(b.animated,"iui-treegrid-expand-box-load"),expanded:l.isFieldAvailable(b.expanded,"iui-treegrid-expand-box-open"),collapsed:l.isFieldAvailable(b.collapsed,"iui-treegrid-expand-box-close")}:
a.options.controlStyle.row.expandBox};var jb=function(b){if(b){var c;c=(c=b.general)?{disabled:l.isFieldAvailable(c.disabled,"iui-treegrid-row-disabled"),focused:l.isFieldAvailable(c.focused,"iui-treegrid-row-focused"),normal:l.isFieldAvailable(c.normal,"iui-treegrid-row"),hovered:l.isFieldAvailable(c.hovered,"iui-treegrid-row-hovered"),selected:l.isFieldAvailable(c.selected,"iui-treegrid-row-selected")}:a.options.controlStyle.row.general;var e;var f=b.checkBox;f?(e=l.isFieldAvailable(f.general,"iui-checkbox"),
f=(f=f.box)?{general:l.isFieldAvailable(f.general,"iui-checkbox-box"),disabled:l.isFieldAvailable(f.disabled,"iui-checkbox-disabled"),checked:l.isFieldAvailable(f.checked,"iui-checkbox-checked"),indeterminate:l.isFieldAvailable(f.indeterminate,"iui-checkbox-indeterminate"),unchecked:l.isFieldAvailable(f.unchecked,"iui-checkbox-unchecked")}:a.options.controlStyle.row.checkBox.box,e={general:e,box:f}):e=a.options.controlStyle.row.checkBox;f=a.getExpandBoxStyle(b.expandBox);b=(b=b.cell)?{content:l.isFieldAvailable(b.content,
"iui-treegrid-row-cell-content"),general:l.isFieldAvailable(b.general,"iui-treegrid-row-cell"),disabled:l.isFieldAvailable(b.disabled,"iui-treegrid-row-cell-disabled"),focused:l.isFieldAvailable(b.focused,"iui-treegrid-row-cell-focused"),normal:l.isFieldAvailable(b.normal,"iui-treegrid-row-cell"),hovered:l.isFieldAvailable(b.hovered,"iui-treegrid-row-cell-hovered"),selected:l.isFieldAvailable(b.selected,"iui-treegrid-row-cell-selected")}:a.options.controlStyle.row.cell;return{general:c,checkBox:e,
expandBox:f,cell:b}}return a.options.controlStyle.row},z=function(b){return b?{content:l.isFieldAvailable(b.content,"iui-treegrid-row-cell-content"),general:l.isFieldAvailable(b.general,"iui-treegrid-row-cell"),disabled:l.isFieldAvailable(b.disabled,"iui-treegrid-row-cell-disabled"),focused:l.isFieldAvailable(b.focused,"iui-treegrid-row-cell-focused"),normal:l.isFieldAvailable(b.normal,"iui-treegrid-row-cell"),hovered:l.isFieldAvailable(b.hovered,"iui-treegrid-row-cell-hovered"),selected:l.isFieldAvailable(b.selected,
"iui-treegrid-row-cell-selected")}:a.options.controlStyle.cell};this.updateControlStyle=function(b){a.options.controlStyle=b?{general:l.isFieldAvailable(b.general,"iui-treegrid"),column:A(b.column),row:jb(b.row),cell:z(b.cell)}:{general:l.isFieldAvailable(a.defaultStyle.general,"iui-treegrid"),column:A(a.defaultStyle.column),row:jb(a.defaultStyle.row),cell:z(a.defaultStyle.cell)}};this.getCurrentColumnStyle=function(b,c,e){var f=a.options.controlStyle.column;b&&b.style&&(f=b.style);b=a.options.controlStyle.column.body;
var h=f.body;switch(c){case "header":b=a.options.controlStyle.column.header;h=f.header;break;case "footer":b=a.options.controlStyle.column.footer,h=f.footer}if(e)switch(e){case "content":return h&&h.content?h.content:b.content;case "disabled":return h&&h.disabled?h.disabled:b.disabled;case "hovered":return h&&h.hovered?h.hovered:b.hovered;case "selected":return h&&h.selected?h.selected:b.selected;default:return h&&h.normal?h.normal:b.normal}else return c?h?h:b:f?f:a.options.controlStyle.column};this.getCurrentRowStyle=
function(b,c){var e=a.options.controlStyle.row;if(b)switch(b[a.options.rowFields.style]){case "initial":break;case "parent":return a.getCurrentRowStyle(a.getParent(b),c);default:null!=b.style&&(e=b.style)}if(c){if(l.isString(e.general))return e.general;switch(c){case "disabled":return e.general&&e.general.disabled?e.general.disabled:a.options.controlStyle.row.general.disabled;case "focused":return e.general&&e.general.focused?e.general.focused:a.options.controlStyle.row.general.focused;case "hovered":return e.general&&
e.general.hovered?e.general.hovered:a.options.controlStyle.row.general.hovered;case "selected":return e.general&&e.general.selected?e.general.selected:a.options.controlStyle.row.general.selected;default:return e.general&&e.general.normal?e.general.normal:a.options.controlStyle.row.general.normal}}else return e?e:a.options.controlStyle.row};this.getDefaultCellContentClass=function(){return"iui-treegrid-row-cell-content"};this.getDefaultCellLabelClass=function(){return"iui-treegrid-row-cell-label"};
this.getDefaultCellBorderClass=function(){return"iui-treegrid-lines-both"};this.getCurrentCellStyle=function(b,c,e){var f=a.options.controlStyle.row.cell;if(c)switch(c[a.options.cellFields.style]){case "initial":break;case "parent":b&&(f=z(a.getCurrentRowStyle(b)));break;default:c.style&&(f=c.style)}if(e)switch(e){case "content":return f.content?f.content:a.options.controlStyle.cell.content;case "disabled":return f.disabled?f.disabled:a.options.controlStyle.cell.disabled;case "focused":return f.focused?
f.focused:a.options.controlStyle.cell.focused;case "hovered":return f.hovered?f.hovered:a.options.controlStyle.cell.hovered;case "selected":return f.selected?f.selected:a.options.controlStyle.cell.selected;default:return f.normal?f.normal:a.options.controlStyle.cell.normal}else return f?f:a.options.controlStyle.row.cell}}]).directive("iuiTreegrid",["$compile","$timeout","$interval","IntegralUIInternalService","IntegralUIDragDrop","$window","IntegralUIListCtrlService",function(c,n,e,f,p,l,oa){return{restrict:"EA",
controller:"IntegralUITreeGridController",transclude:!0,replace:!0,template:'<div class="iui-treegrid" data-element="treegrid"><div class="iui-treegrid-block"></div></div>',scope:{allowAnimation:"=",allowCellFocus:"=",allowColumnReorder:"=",allowFilter:"=",allowFocus:"=",allowDrag:"=",allowDrop:"=",animationSpeed:"=",autoExpand:"=",columns:"=",controlStyle:"=",editorSettings:"=",expandingColumnIndex:"=",fields:"=",fillSpace:"=",gridLines:"=",hoverSelection:"=",indent:"=",labelEdit:"=",name:"@",options:"=?",
paging:"=?",pathSeparator:"@",rowIcon:"=",rows:"=",selectedIndex:"=",selectedRow:"=",selectionMode:"@",showExpandBoxes:"=",showFooter:"=",showHeader:"=",showIcons:"=",sorting:"@",afterCollapse:"&",afterEdit:"&",afterExpand:"&",afterLabelEdit:"&",afterSelect:"&",beforeCollapse:"&",beforeEdit:"&",beforeExpand:"&",beforeLabelEdit:"&",beforeSelect:"&",cellClick:"&",cellHover:"&",cellvalueChanged:"&",cellvalueChanging:"&",change:"&",clearColumns:"&",clearRows:"&",columnAdded:"&",columnAdding:"&",columnClick:"&",
columnDblclick:"&",columnHover:"&",columnPoschanging:"&",columnPoschanged:"&",columnRemoved:"&",columnRemoving:"&",columnRightclick:"&",columnSizechanged:"&",dragDrop:"&",dragEnter:"&",dragLeave:"&",dragOver:"&",events:"=?",gotFocus:"&",keyDown:"&",keyPress:"&",keyUp:"&",loadComplete:"&",lostFocus:"&",rowAdded:"&",rowAdding:"&",rowClick:"&",rowDblclick:"&",rowHover:"&",rowRemoved:"&",rowRemoving:"&",rowRightclick:"&",scrollposChanged:"&",selectionChanged:"&",updateComplete:"&"},link:function(h,r,
Qb,a,lc){var F=this,U=r.children().eq(0),J=angular.element('<div class="iui-scrollbar-vertical"><div class="iui-scroll-button-thumb-vertical"></div></div>'),w=angular.element('<div class="iui-scrollbar-horizontal"><div class="iui-scroll-button-thumb-horizontal"></div></div>'),va=angular.element('<div class="iui-scrollbar-corner"></div>'),Ca=null,wa=null,xa=null,ib=!1,y=angular.element('<input type="text" class="iui-label-editor" draggable="false" />');a.labelEditStatus=function(a){if(void 0!=a)ib=
a;else return ib};var Ua=function(){var b="iui-treegrid-block";a.options.showStatusIcons&&(b+=" "+b+"-shift-left");a.options.rtl&&(b+=" "+b+"-rtl");return b};h.$on("$destroy",function(a){F.s2t();ia&&ia.unbind("mousedown");r.unbind("click dblclick dragenter dragleave dragend drop keydown mousedown mouseleave mousemove mousewheel scroll touchstart touchmove touchend");angular.element(l).unbind("dragenter dragover dragend mousemove mousedown mouseup");y&&y.unbind("blur focus keydown mousedown");mc();
E&&E.$destroy();x&&x.$destroy()});a.dragIcon=document.createElement("img");a.dragIcon.width=1;r.append(a.getDropMarkWindow());a.dropMark();var pa=function(){Ca&&(n.cancel(Ca),Ca=null)};a.addDropMark=function(){var b;b=r[0];for(var c=null;b;){if(b===document.getElementsByTagName("body")[0]){c=b;break}b=b.offsetParent}if(b=c)angular.element(b).append(a.getDropMarkWindow()),a.dropMark()};a.removeDropMark=function(){a.getDropMarkWindow().remove()};a.isDropInRange=function(b){b=a.getMousePos(b);var c=
r[0].getBoundingClientRect();b.x-=angular.element(l)[0].pageXOffset;b.y-=angular.element(l)[0].pageYOffset;var q=c.top+D,c=c.bottom-N;K&&w&&(c-=w[0].offsetHeight);return b.y<q||b.y>c?!1:!0};var A=angular.element('<div style="opacity:0.75;position:absolute;z-index:999"></div>'),jb=function(){A&&(A.remove(),A.css("top","-9999999px"),A.css("left","-9999999px"))};a.getCellElemFromRow=function(b){return b&&(b=a.getElemFromRow(b))?a.getChildElement(b,"cell"):null};a.openEditor=function(b,c){if(b)switch(b.type){case "cell":c||
(c=a.getColumnById(b[a.options.cellFields.cid]));if(!c){var q=a.getCellColumnIndex(b),u=a.columnsObj.getList();u&&0<=q&&q<u.length&&(c=u[q])}if(c){var q=a.getCellType(b,a.getColumnRealIndex(c)),u=a.getCellRowIndex(b),k=a.getCellColumnIndex(b);if(u=a.getElemFromCell(u,k,c[a.options.columnFields.fixed]))switch(q){case "checkbox":break;case "combobox":break;case "incell":a.openInCellEditor(u,b,c);break;case "dropdown":a.openDropDownEditor(u,b,c);break;default:0!=b[a.options.cellFields.allowEdit]&&kb(null,
u,0)}}}};a.closeEditor=function(b,c){if(b)switch(b.type){case "cell":if(c||(c=a.getColumnById(b[a.options.cellFields.cid])),c)switch(a.getCellType(b,a.getColumnRealIndex(c))){case "incell":a.closeActiveEditor(b);break;case "dropdown":a.closeActiveEditor(b)}else a.closeActiveEditor()}else a.closeActiveEditor();d=null};var z=null,b=!1,d=null,C=null,g=angular.element('<span class="iui-edit-mark"></span>');a.openInCellEditor=function(m,t,q){b&&a.closeActiveEditor(t,!0);v();if(t&&q&&(d=t,q='<div ng-include="'+
q[a.options.columnFields.editorTemplate]+'"></div>',z=angular.element('<div class="iui-incell-editor"></div>'),z.append(c(q)(h.$parent)),0!=a.callBeforeEdit(t))){m.children().eq(0).append(z);b=!0;C="incell";hb();z.bind("mousedown",function(a){a.stopPropagation()});z.bind("mouseup",function(a){a.stopPropagation()});z.bind("click",function(a){a.stopPropagation()});z.bind("keydown",function(b){switch(b.keyCode){case 27:a.closeActiveEditor(d)}b.stopPropagation()});z.bind("keypress",function(a){a.stopPropagation()});
z.bind("keyup",function(a){a.stopPropagation()});var u=n(function(){var a=f.getPadding(m[0]),b=parseInt(getComputedStyle(m[0]).width,10)-(a.left+a.right),a=parseInt(getComputedStyle(m[0]).height,10)+2;z.css("width",b+"px");z.css("height",a+"px");z.css("top",m[0].offsetTop+"px");h.$apply();z.children&&1==z.children().length&&(b=z.children().eq(0),b.children&&1==b.children().length&&b.children().eq(0).css("height",a+"px"));n.cancel(u)},1)}};a.openDropDownEditor=function(m,t,q){b&&a.closeActiveEditor(t,
!0);v();if(t&&q&&(d=t,q='<div ng-include="'+q[a.options.columnFields.editorTemplate]+'"></div>',z=angular.element('<div class="iui-dropdown-editor"></div>'),z.append(c(q)(h.$parent)),0!=a.callBeforeEdit(t)))var u=n(function(){angular.element(Ma).append(z);z.bind("mousedown",function(a){a.stopPropagation()});z.bind("mouseup",function(a){a.stopPropagation()});z.bind("click",function(a){a.stopPropagation()});b=!0;C="dropdown";var a=m[0].getBoundingClientRect(),c=angular.element(l)[0].pageXOffset,q=angular.element(l)[0].pageYOffset,
t=n(function(){var b=f.getPadding(m[0]),b=parseInt(getComputedStyle(m[0]).width,10)+(b.left+b.right),u=f.getPadding(z[0]),b=b-(u.left+u.right),u=parseInt(getComputedStyle(z[0]).width,10);b<u&&(b=u);u=a.right-(b+3)+c;z.css("top",a.bottom+q+"px");z.css("left",u+"px");z.css("width",b+"px");h.$apply();n.cancel(t)},1);n.cancel(u)},1)};a.closeActiveEditor=function(c,t){b=!1;v();z&&z.remove();C=d=null;t||a.callAfterEdit(c)};var v=function(){z&&z.unbind("click keydown keypress keyup mousedown mouseup")},
ub=function(a,b){a&&(g.addClass("iui-edit-mark iui-edit-mark-"+b),a.append(g),g.css("left",a[0].offsetLeft+a[0].offsetWidth-g[0].offsetWidth-2+"px"),g.css("top",a[0].offsetTop+(a[0].offsetHeight-g[0].offsetHeight)/2+"px"))},hb=function(){g&&("dropdown"!=C||"dropdown"==C&&!b)&&(g.removeAttr("class"),g.remove())},Rb=null,Ba=angular.element('<div class="iui-dropdown-mark"><span></span></div>'),Sb=function(a,b){!a||Va&&!b||(a.append(Ba),Ba.css("top",a[0].offsetTop+"px"),Ba.css("left",a[0].offsetLeft+
a[0].offsetWidth-Ba[0].offsetWidth+"px"),Ba.css("height",getComputedStyle(a[0]).height))},Da=function(a){!Ba||Va&&!a||Ba.remove()};a.getCellType=function(b,c){var q=null,u="label";b&&(q=a.getColumnById(b[a.options.cellFields.cid]));!q&&0<=c&&c<a.columnList.length&&(q=a.columnList[c]);q&&(u=q[a.options.columnFields.editorType]);return u};var Ma=f.getBodyElem(r[0]),lb=f.getUniqueId(4),Z=null,Va=!1,mb=0,Qc=function(b,t,q){if(Ma&&b.items&&0<b.items.length){b=f.getUniqueId(4);var u=c('<iui-list name="'+
b+'" style="position:absolute;top:-99px;height:100px" items="data['+t+"].column."+a.options.columnFields.editorSettings+'.items"></iui-list>')(E);angular.element(Ma).append(u);oa.updateLayout(b);var k=n(function(){if(0<u.children().length){var a=u.children().eq(0);0<a.children().length&&(mb=angular.element(a.children().eq(0))[0].offsetHeight,q&&(q.avgItemHeight=mb))}u.remove();n.cancel(k)},1)}},Na=null,vb=function(b,t,q,u){var k=a.getCell(q,u);if(k!=Rb&&(Rb=k,Z&&Z.remove(),Na&&Na.$destroy(),Ma)){Na=
h.$new();Na.data=a.columnList[u];d=k;var e='<iui-list name="'+lb+'" style="position:absolute;"',e=e+(' items="data.'+a.options.columnFields.editorSettings+'.items"'),e=e+(' item-icon="data.'+a.options.columnFields.editorSettings+'.itemIcon"'),e=e+(' show-icons="data.'+a.options.columnFields.editorSettings+'.showIcons"'),e=e+(' checkbox-settings="data.'+a.options.columnFields.editorSettings+'.checkBoxSettings"'),e=e+(' show-check-boxes="data.'+a.options.columnFields.editorSettings+'.checkBoxSettings.showCheckBoxes"');
Z=c(e+(' nav-selection="false" before-select="onCellValueChanging(e, '+q+", "+u+')" after-select="onCellValueChanged(e, '+q+", "+u+')"></iui-list>'))(Na);mb=0;Wa&&u<Wa.length&&(mb=Wa[u].avgItemHeight);var Pc=n(function(){angular.element(Ma).append(Z);var c=b[0].getBoundingClientRect(),u=angular.element(l)[0].pageXOffset,q=angular.element(l)[0].pageYOffset,q=c.bottom+q-1,c=c.left+u,u=b.children().eq(0),d=f.getPadding(u[0]),u=parseInt(getComputedStyle(u[0]).width,10)+(d.left+d.right),d=f.getPadding(Z[0]),
u=u-(d.left+d.right);void 0!=t.dropDownWidth&&u<t.dropDownWidth&&(u=t.dropDownWidth);d=void 0!=t.dropDownHeight?t.dropDownHeight:100;void 0!=t.maxDropDownItems&&(d=mb*t.maxDropDownItems);Z.css("top",q+"px");Z.css("left",c+"px");Z.css("width",u+"px");Z.css("height",d+"px");Z.css("z-index","999");k&&k[a.options.cellFields.value]&&oa.selectedItem(lb,k[a.options.cellFields.value]);oa.updateLayout(lb);var e=n(function(){if(k&&k[a.options.cellFields.value]){oa.ensureVisible(lb,k[a.options.cellFields.value]);
var b=n(function(){oa.focus(lb,k[a.options.cellFields.value]);n.cancel(b)},1)}n.cancel(e)},10);Ba&&(Da(!0),Sb(b,!0));Va=!0;Rc();n.cancel(Pc)},1)}};a.removeDropDownList=function(a){Z&&(Rb=null,Z.remove(),Va=!1,a||Da(),Z.unbind("keydown"));Na&&Na.$destroy();d=null};var Rc=function(){Z.bind("keydown",function(b){switch(b.keyCode){case 27:a.removeDropDownList(),Da()}})},kb=function(b,c,q){a.options.labelEdit&&(void 0===q&&(q=500),wa=n(function(){if(wa)var a=n(function(){wb(b,c,!0);n.cancel(a)},q);n.cancel(wa)},
q/3))},xb=function(){wa&&(n.cancel(wa),wa=null)},Xa=null,Ya=null,wb=function(b,c,q){if(a.dragDropStatus())f=y[0].value,a.labelEditStatus(!1),y.unbind("blur focus keydown mousedown"),y.remove(),Ya=Xa=null;else{var u=a.getRowFromChildElem(c);if(u){var k=a.getRowCurrentIndex(u),d=a.getIndexFromElem(c),e=a.getCellObject(k,d),f="",f=c.children().eq(0);if(e)if(q){if(0!=a.callBeforeLabelEdit(e)){Xa=u;Ya=e;a.labelEditStatus(!0);y.unbind("blur focus keydown mousedown");b=parseInt(getComputedStyle(c[0]).width,
10)-4;q=parseInt(getComputedStyle(c[0]).height,10)-3;y.css("top",c[0].offsetTop+"px");y.css("left",c[0].offsetLeft+"px");y.css("width",b+"px");y.css("height",q+"px");f.append(y);y[0].value=e[a.options.cellFields.text];y.bind("keydown",function(b){switch(b.keyCode){case 13:e[a.options.cellFields.text]=y[0].value?y[0].value:"null";wb(b,c,!1);break;case 27:wb(b,c,!1)}b.stopPropagation()});y.bind("focus",function(b){var c=angular.element(this);a.callGotFocus(b,Xa,Ya,!0,c[0].value)});y.bind("blur",function(a){wb(a)});
y.bind("mousedown",function(a){a.stopPropagation()});var h=n(function(){y[0].focus();y[0].select();n.cancel(h)},10)}}else f=y[0].value,a.labelEditStatus(!1),y.unbind("blur focus keydown mousedown"),y.remove(),a.updateView(),a.updateFocus(k,d),a.callAfterLabelEdit(e),a.callLostFocus(b,u,e,!0,f),Ya=Xa=null}else f=y[0].value,a.labelEditStatus(!1),y.unbind("blur focus keydown mousedown"),y.remove(),a.callAfterLabelEdit(),a.updateView(),a.callLostFocus(b,Xa,Ya,!0,f),Ya=Xa=null}};r.bind("mousemove",function(b){if(0===
b.button&&ka&&L){a.getColumnCurrentIndex(L);var c=a.getMousePos(b),q=c.y+16,c=c.x+20;qa.empty();qa.append("<span>"+L[a.options.columnFields.headerText]+"</span>");qa.css("top",q+"px");qa.css("left",c+"px");qa.css("display","block");nc();b.stopPropagation()}});var qc=function(){for(var b=0,c="none";3>b;){if((c=a.getRowElems(c))&&0<c.length)for(var q=0;q<c.length;q++){var u=angular.element(c[q]);oc(u);for(var u=u.find("td"),k=0;k<u.length;k++){var d=angular.element(u[k]),e=a.getElement(d,"expandbox");
e&&e.unbind("click touchend");pc(d)}}b++;c=1==b?"left":"right"}},mc=function(){v();for(var b=0,c="none";3>b;){var q=a.getRowElems(c);if(q&&0<q.length)for(var u=0;u<q.length;u++){var k=angular.element(q[u]);oc(k);for(var k=k.find("td"),d=0;d<k.length;d++){var e=angular.element(k[d]),f=a.getElement(e,"expandbox");f&&f.unbind("click touchend");pc(e)}}if((q=a.getHeaderElem(c))&&0<q.length)for(u=0;u<q.length;u++)for(k=angular.element(q[u]),k=k.find("td"),d=0;d<k.length;d++)(e=angular.element(k[d]))&&(c=
a.getChildElement(e,"column-header-cell"))&&(c=a.getContentElement(c,"filter-button"))&&c.unbind("mousedown");b++;c=1==b?"left":"right"}},Vc=function(){qc();for(var b=0,c="none";3>b;){if((c=a.getRowElems(c))&&0<c.length)for(var q=null,u=c.length-1,k=0;k<=u;k++){q=angular.element(c[k]);Sc(q);for(var d=q.find("td"),e=0;e<d.length;e++){var f=angular.element(d[e]);Tc(a.getElement(f,"expandbox"));Uc(f,a.getRowFromElem(q),e)}}b++;c=1==b?"left":"right"}},ka=!1,L=null,Za=-1,yb=function(b,c){if(b){var q=a.getColumnCurrentIndex(b),
u=a.getColumnWidth(b);return a.isColumnWithFixedWidth(q)||10<c.x&&c.x<u-10}return!1},Vb=function(b){b=b.find("td");for(var c=0;c<b.length;c++)currentElem=angular.element(b[c]),currentElem.bind("click",function(b){if(1===b.which){var c=f.getClientMousePos(b,this),k=a.getColumnFromElem(this);k&&yb(k,c)&&a.callColumnClick(k,a.getMousePos(b))}b.stopPropagation()}),currentElem.bind("dblclick",function(b){b.preventDefault();if(1===b.which){var c=f.getClientMousePos(b,this),k=a.getColumnFromElem(this);k&&
yb(k,c)&&a.callColumnDblClick(k,a.getMousePos(b))}b.stopPropagation()}),currentElem.bind("mouseenter",function(b){if(!P&&!la){var c=a.getColumnFromElem(this);c&&(a.hoverColumn=c,a.refresh(c),a.callColumnHover(c));if(1===b.which&&ka&&L&&a.hoverColumn&&0!=a.hoverColumn[a.options.columnFields.allowDrop]&&aa&&(aa.remove(),a.hoverColumn!=L)){var k=angular.element(this);k.append(aa);b=parseInt(getComputedStyle(k[0]).height,10);c=parseInt(getComputedStyle(aa[0]).height,10);k=f.getPadding(k[0]);aa.css("top",
(b+k.top+k.bottom-c)/2+"px")}}}),currentElem.bind("mouseleave",function(b){P||la||(a.hoverColumn=null,(b=a.getColumnFromElem(this))&&a.refresh(b),aa&&aa.remove(),P||r.css("cursor","default"))}),currentElem.bind("mousemove",function(b){var c=angular.element(this);if(1===b.which&&ka&&L&&a.hoverColumn&&a.hoverColumn!=L&&0!=a.hoverColumn[a.options.columnFields.allowDrop]&&L[a.options.columnFields.fixed]==a.hoverColumn[a.options.columnFields.fixed])c=parseInt(getComputedStyle(c[0]).width,10),aa.empty(),
Za=-1,b.offsetX>c/2?(Za=2,aa.append('<span class="iui-treegrid-column-reorder-mark-right"></span>'),aa.css("left","auto"),aa.css("right","0")):(Za=1,aa.append('<span class="iui-treegrid-column-reorder-mark-left"></span>'),aa.css("left","0"),aa.css("right","auto"));else{b=f.getClientMousePos(b,this);var c=parseInt(a.getIndexFromElem(this),10),k=a.getColumnWidth(a.columnList[c]),m=10;a.isFilteringAllowed(a.columnList[c])&&(m=0);10>b.x&&!a.isColumnWithFixedWidth(c-1)&&rc(c,"left")?(r.css("cursor","ew-resize"),
ya="left"):b.x>k-m&&!a.isColumnWithFixedWidth(c)&&rc(c,"right")?(r.css("cursor","ew-resize"),ya="right"):P||(r.css("cursor","default"),ya="none")}}),currentElem.bind("mouseup",function(b){if(1===b.which&&ka&&L&&a.hoverColumn&&a.hoverColumn!=L&&0!=a.hoverColumn[a.options.columnFields.allowDrop]&&L[a.options.columnFields.fixed]==a.hoverColumn[a.options.columnFields.fixed]&&0!=a.callColumnPosChanging(L,a.hoverColumn)){b=a.columnList[0];0<=a.options.expandColIndex&&a.options.expandColIndex<a.columnList.length&&
(b=a.columnList[a.options.expandColIndex]);var c=a.getColumnCurrentIndex(L),c=a.getColumnRealIndex(c),k=a.getColumnCurrentIndex(a.hoverColumn),k=a.getColumnRealIndex(k);c!=k&&(c<k?1==Za&&k--:c>k&&2==Za&&k++,a.columnsObj.moveObject(c,k),a.updateColumnList(),b=a.getColumnCurrentIndex(b),b!=a.options.expandColIndex?(a.options.expandColIndex=b,a.updateLayout()):a.updateView(),a.callColumnPosChanged(L,a.hoverColumn))}L=null;Za=-1;P=ka=!1;r.css("cursor","default")}),currentElem.bind("mousedown",function(b){a.removeDropDownList();
a.closeFilterWindow();a.closeEditor();f.getClientMousePos(b,this);var c=parseInt(a.getIndexFromElem(this),10);if(0===b.button&&!P){var k=c,m="none";0<=c&&c<a.columnList.length&&(m=a.columnList[c][a.options.columnFields.fixed]);switch(ya){case "left":"right"==m?k=c:(c=Tb(k-1,m))?(k=a.getColumnCurrentIndex(c),0<=k&&k<a.columnList.length&&(a.columnList[k][a.options.columnFields.fixed]!=m?(k=-1,P=!1):P=!0)):P=!1;0<=k&&(P=!0);break;case "right":"right"==m?(c=Ub(k+1,m))?(k=a.getColumnCurrentIndex(c),0<=
k&&k<a.columnList.length&&(a.columnList[k][a.options.columnFields.fixed]!=m?(k=-1,P=!1):P=!0)):P=!1:(k=c,P=!0)}!a.isColumnWithFixedWidth(k)&&P?a.setColumnResizingParams(k,ya,a.getMousePos(b).x):P=!1}if(!P&&(k=a.getColumnFromChildElem(this)))switch(m=f.getClientMousePos(b,this),yb(k,m)&&a.columnSelection(k),b.which){case 1:a.options.allowColumnReorder&&0!=k[a.options.columnFields.allowDrag]&&0==ka&&(L=k,a.getMousePos(b),ka=!0,(k=f.getBodyElem(r[0]))&&angular.element(k).append(qa));break;case 3:yb(k,
m)&&a.callColumnRightClick(k,a.getMousePos(b))}b.stopPropagation()}),function(b){b&&(b=a.getChildElement(b,"column-header-cell"))&&(b=a.getContentElement(b,"filter-button"))&&b.bind("mousedown",function(a){1==a.which&&Wc(this);a.stopPropagation()})}(currentElem)},ia=null,Wc=function(b){a.closeFilterWindow();var d=a.getColumnFromChildElem(b);if(d){var q=angular.element(b),u=q.parent().parent();if(Ma){b='<div ng-include="'+d[a.options.columnFields.filterTemplate]+'"></div>';ia=angular.element('<div class="iui-filter-window"></div>');
ia.append(c(b)(h.$parent));var k=n(function(){angular.element(Ma).append(ia);ia.bind("mousedown",function(a){a.stopPropagation()});q[0].getBoundingClientRect();var a=u[0].getBoundingClientRect(),b=angular.element(l)[0].pageXOffset,c=angular.element(l)[0].pageYOffset,m=n(function(){var k=a.bottom+c,u=a.right-(parseInt(getComputedStyle(ia[0]).width,10)+3)+b;ia.css("top",k+"px");ia.css("left",u+"px");n.cancel(m)},1);n.cancel(k)},1)}}};a.closeFilterWindow=function(){ia&&(ia.unbind("mousedown"),ia.remove())};
var oc=function(a){a&&a.unbind("blur dragover dragend focus keydown keyup keypress mousedown mouseenter mouseleave")},Sc=function(b){b&&(b.bind("dragover",function(b){var c=a.getRowFromElem(this);if(c&&a.isRowEnabled(c)){if(a.isScrollBarVisible("vertical")){var c=a.getMousePos(b),m=r[0].getBoundingClientRect();c.x-=angular.element(l)[0].pageXOffset;c.y-=angular.element(l)[0].pageYOffset;var k=m.top+D+25,m=m.bottom-N-25;K&&w&&(m-=w[0].offsetHeight);c.y<k?zb(!1):c.y>m?zb(!0):$a()}else $a();b.stopPropagation()}}),
b.bind("dragend",function(b){var c=a.getRowFromElem(this);c&&a.isRowEnabled(c)&&(b.preventDefault(),a.dragDropStatus(!1),a.dropMark(),p.getData().source||p.clearData())}),b.bind("mouseenter",function(b){if(!la){var c=a.getRowFromElem(this);c&&a.isRowEnabled(c)&&!ka&&(a.hoverRow=c,a.refresh(c),a.callRowHover(b,c),a.options.hoverSelection&&(xa=n(function(){xa&&a.rowSelection(c,b.shiftKey,b.ctrlKey)},500)))}}),b.bind("mouseleave",function(b){la||(a.hoverRow=null,(b=a.getRowFromElem(this))&&a.isRowEnabled(b)&&
a.refresh(b),xa&&(n.cancel(xa),xa=null))}),b.bind("keydown",function(b){var c=a.getRowFromElem(this);if(c&&a.isRowEnabled(c)){var m=!0;a.callKeyDown(b,c);var k=a.getRowCurrentIndex(c);switch(b.keyCode){case 9:sc(b,c,k);break;case 16:a.updateSelectionStatus("shift");break;case 17:a.updateSelectionStatus("ctrl");break;case 27:m=!1;break;case 33:tc(b,k);break;case 34:uc(b,k);break;case 35:vc(b,k);break;case 36:wc(b,k);break;case 37:xc(b,c,k);break;case 32:b.preventDefault();Wb(void 0,void 0);a.rowSelection(c,
b.shiftKey,b.ctrlKey,c.selected);h.$apply();break;case 38:Xb(b,k);break;case 39:yc(b,c,k);break;case 40:Yb(b,k);break;default:(b.ctrlKey||b.metaKey)&&a.updateSelectionStatus("ctrl"),b.shiftKey&&a.updateSelectionStatus("shift")}m&&b.stopPropagation()}}),b.bind("keyup",function(b){var c=a.getRowFromElem(this);if(c&&a.isRowEnabled(c)){switch(b.keyCode){case 16:a.multiSelection(!1);break;case 17:a.multiSelection(!1);break;default:b.ctrlKey||b.metaKey||a.multiSelection(!1),b.shiftKey||a.multiSelection(!1)}a.callKeyUp(b,
c)}}),b.bind("keypress",function(b){var c=a.getRowFromElem(this);c&&a.isRowEnabled(c)&&a.callKeyPress(b,c)}),b.bind("mousedown",function(b){a.removeDropDownList();a.closeFilterWindow();a.closeEditor()}),b.bind("focus",function(b){var c=a.getRowFromElem(this);c&&a.isRowEnabled(c)?a.callGotFocus(b,c):a.updateFocus()}),b.bind("blur",function(b){var c=a.getRowFromElem(this);c&&a.isRowEnabled(c)&&a.callLostFocus(b,c)}))},Tc=function(b){b&&(b.bind("click",function(b){var c=a.getRowFromChildElem(this);c&&
a.isRowEnabled(c)&&(a.toggle(c),a.updateFocus(a.getRowCurrentIndex(c),a.options.expandColIndex),b.stopPropagation())}),b.bind("touchend",function(b){b.preventDefault();var c=a.getRowFromChildElem(this);c&&a.isRowEnabled(c)&&(a.toggle(c),a.updateFocus(a.getRowCurrentIndex(c),a.options.expandColIndex),b.stopPropagation())}))},Ab={x:0,y:0},ab={x:0,y:0},bb=!1,Zb=!1,za=null,zc=function(){return{x:angular.element(l)[0].pageXOffset,y:angular.element(l)[0].pageYOffset}},cb=function(a){var b=zc();return{x:a.x-
b.x,y:a.y-b.y}},Uc=function(c,e,q){c&&(c.bind("dragstart",function(b){if(a.labelEditStatus())b.preventDefault();else{p.clearData();var c=a.getRowFromChildElem(this);if(c&&a.isRowEnabled(c))if(xb(),a.isDragAllowed(c)){a.dragDropStatus(!0);a.addDropMark();b.dataTransfer?(b.dataTransfer.effectAllowed="move",b.dataTransfer.setData("text",c[a.options.rowFields.id]?c[a.options.rowFields.id].toString():"")):b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.effectAllowed="move",
b.originalEvent.dataTransfer.setData("text",c[a.options.rowFields.id]?c[a.options.rowFields.id].toString():""));b={source:c,sourceCtrl:a,sourceCollection:a.rowsObj};switch(a.options.selectionMode){case "multi-simple":b.source=a.options.selectedRows;break;case "multi-extended":b.source=a.options.selectedRows}p.setData(b)}else b.dataTransfer?b.dataTransfer.effectAllowed="none":b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.effectAllowed="none")}}),c.bind("dragover",function(b){var c=
a.getRowFromChildElem(this);if(c&&a.isRowEnabled(c)){var m=angular.element(this);b.preventDefault();var d=!0;b.dataTransfer?d="none"===b.dataTransfer.effectAllowed?!1:!0:b.originalEvent&&b.originalEvent.dataTransfer&&(d="none"===b.originalEvent.dataTransfer.effectAllowed?!1:!0);if(d&&(c=a.getRowFromChildElem(m))){var d=m[0].getBoundingClientRect(),q=angular.element(l)[0].pageXOffset,e=angular.element(l)[0].pageYOffset,t=a.getMousePos(b);t.x-=d.left+q;t.y-=d.top+e;m=p.getDropPos(t,{x:0,y:0,width:m[0].offsetWidth,
height:m[0].offsetHeight});q=p.getData();d=a.isDropAllowed(q.source,c,m);e={event:b,sourceTree:q.sourceCtrl?q.sourceCtrl.getCtrlName():"",dragRow:q.source,targetTree:a.getCtrlName(),targetRow:c,isDropAllowed:d,dropPos:m,mousePos:a.getMousePos(b)};e=a.callDragOver(e);if(d&&!1!==e){e=a.getMousePos(b);b=e.y+16;e=e.x+20;t=a.getDropMarkWindow();t.empty();var f="iui-drop-marker-move-in";switch(m){case 1:f="iui-drop-marker-move-up";break;case 2:f="iui-drop-marker-move-down"}t.append("<span class='"+f+"'></span><span class='iui-drop-marker-title'>"+
c[a.options.rowFields.text]+"</span>");a.updateDropMarkElem(a.getDropMarkWindow(),{top:b,left:e});a.dropMark(d);p.setData({source:q.source,sourceList:q.sourceList,target:c,dropPos:m})}else b.dataTransfer?b.dataTransfer.dropEffect="none":b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.dropEffect="none"),a.dropMark()}}}),c.bind("drop",function(b){var c=a.getRowFromChildElem(this);if(c&&a.isRowEnabled(c)){var m=angular.element(this);b.preventDefault();pa();a.dropMark();c=
!0;b.dataTransfer?c="none"===b.dataTransfer.effectAllowed?!1:!0:b.originalEvent&&b.originalEvent.dataTransfer&&(c="none"===b.originalEvent.dataTransfer.effectAllowed?!1:!0);if(c){var d=a.getRowFromChildElem(m);if(d){var m=p.getData(),q=m.source;q||(q=a.getDnDSource(b));if(c=a.isDropAllowed(q,d,m.dropPos)){a.toggle(d,!0);var e=a.getMousePos(b);q&&(c={event:b,sourceTree:m.sourceCtrl?m.sourceCtrl.getCtrlName():"",dragRow:q,targetTree:a.getCtrlName(),targetRow:d,targetCell:a.getCellAt(e.x,e.y),isDropAllowed:c,
dropPos:m.dropPos,mousePos:e},!1!==a.callDragDrop(c)&&(a.drop(m),h.$$phase||h.$apply()))}}}p.clearData();b.stopPropagation()}}),c.bind("dragenter",function(b){var c=a.getRowFromChildElem(this);if(c&&a.isRowEnabled(c)){b.preventDefault();if(a.options.autoExpand)var m=n(function(){Ca||(Ca=n(function(){Ca&&a.toggle(c,!0)},750));n.cancel(m)},1);var d=p.getData();d.source||(d.source=a.getDnDSource(b));d={event:b,sourceTree:d.sourceCtrl?d.sourceCtrl.getCtrlName():"",dragRow:d.source,targetTree:a.getCtrlName(),
targetRow:d.target,mousePos:a.getMousePos(b)};a.callDragEnter(d);b.stopPropagation()}}),c.bind("dragleave",function(b){a.hoverRow=null;var c=a.getRowFromChildElem(this);c&&a.isRowEnabled(c)&&(b.preventDefault(),pa(),c=p.getData(),c.source||(c.source=a.getDnDSource(b)),c={event:b,sourceTree:c.sourceCtrl?c.sourceCtrl.getCtrlName():"",dragRow:c.source,targetTree:a.getCtrlName(),targetRow:c.target,mousePos:a.getMousePos(b)},a.callDragLeave(c),b.stopPropagation())}),c.bind("touchstart",function(c){var m=
a.getRowFromChildElem(this);if(m&&a.isRowEnabled(m)&&(c.preventDefault(),(m=a.getTouchData(c))&&0<m.length)){Zb=!0;var q=n(function(){Zb=!1;n.cancel(q)},750);Ab=cb({x:m[0].pageX,y:m[0].pageY});a.closeFilterWindow();m=Ab;if((m=a.getRowAt(m.x,m.y))&&a.isRowEnabled(m)){var e=angular.element(this);a.mouseButtonStatus(!0);za=m;var t=a.getRowCurrentIndex(m),f=parseInt(a.getIndexFromElem(this),10),h=a.getCell(t,f),g=a.getCellType(h,f),l=null,p=a.options.editorSettings;e[0].focus();a.updateFocus(t,f);h&&
(l=a.getColumnById(h[a.options.cellFields.cid]));!l&&0<=f&&f<a.columnList.length&&(l=a.columnList[f]);var r="click"==a.options.editorSettings.activate;l&&l[a.options.columnFields.editorSettings]&&(p=l[a.options.columnFields.editorSettings],r=void 0!=p.activate?"click"==p.activate:r);h&&h!=d?a.closeEditor(d):a.closeEditor();switch(g){case "checkbox":break;case "combobox":a.rowSelection(m,c.shiftKey,c.ctrlKey);h&&0!=h[a.options.cellFields.allowEdit]&&l&&r?vb(angular.element(this),p,t,f):a.removeDropDownList();
break;case "incell":a.rowSelection(m,c.shiftKey,c.ctrlKey);!b&&h&&0!=h[a.options.cellFields.allowEdit]&&r&&a.openInCellEditor(e,h,l);break;case "dropdown":a.rowSelection(m,c.shiftKey,c.ctrlKey);!b&&h&&0!=h[a.options.cellFields.allowEdit]&&r&&a.openDropDownEditor(e,h,l);break;default:a.rowSelection(m,c.shiftKey,c.ctrlKey),a.removeDropDownList(),h&&0!=h[a.options.cellFields.allowEdit]&&r&&kb(c,angular.element(this))}}}}),c.bind("touchmove",function(b){var c,m,d=a.getRowFromChildElem(this);if(d&&a.isRowEnabled(d)&&
(d=a.getTouchData(b))&&0<d.length){ab=cb({x:d[0].pageX,y:d[0].pageY});var d=Math.abs(ab.x-Ab.x),q=Math.abs(ab.y-Ab.y),e=r[0].getBoundingClientRect();if(p.hitTest(ab.x,ab.y,e)){if(b.preventDefault(),A&&A.css("display","block"),!Zb)if(!bb&&(2<d||2<q)&&za&&a.isRowEnabled(za))if(angular.element(this),a.labelEditStatus())b.preventDefault();else{bb=!0;p.clearData();if((d=a.getTouchData(b))&&0<d.length&&(cb({x:d[0].pageX,y:d[0].pageY}),za&&a.isRowEnabled(za)&&(xb(),a.isDragAllowed(za)))){a.dragDropStatus(!0);
a.addDropMark();d={source:za,sourceCtrl:a,sourceCollection:a.rowsObj};switch(a.options.selectionMode){case "multi-simple":d.source=a.options.selectedRows;break;case "multi-extended":d.source=a.options.selectedRows}p.setData(d);if(d=a.getCellElemFromRow(za))if(d=a.getContentElement(d))A.empty(),A.append(d.clone()),A.css("display","none"),r.append(A)}b.stopPropagation()}else if(bb&&(angular.element(this),b.preventDefault(),(q=a.getTouchData(b))&&0<q.length)){var d=zc(),t=cb({x:q[0].pageX,y:q[0].pageY});
if(q=a.getRowAt(t.x,t.y)){var f=a.getCellElemFromRow(q);if(f){var e=f[0].getBoundingClientRect(),f=p.getDropPos({x:t.x-e.left,y:t.y-e.top},{x:0,y:0,width:f[0].offsetWidth,height:f[0].offsetHeight}),e=p.getData(),g=a.isDropAllowed(e.source,q,f);b={event:b,sourceTree:e.sourceCtrl?e.sourceCtrl.getCtrlName():"",dragRow:e.source,targetTree:a.getCtrlName(),targetRow:q,isDropAllowed:g,dropPos:f,mousePos:t};m=r[0].getBoundingClientRect();c=t.x-m.left;m=t.y-m.top;A.css("top",m-16+"px");A.css("left",c+"px");
A.css("display","block");b=a.callDragOver(b);if(g&&0!=b){b=t.y+d.y+16;d=t.x+d.x+20;t=a.getDropMarkWindow();t.empty();c="iui-drop-marker-move-in";switch(f){case 1:c="iui-drop-marker-move-up";break;case 2:c="iui-drop-marker-move-down"}t.append("<span class='"+c+"'></span><span class='iui-drop-marker-title'>"+q[a.options.rowFields.text]+"</span>");a.updateDropMarkElem(a.getDropMarkWindow(),{top:b,left:d});a.dropMark(g);p.setData({source:e.source,sourceList:e.sourceList,target:q,dropPos:f})}else a.dropMark(),
A&&A.css("display","none")}}else e=r[0].getBoundingClientRect(),q=e.top+D,e=e.bottom-N,K&&w&&(e-=w[0].offsetHeight),!a.options.allowDrop||t.y<q||t.y>e?(a.dropMark(),A&&A.css("display","none")):(m=r[0].getBoundingClientRect(),c=t.x-m.left,m=t.y-m.top,A.css("top",m-16+"px"),A.css("left",c+"px"),A.css("display","block"),q=p.getData(),e={source:q.source,sourceCtrl:q.sourceCtrl,target:null,dropPos:-1},p.setData(e),b={event:b,sourceTree:q.sourceCtrl?q.sourceCtrl.getCtrlName():"",dragRow:q.source,targetTree:a.getCtrlName(),
targetRow:null,isDropAllowed:a.options.allowDrop,dropPos:-1,mousePos:t},b=a.callDragOver(b),0==b?a.dropMark():(b=t.y+d.y+16,d=t.x+d.x+20,t=a.getDropMarkWindow(),t.empty(),t.append("<span class='iui-drop-marker-move-end'></span><span class='iui-drop-marker-title'>"+(h.name?h.name:"TreeGrid")+"</span>"),a.updateDropMarkElem(a.getDropMarkWindow(),{top:b,left:d}),a.dropMark(!0)))}}else b.preventDefault(),a.dropMark(),a.cancelScrollTimer(),A&&A.css("display","none")}}),c.bind("touchend",function(b){var c=
a.getRowFromChildElem(this);if(c&&a.isRowEnabled(c)){c=!1;if((c=a.getTouchData(b))&&0<c.length){var c=cb({x:c[0].pageX,y:c[0].pageY}),m=r[0].getBoundingClientRect();if(p.hitTest(c.x,c.y,m))if(bb){angular.element(this);b.preventDefault();pa();a.dropMark();jb();if((c=a.getTouchData(b))&&0<c.length){var c=cb({x:c[0].pageX,y:c[0].pageY}),d=a.getRowAt(c.x,c.y);if(d){var m=p.getData(),e=m.source,q=a.isDropAllowed(e,d,m.dropPos);q&&(a.toggle(d,!0),e&&(c={event:b,sourceTree:m.sourceCtrl?m.sourceCtrl.getCtrlName():
"",dragRow:e,targetTree:a.getCtrlName(),targetRow:d,isDropAllowed:q,dropPos:m.dropPos,mousePos:c},c=a.callDragDrop(c),!1!==c&&(a.drop(m),h.$$phase||h.$apply())))}else a.dropMark(),d=r[0].getBoundingClientRect(),m=d.top+D,d=d.bottom-N,K&&w&&(d-=w[0].offsetHeight),c.y>=m&&c.y<=d&&(m=p.getData(),m.source&&(c={event:b,sourceTree:m.sourceCtrl?m.sourceCtrl.getCtrlName():"",dragRow:m.source,targetTree:a.getCtrlName(),targetRow:null,isDropAllowed:a.options.allowDrop,dropPos:-1,mousePos:c},c=a.callDragDrop(c),
!1!==c&&(a.drop(m),h.$$phase||h.$apply())))}p.clearData();a.dragDropStatus(!1);b.stopPropagation()}else a.mouseButtonStatus(!1),(c=a.getRowFromChildElem(this))&&a.isRowEnabled(c)&&a.updateSelection(b,c,b.shiftKey),xb()}c=bb;a.removeDropMark();jb();ab={x:0,y:0};bb=!1;za=null;c&&b.stopPropagation()}}),c.bind("dblclick",function(c){var m=a.getRowFromChildElem(this);if(m&&a.isRowEnabled(m)){var d=angular.element(this);c.preventDefault();if(1===c.which){var e=a.getRowCurrentIndex(m),q=parseInt(a.getIndexFromElem(this),
10),t=a.getCell(e,q),f=a.getCellType(t,q),h=null,g=a.options.editorSettings;t&&(h=a.getColumnById(t[a.options.cellFields.cid]));!h&&0<=q&&q<a.columnList.length&&(h=a.columnList[q]);var l="dblclick"==a.options.editorSettings.activate;h&&h[a.options.columnFields.editorSettings]&&(g=h[a.options.columnFields.editorSettings],l=void 0!=g.activate?"dblclick"==g.activate:l);switch(f){case "checkbox":break;case "combobox":t&&0!=t[a.options.cellFields.allowEdit]&&h&&l?vb(angular.element(this),g,e,q):a.removeDropDownList();
break;case "incell":!b&&t&&0!=t[a.options.cellFields.allowEdit]&&l&&a.openInCellEditor(d,t,h);break;case "dropdown":!b&&t&&0!=t[a.options.cellFields.allowEdit]&&l&&a.openDropDownEditor(d,t,h);break;default:a.removeDropDownList(),t&&0!=t[a.options.cellFields.allowEdit]&&l&&kb(c,angular.element(this),0)}0!=a.callRowDblClick(m,a.getMousePos(c))&&"checkbox"!=f&&"checkbox"!=f&&t&&!l&&(a.toggle(m),a.updateFocus(e,q))}c.stopPropagation()}}),c.bind("mouseenter",function(c){if(!la){var m=a.getRowFromChildElem(this);
if(m&&a.isRowEnabled(m)&&!ka){var q=a.getRowCurrentIndex(m),e=parseInt(a.getIndexFromElem(this),10);if(q=a.getCell(q,e))if(a.hoverCell=q,a.refresh(m),a.callCellHover(c,q),c=angular.element(this),q&&0!=q[a.options.cellFields.allowEdit])switch(e=a.getCellType(q,e),e){case "combobox":Va||Sb(c);break;case "incell":b&&q==d||ub(c,e);break;case "dropdown":b&&q!=d||ub(c,e);break;default:Da(),hb()}else Da()}}}),c.bind("mouseleave",function(b){if(!la&&(a.hoverCell=null,(b=a.getRowFromChildElem(this))&&a.isRowEnabled(b))){b=
a.getRowCurrentIndex(b);var c=parseInt(a.getIndexFromElem(this),10);a.getCell(b,c)&&(Da(),hb())}}),c.bind("keydown",function(c){var m=a.getRowFromChildElem(this);if(m&&a.isRowEnabled(m)){var d=!0,q=angular.element(this);a.callKeyDown(c,m);var e=a.getRowCurrentIndex(m),t=parseInt(a.getIndexFromElem(this),10),f=a.getCell(e,t),g=a.getCellType(f,t),l=a.getColumnById(f[a.options.cellFields.cid]);!l&&0<=t&&t<a.columnList.length&&(l=a.columnList[t]);switch(c.keyCode){case 9:sc(c,m,e,t);break;case 13:switch(g){case "checkbox":Wb(f,
t);break;case "combobox":f&&0!=f[a.options.cellFields.allowEdit]?l&&vb(angular.element(this),l[a.options.columnFields.editorSettings],e,t):a.removeDropDownList();break;case "incell":!b&&f&&0!=f[a.options.cellFields.allowEdit]&&a.openInCellEditor(q,f,l);break;case "dropdown":!b&&f&&0!=f[a.options.cellFields.allowEdit]&&a.openDropDownEditor(q,f,l);break;default:f&&0!=f[a.options.cellFields.allowEdit]&&kb(c,angular.element(this),0)}break;case 16:a.updateSelectionStatus("shift");break;case 17:a.updateSelectionStatus("ctrl");
break;case 27:d=!1;break;case 33:tc(c,e,t);break;case 34:uc(c,e,t);break;case 35:vc(c,e,t);break;case 36:wc(c,e,t);break;case 37:xc(c,m,e,t);break;case 32:c.preventDefault();Wb(f,t);a.rowSelection(m,c.shiftKey,c.ctrlKey,m.selected);h.$apply();break;case 38:Xb(c,e,t);break;case 39:yc(c,m,e,t);break;case 40:Yb(c,e,t);break;default:(c.ctrlKey||c.metaKey)&&a.updateSelectionStatus("ctrl"),c.shiftKey&&a.updateSelectionStatus("shift")}d&&c.stopPropagation()}}),c.bind("keyup",function(b){var c=a.getRowFromChildElem(this);
if(c&&a.isRowEnabled(c)){switch(b.keyCode){case 16:a.multiSelection(!1);break;case 17:a.multiSelection(!1);break;default:b.ctrlKey||b.metaKey||a.multiSelection(!1),b.shiftKey||a.multiSelection(!1)}a.callKeyUp(b,c);b.stopPropagation()}}),c.bind("keypress",function(b){var c=a.getRowFromChildElem(this);c&&a.isRowEnabled(c)&&(a.callKeyPress(b,c),b.stopPropagation())}),c.bind("click",function(b){var c=a.getRowFromChildElem(this);if(c&&a.isRowEnabled(c)){if(1===b.which){var m=a.getRowCurrentIndex(c),d=
parseInt(a.getIndexFromElem(this),10),m=a.getCell(m,d);a.callCellClick(b,c,m,a.getMousePos(b));a.callRowClick(b,c,a.getMousePos(b))}b.stopPropagation()}}),c.bind("mousedown",function(c){a.closeFilterWindow();var m=a.getRowFromChildElem(this);if(m&&a.isRowEnabled(m)){var e=angular.element(this);a.mouseButtonStatus(!0);switch(c.which){case 1:var q=a.getRowCurrentIndex(m),t=parseInt(a.getIndexFromElem(this),10),f=a.getCell(q,t),h=a.getCellType(f,t),g=null,l=a.options.editorSettings;f&&(g=a.getColumnById(f[a.options.cellFields.cid]));
!g&&0<=t&&t<a.columnList.length&&(g=a.columnList[t]);var n="click"==a.options.editorSettings.activate;g&&g[a.options.columnFields.editorSettings]&&(l=g[a.options.columnFields.editorSettings],n=void 0!=l.activate?"click"==l.activate:n);f&&f!=d?a.closeEditor(d):a.closeEditor();switch(h){case "checkbox":break;case "combobox":a.rowSelection(m,c.shiftKey,c.ctrlKey);f&&0!=f[a.options.cellFields.allowEdit]&&g&&n?vb(angular.element(this),l,q,t):a.removeDropDownList();break;case "dropdown":a.rowSelection(m,
c.shiftKey,c.ctrlKey);!b&&f&&0!=f[a.options.cellFields.allowEdit]&&n&&a.openDropDownEditor(e,f,g);break;case "incell":a.rowSelection(m,c.shiftKey,c.ctrlKey);!b&&f&&0!=f[a.options.cellFields.allowEdit]&&n&&a.openInCellEditor(e,f,g);break;default:if("image"==h?0!=l.allowSelection:1)a.rowSelection(m,c.shiftKey,c.ctrlKey),a.removeDropDownList(),f&&0!=f[a.options.cellFields.allowEdit]&&n&&kb(c,angular.element(this))}break;case 3:a.rowSelection(m,c.shiftKey,c.ctrlKey),a.callRowRightClick(m,a.getMousePos(c))}c.stopPropagation()}}),
c.bind("mouseup",function(b){a.mouseButtonStatus(!1);if(1==b.which){var c=a.getRowFromChildElem(this);if(c&&a.isRowEnabled(c)){var m=a.getRowCurrentIndex(c),d=parseInt(a.getIndexFromElem(this),10),m=a.getCell(m,d),e=a.getCellType(m,d),q=null,t=a.options.editorSettings;m&&(q=a.getColumnById(m[a.options.cellFields.cid]));!q&&0<=d&&d<a.columnList.length&&(q=a.columnList[d]);q&&q[a.options.columnFields.editorSettings]&&(t=q[a.options.columnFields.editorSettings]);("image"==e?0!=t.allowSelection:1)&&a.updateSelection(b,
c,b.shiftKey)}xb()}}),c.bind("focus",function(c){var m=a.getRowFromChildElem(this);if(m&&a.isRowEnabled(m)){var d=a.getRowCurrentIndex(m),q=parseInt(a.getIndexFromElem(this),10),d=a.getCell(d,q);a.callGotFocus(c,m,d);if(d&&0!=d[a.options.cellFields.allowEdit])switch(c=angular.element(this),q=a.getCellType(d,q),q){case "combobox":Va||Sb(c);break;case "incell":b||ub(c,q);break;case "dropdown":b||ub(c,q);break;default:Da()}else Da()}}),c.bind("blur",function(b){var c=a.getRowFromChildElem(this);if(c&&
a.isRowEnabled(c)){var m=a.getRowCurrentIndex(c),d=parseInt(a.getIndexFromElem(this),10),m=a.getCell(m,d);a.callLostFocus(b,c,m)}}))},pc=function(a){a&&a.unbind("blur click dragstart dragover drop dragenter dragleave dblclick focus keydown keypress keyup mouseenter mouseleave mousemove mousedown mouseup touchstart touchmove touchend")};a.getTopRow=function(){return a.isRowIndexInRange(G-1)?a.currentList[G]:0<a.currentList.length?a.currentList[0]:null};a.getFooterElem=function(a){switch(a){case "left":return ja;
case "right":return W}return ra};a.getHeaderElem=function(a){switch(a){case "left":return X;case "right":return Q}return ba};a.getRowElems=function(a){switch(a){case "left":return Ea?Ea.find("tr"):null;case "right":return Fa?Fa.find("tr"):null}return ca?ca.find("tr"):null};var sc=function(b,c,d,e){var k=a.currentList.length;0<k&&(b.shiftKey?f.isEqual(c[a.options.rowFields.id],a.currentList[0][a.options.rowFields.id])||Xb(b,d,e):f.isEqual(c[a.options.rowFields.id],a.currentList[k-1][a.options.rowFields.id])||
Yb(b,d,e))},Yb=function(b,c,d){b.preventDefault();focusDelayTime=0;var e=c,k=G+da-2,k=k<a.currentList.length-1?k:a.currentList.length-1;e>=k&&M&&(a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y+Math.floor(r[0].clientHeight/4)}),focusDelayTime=1);if(e=a.getNextRow(e)){c=a.getRowCurrentIndex(e);c>k&&M&&(a.ensureVisible(e,"bottom"),focusDelayTime=100);a.rowSelection(e,b.shiftKey,b.ctrlKey);var f=n(function(){a.updateFocus(c,d);n.cancel(f)},focusDelayTime)}},Xb=function(b,c,d){b.preventDefault();focusDelayTime=
0;var e=G,e=0<e?e:0;c==e&&M&&(a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y-Math.floor(r[0].clientHeight/4)}),focusDelayTime=1);var k=a.getPrevRow(c);if(k){c=a.getRowCurrentIndex(k);c<e&&M&&(a.ensureVisible(k,"bottom"),focusDelayTime=100);a.rowSelection(k,b.shiftKey,b.ctrlKey);var f=n(function(){a.updateFocus(c,d);n.cancel(f)},focusDelayTime)}},yc=function(b,c,d,e){b.preventDefault();if((void 0===e||0<=e&&e==a.options.expandColIndex)&&!a.isRowExpanded(c)&&c[a.options.rowFields.rows]&&0<c[a.options.rowFields.rows].length)a.toggle(c,
!0),a.updateFocus(d,e);else if(0<=e){focusDelayTime=0;var k=e+1;b=a.columnList.length-1;k===b&&(focusDelayTime=1);if(0<=k&&k<=b)var f=n(function(){a.updateFocus(d,k);n.cancel(f)},focusDelayTime)}},xc=function(b,c,d,e){b.preventDefault();if((void 0===e||0<=e&&e==a.options.expandColIndex)&&a.isRowExpanded(c)&&c[a.options.rowFields.rows]&&0<c[a.options.rowFields.rows].length)a.toggle(c,!1),a.updateFocus(d,e);else if(0<=e){focusDelayTime=0;var k=1<e?e-1:0;if(0<=k)var f=n(function(){a.updateFocus(d,k);
n.cancel(f)},focusDelayTime)}},tc=function(b,c,d){b.preventDefault();var e=c-da,e=0<e?e:0;if(e!==c){focusDelayTime=1;var k=a.getPrevRow(e+1);if(k){a.scrollTo(k);a.rowSelection(k,b.shiftKey,b.ctrlKey);h.$apply();var f=n(function(){a.updateFocus(a.getRowCurrentIndex(k),d);n.cancel(f)},focusDelayTime)}}},uc=function(b,c,d){b.preventDefault();var e=c+da;a.options.showHeader&&e--;a.options.showFooter&&e--;e=e<a.currentList.length-1?e:a.currentList.length-1;if(e!==c){focusDelayTime=1;var k=a.getNextRow(e-
1);if(k){a.scrollTo(k,"bottom");a.rowSelection(k,b.shiftKey,b.ctrlKey);h.$apply();var f=n(function(){a.updateFocus(a.getRowCurrentIndex(k),d);n.cancel(f)},focusDelayTime)}}},vc=function(b,c,d){b.preventDefault();a.setScrollPos({x:a.scrollPos.x,y:R.y});var e=a.getLastRow();if(e){a.rowSelection(e,b.shiftKey,b.ctrlKey);var k=n(function(){a.updateFocus(a.getRowCurrentIndex(e),d);n.cancel(k)},1)}},wc=function(b,c,d){b.preventDefault();a.setScrollPos({x:a.scrollPos.x,y:0});var e=a.getFirstRow();if(e){a.rowSelection(e,
b.shiftKey,b.ctrlKey);var k=n(function(){a.updateFocus(a.getRowCurrentIndex(e),d);n.cancel(k)},1)}},Wb=function(b,c){if(b&&0!=b[a.options.cellFields.allowEdit]){var d=a.getColumnById(b[a.options.cellFields.cid]);!d&&0<=c&&c<a.columnList.length&&(d=a.columnList[c]);if(d){var e=b[a.options.cellFields.value];if((d=d[a.options.columnFields.editorSettings])&&1==d.threeState)switch(f.isString(e)||(e="unchecked"),e){case "checked":e="unchecked";break;case "indeterminate":e="checked";break;default:e="indeterminate"}else e=
f.isBoolean(e)?!e:!0;b[a.options.cellFields.value]=e;h.$apply()}}},ca=null,Y=angular.element('<div class="iui-treegrid-block iui-treegrid-block-top"></div>'),ba=null,sa=angular.element('<div class="iui-treegrid-block iui-treegrid-block-left"></div>'),O=0,Oa=0,X=null,ja=null,Ea=null,ma=angular.element('<div class="iui-treegrid-block iui-treegrid-block-right"></div>'),ta=0,Pa=0,Q=null,W=null,Fa=null,ea=angular.element('<div class="iui-treegrid-block iui-treegrid-block-bottom"></div>'),ra=null,G=0,E=
null,x=null,H=100,V=0,da=0,Ga=0,nb=0,D=0,N=0,Qa=0,Bb=!1,la=!1,ob=9,pb=9,Cb=0,Ha=0,Ra=0,qb=1,Db=0,Eb=0,Ia=0,db=0,Fb=1,S=null,T=null,K=!1,M=!1;this.scrollMousePos=null;var R={x:0,y:0},Wa=[];h.verScrollVisibility=!1;h.$watch("verScrollVisibility",function(b,c){b!=c&&a.updateCurrentLayout()});a.getColumnWidth=function(b){var c=100;b&&b[a.options.columnFields.width]&&(c=b[a.options.columnFields.width],f.isPercent(c)?(b=r[0].clientWidth-2*a.columnList.length,M&&J&&(b-=J[0].offsetWidth),c=Math.floor(parseInt(c,
10)/100*b)):f.isString&&(c=parseInt(c,10)));return c};var rb=function(b){var c=0;if((b=a.getRowElems(b))&&0<b.length&&(b=angular.element(b[0]))&&(b=b.find("td"))&&0<b.length)for(var d=0;d<b.length;d++)var e=angular.element(b[d]),c=c+e[0].offsetWidth;return c},Xc=function(){var b=0;if(a.options.showHeader||a.options.showFooter){var c=a.options.showHeader?a.getHeaderElem():a.getFooterElem();if(c&&(c=c.find("td"))&&0<c.length)for(var d=0;d<c.length;d++)var e=angular.element(c[d]),b=b+e[0].offsetWidth;
a.isThereLeftFixedColumns&&(X?O=X[0].offsetWidth:ja&&(O=ja[0].offsetWidth),b+=O);a.isThereRightFixedColumns&&(Q?ta=Q[0].offsetWidth:W&&(ta=W[0].offsetWidth),b+=ta)}else 0<a.currentList.length&&(ca&&(b+=rb()),a.isThereLeftFixedColumns&&(b+=rb("left")),a.isThereRightFixedColumns&&(b+=rb("right")));return b};a.updateViewSize=function(){var b=n(function(){Qa=0;var c=r[0].clientWidth;M&&J&&(c-=J[0].offsetWidth);K=!1;0<a.columnList.length&&(Qa+=Xc(),Qa>c&&(w.unbind("mousedown"),r.append(w),w.bind("mousedown",
function(b){a.removeDropDownList();a.closeFilterWindow();a.closeEditor();b=f.getClientMousePos(b,this);var c=Math.floor(r[0].clientWidth);S&&(b.x<S[0].offsetLeft?a.setScrollPos({x:a.scrollPos.x-c,y:a.scrollPos.y}):b.x>S[0].offsetLeft+S[0].offsetWidth&&a.setScrollPos({x:a.scrollPos.x+c,y:a.scrollPos.y}))}),S=angular.element(w.children().eq(0)),K=!0,S.bind("mousedown",function(b){a.removeDropDownList();a.closeFilterWindow();a.closeEditor();1===b.which&&(F.scrollMousePos=a.getMousePos(b),Bb=!0);b.stopPropagation()})));
M=!1;h.verScrollVisibility=!1;0<a.currentList.length&&(c=0,a.options.paging.enabled&&fa&&(c=fa[0].offsetHeight),c=r[0].clientHeight-c-(D+N),K&&w&&(c-=w[0].offsetHeight),H=0<V?Math.floor(c/V)+1:0<D?Math.floor(c/D):100,H<a.currentList.length+1&&(J.unbind("mousedown"),r.append(J),J.bind("mousedown",function(b){a.removeDropDownList();a.closeFilterWindow();a.closeEditor();b=f.getClientMousePos(b,this);var c=Math.floor(r[0].clientHeight);T&&(b.y<T[0].offsetTop?(a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y-
c}),zb(!1,c)):b.y>T[0].offsetTop+T[0].offsetHeight&&(a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y+c}),zb(!0,c)))}),T=angular.element(J.children().eq(0)),M=!0,h.verScrollVisibility=!0,T.bind("mousedown",function(b){a.removeDropDownList();a.closeFilterWindow();a.closeEditor();1===b.which&&(F.scrollMousePos=a.getMousePos(b),la=!0);b.stopPropagation()})));K||(w.unbind("mousedown"),w.remove(),R.x=0);M||(J.unbind("mousedown"),J.remove(),R.y=0);K&&M?r.append(va):va.remove();n.cancel(b);!K&&0<a.scrollPos.x&&
a.setScrollPos({x:0,y:a.scrollPos.y});!M&&0<a.scrollPos.y&&a.setScrollPos({x:a.scrollPos.x,y:0})},1)};a.updateScrollView=function(){$b()};var $b=function(){var b=n(function(){var c=0;a.options.paging.enabled&&fa&&(c=fa[0].offsetHeight);Ga=r[0].offsetWidth-2;nb=r[0].offsetHeight-2-c;K&&(nb-=w[0].offsetHeight);M&&(Ga-=J[0].offsetWidth);U.css("width",Ga+"px");U.css("height",nb+"px");K&&(w.css("left","0px"),w.css("bottom",c+"px"),w.css("width",Ga-2+"px"));var d=2;a.options.paging.enabled&&fa&&(d=4);M&&
(J.css("top","0px"),J.css("right","0px"),J.css("height",nb-d+"px"));K&&M&&(va.css("left","auto"),va.css("right","0px"));var e=n(function(){K&&Ga<Qa&&(Ha=2,Ra=w[0].clientWidth-4,Cb=0,Ra>Ha&&(Cb=Ra-Ha),ob=Math.floor(Cb*Ga/Qa),9>ob&&(ob=9),S.css("width",ob+"px"),R.x=Qa-Ga,qb=R.x/(Cb-ob-2));var b=a.currentList.length+1;M&&0<a.currentList.length&&H<b&&(Ia=2,db=J[0].clientHeight-4,Db=0,db>Ia&&(Db=db-Ia),pb=Math.floor(Db*H/b),9>pb&&(pb=9),T.css("height",pb+"px"),Fb=(b-H+1)/(Db-pb-2),R.y=Math.floor((b-H+
1)*V),0>R.y&&(R.y=0),0==G?T.css("top",Ia+"px"):G+H-1==a.currentList.length&&T.css("top",db-T[0].offsetHeight+"px"));a.isThereLeftFixedColumns&&(X?O=X[0].offsetWidth:ja?O=ja[0].offsetWidth:0<a.currentList.length&&(O=rb("left")),Oa=r[0].clientHeight-c-D-N,K&&(Oa-=w[0].offsetHeight),sa.css("top",D+"px"),sa.css("width",O+"px"),sa.css("height",Oa+"px"),ba&&ba.css("left",O+"px"),ca&&ca.css("left",O+"px"),ra&&ra.css("left",O+"px"));a.isThereRightFixedColumns&&(Q?ta=Q[0].offsetWidth:W?ta=W[0].offsetWidth:
0<a.currentList.length&&(ta=rb("right")),Pa=r[0].clientHeight-c-D-N,K&&(Pa-=w[0].offsetHeight),b=0,M&&(b=J[0].offsetWidth),Q&&Q.css("right",b+"px"),ma.css("top",D+"px"),ma.css("right",b+"px"),ma.css("width",ta+"px"),ma.css("height",Pa+"px"),W&&W.css("right",b+"px"));b=c;K&&w&&(b+=w[0].offsetHeight);ea.css("bottom",b+"px");n.cancel(e)},1);n.cancel(b)},5)};a.updateColumnWidth=function(){if(a.options.fillSpace){for(var b=0,c=0;c<a.columnList.length;c++)b+=a.getColumnWidth(a.columnList[c])+4;if(b<r[0].clientWidth){for(var b=
(r[0].clientWidth-b)/a.columnList.length,d=0,c=0;c<a.columnList.length;c++)d=a.getColumnWidth(a.columnList[c])+b,a.columnList[c][a.options.columnFields.width]=d;return!0}}return!1};h.onCellValueChanging=function(b,c,d){var e=c+G,k=a.getCell(e,d);if(k&&0==k[a.options.cellFields.allowEdit])return!1;var k=!0,f=a.getColumnObject(d),h="label",g=null;f&&(h=f[a.options.columnFields.editorType],g=f[a.options.columnFields.editorSettings]);f=null;switch(h){case "checkbox":f=g&&1==g.threeState?b.checkState:
b.checked;k=a.callCellValueChanging(a.getRowObject(e),a.getCellObject(e,d),f);break;case "combobox":k=a.callCellValueChanging(a.getRowObject(c),a.getCellObject(c,d),b.item)}return k};h.onCellValueChanged=function(b,c,d){var e=c+G,k=a.getColumnObject(d),f="label",g=null;k&&(f=k[a.options.columnFields.editorType],g=k[a.options.columnFields.editorSettings]);k=null;switch(f){case "checkbox":k=g&&1==g.threeState?b.checkState:b.checked;a.callCellValueChanged(a.getRowObject(e),a.getCellObject(e,d),k);break;
case "combobox":if(e=a.getCell(c,d))e[a.options.cellFields.value]=b.item,h.$apply();a.removeDropDownList(!0);a.updateFocus(c,d);a.callCellValueChanged(a.getRowObject(c),a.getCellObject(c,d),b.item)}};h.onEditorClick=function(b,c,d){c+=G;var e=a.getColumnObject(d),f="label";e&&(f=e[a.options.columnFields.editorType]);switch(f){case "checkbox":a.callCellClick(b,a.getRowObject(c),a.getCellObject(c,d),a.getMousePos(b))}};a.setDefaultCellValue=function(b,c,d){if(void 0==b[a.options.cellFields.value]){var e=
void 0;switch(c){case "checkbox":e=d&&1==d.threeState?"unchecked":!1;break;case "image":e=""}void 0!=e&&(b[a.options.cellFields.value]=e)}};var eb=function(b,c){c=void 0==c?"none":c;for(var d='<table cellpadding="0" cellspacing="0" style="position:absolute;',d=(b?d+'bottom:0;">':d+'top:0;">')+"<tr>",e="none",f=0;f<a.columnList.length;f++)e=a.columnList[f][a.options.columnFields.fixed],e=void 0==e?"none":e,e==c&&(b?(d+='<td iui-class="{{data['+f+'].style.footer.general}}" data-index="'+f+'" data-element="column-footer">',
d+='<div iui-class="{{data['+f+'].style.footer.cell}}" data-element="column-footer-cell"'):(d+='<td iui-class="{{data['+f+'].style.header.general}}" data-index="'+f+'" data-element="column-header">',d+='<div iui-class="{{data['+f+'].style.header.cell}}" data-element="column-header-cell"'),d+=' iui-contextmenu menu-items="data['+f+"].column."+a.options.columnFields.contextMenu+'"',b?(d+=' iui-style="overflow:hidden;width:{{data['+f+"].width}}px;text-align:{{data["+f+"].footerAlignment}};",d=f==a.options.expandColIndex?
d+("padding-left:{{data["+f+'].indent}}px;">'):d+'">',a.columnList[f][a.options.columnFields.footerContent]?d+=a.columnList[f][a.options.columnFields.footerContent]:a.columnList[f][a.options.columnFields.footerTemplate]?d+='<div ng-include="'+a.columnList[f][a.options.columnFields.footerTemplate]+'" style="margin:0;padding:0"></div>':(d+='<span iui-class="{{data['+f+'].style.footer.content}}" data-element="cell-content">',d+="{{data["+f+"].column."+a.options.columnFields.footerText+"}}</span>")):
(d+=' iui-style="overflow:hidden;width:{{data['+f+"].width}}px;text-align:{{data["+f+"].headerAlignment}};",d=f==a.options.expandColIndex?d+("padding-left:{{data["+f+'].indent}}px;">'):d+'">',d+='<span iui-class="{{data['+f+'].style.header.content}}" data-element="cell-content">',d+="{{data["+f+"].column."+a.options.columnFields.headerText+"}}</span>",d+='<span iui-class="{{data['+f+'].style.filtering}}" data-index="'+f+'" data-element="filter-button" ng-show="data['+f+'].showFiltering"></span>',
d+='<span iui-class="{{data['+f+'].style.sorting}}" data-index="'+f+'" data-element="sort-button" ng-show="data['+f+'].showSorting"></span>'),d+="</div>",d+="</td>");return d+="</tr></table>"},Gb=function(b,c,d){c=void 0==c?"none":c;var e="none",k='<tr iui-class="{{data['+b+'].style}}" data-index="{{data['+b+'].index}}" tabindex="{{data['+b+'].tabindex}}"';d&&(k+=' style="position:absolute;top:-9999px"');k+=">";for(d=0;d<a.columnList.length;d++)if(e=a.columnList[d][a.options.columnFields.fixed],e=
void 0==e?"none":e,e==c){var k=k+('<td iui-class="{{data['+b+"].cells["+d+'].style.cell}}" data-element="cell" data-index="'+d+'" draggable="{{data['+b+'].draggable}}" tabindex="{{data['+b+"].cells["+d+'].tabindex}}">'),k=k+('<div ng-show="data['+b+'].visible"'),k=k+(' iui-class="{{data['+b+"].cells["+d+'].style.content}}" data-element="cell-content"'),k=k+(' iui-contextmenu menu-items="data['+b+"].row."+a.options.rowFields.contextMenu+'" menu-update="{{data['+b+'].updateContextMenu}}"'),k=k+(' iui-style="width:{{data['+
b+"].cells["+d+"].width}}px;text-align:{{data["+b+"].cells["+d+"].alignment}};"),e=k=d==a.options.expandColIndex?k+("padding-left:{{data["+b+"].cells["+d+'].indent}}px;">'):k+'">',k=b,h=d,g="";h===a.options.expandColIndex&&(g+='<span iui-class="{{data['+k+'].expandBox}}" data-element="expandbox"></span>',g+='<span iui-class="{{data['+k+'].icon}}" data-element="icon" ng-show="data['+k+'].iconVisible"></span>');var l=a.columnList[h][a.options.columnFields.editorSettings],n=ac(h);switch(a.columnList[h][a.options.columnFields.editorType]){case "checkbox":g+=
'<iui-checkbox name="cb-'+f.getUniqueId(4)+'"';l&&1==l.threeState?(g+=' check-state="data['+k+"].cells["+h+"].related."+a.options.cellFields.value+'"',g+=' checkstate-changing="onCellValueChanging(e, '+k+", "+h+')"',g+=' checkstate-changed="onCellValueChanged(e, '+k+", "+h+')"',g+=' three-state="true"'):(g+=' checked="data['+k+"].cells["+h+"].related."+a.options.cellFields.value+'"',g+=' checked-changing="onCellValueChanging(e, '+k+", "+h+')"',g+=' checked-changed="onCellValueChanged(e, '+k+", "+
h+')"');g+=' click="onEditorClick(e, '+k+", "+h+')"';l&&l.style&&(g+=' control-style="data['+k+"].cells["+h+'].editorStyle"');g+=' enabled="data['+k+"].cells["+h+"].related."+a.options.cellFields.enabled+'"';g+=' style="vertical-align:middle;" iui-show="{{data['+k+"].cells["+h+'].visible}}"></iui-checkbox>';break;case "combobox":g+='<span iui-class="{{data['+k+"].cells["+h+'].style.label}}" data-element="content">';g+="{{data["+k+"].cells["+h+"].related."+a.options.cellFields.value+".text}}";g+="</span>";
break;case "image":g+='<img data-element="image" style="vertical-align:middle" ng-src="{{data['+k+"].cells["+h+"].related."+a.options.cellFields.value+'}}"  iui-show="{{data['+k+"].cells["+h+'].visible}}" show-default="true" />';break;default:n&&""!=n?g+='<iui-item-content obj="data['+k+"].cells["+h+"].related."+a.options.cellFields.templateObj+'" template-url="{{data['+k+"].cells["+h+'].templateUrl}}" iui-show="{{data['+k+"].cells["+h+'].templateVisible}}" data-element="template-content"></iui-item-content>':
(g+='<span iui-class="{{data['+k+"].cells["+h+'].style.label}}" data-element="content">',g+="{{data["+k+"].cells["+h+"].related."+a.options.cellFields.text+"}}",g+="</span>")}k=e+g;k+="</div>";k+="</td>"}return k+"</tr>"},Yc=function(){V=0;if(0<a.currentList.length&&x){var b="none";a.isThereLeftFixedColumns&&(b="left");a.isThereRightFixedColumns&&(b="right");for(var d=[],e=[],f=0,k=0;k<a.currentList.length&&10>k;k++)d.push(Gb(k,b,!0)),e.push(c(d[k])(x)),r.append(e[k]),f++;if(0<f)var g=n(function(){for(var a=
0,b=0;b<f;b++)a+=e[b][0].offsetHeight,e[b].remove();V=Math.floor(a/f);n.cancel(g)},1)}},B=null,bc=0,cc=0,fa=angular.element('<div class="iui-pagination-panel"></div>'),Zc=function(){B&&B.$destroy();fa.empty();fa.remove();cc=bc=0;if(a.options.paging.showControlPanel){B=h.$new();B.currentPage=0;B.minPages=0;B.numPages=a.pageList.length;0<B.numPages&&0==B.currentPage&&(B.currentPage=1);B.onFirstPage=function(){a.firstPage();B.currentPage=a.currentPageNumber};B.onLastPage=function(){a.lastPage();B.currentPage=
a.currentPageNumber};B.onNextPage=function(){a.nextPage();B.currentPage=a.currentPageNumber};B.onPrevPage=function(){a.prevPage();B.currentPage=a.currentPageNumber};B.$watch("currentPage",function(b,c){b!=c&&1<=b&&b<=a.pageList.length&&a.setCurrentPage(b)});bc=r[0].clientWidth;for(var b="",d=0;6>d;d++)switch(d){case 0:b+='<span class="iui-pagination-panel-button iui-pagination-first" ng-click="onFirstPage()"></span>';break;case 1:b+='<span class="iui-pagination-panel-button iui-pagination-prev" ng-click="onPrevPage()"></span>';
break;case 2:b+='<input class="iui-pagination-panel-input" ng-model="currentPage" type="number" ng-attr-min="{{minPages}}" ng-attr-max="{{numPages}}" />';break;case 3:b+='<span class="iui-pagination-panel-label"> / {{numPages}}</span>';break;case 4:b+='<span class="iui-pagination-panel-button iui-pagination-next" ng-click="onNextPage()"></span>';break;case 5:b+='<span class="iui-pagination-panel-button iui-pagination-last" ng-click="onLastPage()"></span>'}b=c(b)(B);fa.append(b);r.append(fa);fa.css("width",
bc+"px");b&&(f.getMargin(b[0]),d=f.getPadding(fa[0]),cc=b[0].offsetHeight+(d.top+d.bottom)-2,fa.css("height",cc+"px"))}};a.resetPageNumber=function(){a.currentPageNumber=1;B&&(B.currentPage=0<B.numPages?1:0)};a.updatePageNumber=function(){a.currentPageNumber>a.pageList.length&&(0==a.pageList.length?a.resetPageNumber():(a.currentPageNumber=a.pageList.length,B&&(B.currentPage=a.currentPageNumber)))};var $c=function(){if(1<a.updateStatus)I("end");else var b=n(function(){if(0<a.columnList.length&&1==
a.updateStatus){E=h.$new();E.data=Ac();a.refreshColumns();E.$apply();for(var d="",d=N=D=0;d<a.columnList.length;d++){var e={columnID:void 0!=a.columnList[d][a.options.columnFields.id]?a.columnList[d][a.options.columnFields.id]:d,avgItemHeight:0};switch(a.columnList[d][a.options.columnFields.editorType]){case "combobox":Qc(a.columnList[d].editorSettings,d,e);Wa.push(e);break;default:Wa.push(e)}}a.options.showHeader&&(r.append(Y),ga&&Y.css("opacity",ha.opacity),d=eb(),ba=angular.element(c(d)(E)),Y.append(ba),
a.isThereLeftFixedColumns&&(d=eb(!1,"left"),X=c(d)(E),Y.append(X),X.css("z-index","2"),X.addClass("iui-treegrid-column-header-left")),a.isThereRightFixedColumns&&(d=eb(!1,"right"),Q=c(d)(E),Y.append(Q),Q.css("right","0"),Q.css("z-index","1"),Q.addClass("iui-treegrid-column-header-right")));a.options.showFooter&&(r.append(ea),ga&&ea.css("opacity",ha.opacity),d=eb(!0),ra=c(d)(E),ea.append(ra),a.isThereLeftFixedColumns&&(d=eb(!0,"left"),ja=c(d)(E),ea.append(ja),ja.css("z-index","2"),ja.addClass("iui-treegrid-column-footer-left")),
a.isThereRightFixedColumns&&(d=eb(!0,"right"),W=c(d)(E),ea.append(W),W.css("right","0"),W.css("z-index","1"),W.addClass("iui-treegrid-column-footer-right")));for(var f=null,d=null,k=e=-1,g=0;g<a.columnList.length;g++)if(d=f=null,a.columnList[g][a.options.columnFields.headerContent]?(f=a.columnList[g][a.options.columnFields.headerContent],e=1):a.columnList[g][a.options.columnFields.headerTemplate]&&(f=a.columnList[g][a.options.columnFields.headerTemplate],e=2),a.columnList[g][a.options.columnFields.footerContent]?
(d=a.columnList[g][a.options.columnFields.footerContent],k=1):a.columnList[g][a.options.columnFields.footerTemplate]&&(d=a.columnList[g][a.options.columnFields.footerTemplate],k=2),f||d){var l=a.getElemFromColumn(a.columnList[g],a.columnList[g][a.options.columnFields.fixed]);if(l){if(f){var p=a.getChildElement(l,"column-header-cell");if(p)switch(p.empty(),e){case 1:p.append(c(f)(h.$parent));break;case 2:f='<div ng-include="'+f+'"',a.columnList[g][a.options.columnFields.headerTemplateModel]&&(f+=' onload="'+
a.columnList[g][a.options.columnFields.headerTemplateModel]+'"'),f+=' style="margin:0;padding:0"></div>',p.append(c(f)(h.$parent))}}if(d&&(p=a.getChildElement(l,"column-footer-cell")))switch(p.empty(),k){case 1:p.append(c(d)(h.$parent));break;case 2:f='<div ng-include="'+d+'"',a.columnList[g][a.options.columnFields.footerTemplateModel]&&(f+=' onload="'+a.columnList[g][a.options.columnFields.footerTemplateModel]+'"'),f+=' style="margin:0;padding:0"></div>',p.append(c(f)(h.$parent))}}}na(40);I("rows")}else na(70),
I("scroll");n.cancel(b)},1)},ad=function(){if(1<a.updateStatus)I("end");else var b=n(function(){var d=0;a.options.paging.enabled&&fa&&(d=fa[0].offsetHeight);if(0<a.columnList.length){var e=0;if(a.options.showHeader&&ba){D=ba[0].offsetHeight;a.isThereLeftFixedColumns&&X?D=X[0].offsetHeight:a.isThereRightFixedColumns&&Q&&(D=Q[0].offsetHeight);var f=0,k=ba.find("td");if(k&&0<k.length)for(var g=0;g<k.length;g++)var l=angular.element(k[g]),f=f+l[0].offsetWidth;f>r[0].clientWidth&&(f=angular.element('<div class="iui-scrollbar-horizontal"><div class="iui-scroll-button-thumb-horizontal"></div></div>'),
f.css("bottom","-9999px"),r.append(f),e=f[0].offsetHeight,f.remove());Y.css("width",r[0].clientWidth+"px");Y.css("height",D+"px");a.isThereLeftFixedColumns&&(O=X[0].offsetWidth,Oa=r[0].clientHeight-D-N,ba.css("left",O+"px"));a.isThereRightFixedColumns&&(ta=Q[0].offsetWidth,Pa=r[0].clientHeight-D-N)}a.options.showFooter&&(N=ra[0].offsetHeight,a.isThereLeftFixedColumns&&ja?N=ja[0].offsetHeight:a.isThereRightFixedColumns&&W&&(N=W[0].offsetHeight),ea.css("width",r[0].clientWidth+"px"),ea.css("height",
N+"px"),a.isThereLeftFixedColumns&&(O=ja[0].offsetWidth,Oa=r[0].clientHeight-D-N,ra.css("left",O+"px")),a.isThereRightFixedColumns&&(ta=W[0].offsetWidth,Pa=r[0].clientHeight-D-N));Bc();if(0<a.currentList.length){x=h.$new();x.data=Cc();a.refreshRows();x.$apply();Yc();var p=n(function(){qc();ca&&ca.remove();Ea&&Ea.remove();Fa&&Fa.remove();var b=r[0].clientHeight-d-(D+N)-e;H=0<V?Math.floor(b/V)+1:0<D?Math.floor(b/D)+1:100;da=0;for(var b="",m=0;m<H;m++)b+=Gb(m),da++;if(0<da){ca=angular.element('<table cellpadding="0" cellspacing="0" style="position:absolute;top:'+
D+'px;"></table>');ca.append(c(b)(x));U.append(ca);if(a.isThereLeftFixedColumns){ca.css("left",O+"px");b="";for(m=da=0;m<H;m++)b+=Gb(m,"left"),da++;0<da&&(Ea=angular.element('<table class="iui-treegrid-rows-left" cellpadding="0" cellspacing="0" style="position:absolute;"></table>'),Ea.append(c(b)(x)),sa.append(Ea),r.append(sa),ga&&sa.css("opacity",ha.opacity))}if(a.isThereRightFixedColumns){b="";for(m=da=0;m<H;m++)b+=Gb(m,"right"),da++;0<da&&(Fa=angular.element('<table class="iui-treegrid-rows-right" cellpadding="0" cellspacing="0" style="position:absolute;"></table>'),
Fa.append(c(b)(x)),ma.append(Fa),r.append(ma),ga&&ma.css("opacity",ha.opacity))}}na(70);I("scroll");n.cancel(p)},1)}else na(70),I("scroll")}else na(70),I("scroll");n.cancel(b)},1)},I=function(b){if(fb&&!Sa)switch(b){case "start":1<a.updateStatus?I("end"):(a.updateColumnList(),a.options.paging.enabled&&a.updatePageList(),a.updateCurrentList(),na(10),I("init"));break;case "init":1<a.updateStatus?I("end"):(Wa.length=0,mc(),Bb||la||$b(),U.empty(),ca=null,Y.empty(),Y.remove(),ba=null,ea.empty(),ea.remove(),
ra=null,sa.empty(),sa.remove(),Oa=O=0,Ea=X=null,ma.empty(),ma.remove(),Pa=ta=0,Fa=Q=null,E&&E.$destroy(),x&&x.$destroy(),a.options.paging.enabled&&Zc(),na(20),I("columns"));break;case "columns":$c();break;case "rows":Y?a.options.showHeader&&Y.find("td").length<a.columnList.length?n(function(){I(b)},1):ad():n(function(){I(b)},1);break;case "scroll":1<a.updateStatus?I("end"):(a.updateViewSize(),a.updateViewSize(),a.updateScrollView(),na(80,"complete"),I("complete"));break;case "complete":1<a.updateStatus?
I("end"):(na(90),I("events"));break;case "events":1<a.updateStatus||(a.allowEvents=!0,a.options.showHeader&&(ba&&Vb(ba),a.isThereLeftFixedColumns&&X&&Vb(X),a.isThereRightFixedColumns&&Q&&Vb(Q)),0<a.currentList.length&&Vc(),na(100));I("end");break;case "end":switch(ha.type){case "circular":Dc();gb=0;Ja=!0;1==a.updateStatus&&a.callLoadComplete();break;case "linear":Ec(!1);break;default:gb=0,Ja=!0,1==a.updateStatus&&a.callLoadComplete()}a.updateActive=!1;a.updateStatus--;0<a.updateStatus?(fb=a.updateActive=
!0,1==a.updateStatus?I("start"):I("end")):a.callUpdateComplete()}else n(function(){I(b)},1)},Fc=5,Hb=0,Ta=0,Ib=0,Gc=0,Sa=!1,Jb=!1,ha={type:"none",speed:"normal",opacity:0},dc=null,ga=!1,Ja=!1,Ec=function(b){var c=e(function(){b?Ta++:Ta--;Ib=(r[0].clientHeight-Ta)/2+2;sb.css("height",Ta+"px");Aa.css("top",Ib+"px");b&&Ta>=Fc?(ga=!0,na(0),Ja=Sa=!1,e.cancel(c)):!b&&0>=Ta&&(Aa&&Aa.remove(),gb=0,Ja=!0,a.callLoadComplete(),e.cancel(c))},20)},Dc=function(){dc&&e.cancel(dc);ua&&ua.remove()};a.beginLoad=function(a){if(!Sa)switch(Sa=
!0,ha=a?{type:void 0!=a.type?a.type:"none",speed:void 0!=a.speed?a.speed:"normal",opacity:void 0!=a.opacity?a.opacity:0}:{type:"none",speed:"normal",opacity:0},ec(ha.opacity),ha.type){case "circular":Dc();r.append(ua);ua.css("top",(r[0].clientHeight-ua[0].offsetHeight)/2+"px");ua.css("left",(r[0].clientWidth-ua[0].offsetWidth)/2+"px");ga=!0;Ja=Sa=!1;var b=0,c=3;switch(ha.speed){case "veryfast":c=7;break;case "fast":c=5;break;case "slow":c=2;break;case "veryslow":c=1}dc=e(function(){b+=c;360<b&&(b=
0);var a="rotate("+b+"deg)";ua.css("-ms-transform",a);ua.css("-webkit-transform",a);ua.css("transform",a)},1);break;case "linear":a=angular.element('<div class="iui-load-block-progress" style="position:absolute;left:-9999px"></div>');r.append(a);Fc=parseInt(getComputedStyle(a[0]).height,10);a.remove();sb.css("width","0px");sb.css("height","0px");r.append(Aa);gb=0;Hb=Math.floor(.5*r[0].clientWidth);Ta=0;Ib=r[0].clientHeight/2+2;Gc=(r[0].clientWidth-Hb)/2;Aa.css("width",Hb+"px");Aa.css("top",Ib+"px");
Aa.css("left",Gc+"px");Aa.css("opacity","1");Ec(!0);break;default:ga=!0,Ja=Sa=!1}};a.endLoad=function(b){if(!Jb)if(Jb=!0,b=a.options.loadRows.indexOf(b),0<=b&&a.options.loadRows.splice(b,1),ga){ga=!1;var c=3,d=ha.opacity,f=e(function(){Ja&&(10<c||1<=d?(ec(1),Jb=Sa=Ja=!1,ha={type:"none",speed:"normal"},e.cancel(f)):(d+=c/10,ec(d),c+=3))},1)}else Jb=!1};var ec=function(a){Y&&Y.css("opacity",a);sa&&sa.css("opacity",a);U&&U.css("opacity",a);ma&&ma.css("opacity",a);ea&&ea.css("opacity",a);w&&w.css("opacity",
a);J&&J.css("opacity",a);va&&va.css("opacity",a)},sb=angular.element('<div class="iui-load-block-progress"></div>'),Aa=angular.element('<div class="iui-load-block"></div>');Aa.append(sb);var gb=0,fb=!1,ua=angular.element('<div class="iui-load-circular"></div>'),na=function(a){if(ga&&"linear"==ha.type){fb=!1;var b=Math.floor(Hb*a/100),c=gb;a=10;switch(ha.speed){case "veryfast":a=2;break;case "fast":a=5;break;case "slow":a=15;break;case "veryslow":a=20}var d=b>c?Math.floor((b-c)/a):1,d=0<d?d:1,f=e(function(){c+=
d;sb.css("width",c+"px");c>=b&&(gb=b,fb=!0,e.cancel(f))},1)}else fb=!0};a.updateStatus=0;a.updateActive=!1;a.updateLayout=function(b){b=!0;for(var c=r.parent();"body"!=c[0].tagName.toLowerCase();){if("none"==getComputedStyle(c[0]).display){b=!1;break}c=c.parent()}b&&a.allowUpdate&&(a.updateStatus++,a.updateActive||(a.updateActive=!0,a.allowEvents=!1,r.removeClass("iui-treegrid-block-rtl"),a.options.rtl&&r.addClass("iui-treegrid-block-rtl"),U.removeClass("iui-treegrid-block-shift-left iui-treegrid-block-rtl"),
U.addClass(Ua()),V=0,H=100,N=D=0,fb=!0,I("start")))};a.updateCurrentLayout=function(){if(a.allowUpdate)if(0==a.currentList.length)a.updateLayout();else{a.options.paging.enabled&&(a.updatePageList(),B&&(B.minPages=0<a.pageList.length?1:0,B.numPages=a.pageList.length),a.updatePageNumber());a.updateCurrentList();a.updateView();var b=n(function(){a.updateViewSize();a.updateViewSize();a.updateScrollView();n.cancel(b)},1)}};var Hc=function(b,c){var d="left";return d=c?b[a.options.columnFields.footerAlignment]:
b[a.options.columnFields.headerAlignment]},bd=function(b,c){var d=Hc(b),e=Hc(b,!0),f=a.isFilteringAllowed(b),g=a.isSortingAllowed()&&b==a.sortColumn,h=a.getColumnWidth(b),h=0<=h?h:0,l=fc(b);h<l.min&&(h=l.min);h>l.max&&(h=l.max);return{headerAlignment:d,footerAlignment:e,index:c,indent:0,column:b,showFiltering:f,showSorting:g,style:{header:{},footer:{}},width:h}},Ic=function(b,c){if(0<=c){var d=a.currentList[b][a.options.rowFields.cells];if(c<d.length)return d[c]}return{}},ac=function(b){return a.columnList[b][a.options.columnFields.cellTemplateUrl]?
a.columnList[b][a.options.columnFields.cellTemplateUrl]:""},cd=function(b,c,d){for(var e=[],k=0;k<a.columnList.length;k++){var g,h=k;if(d){var l=a.columnList[k][a.options.columnFields.id];l&&(h=a.getCellIndexById(a.currentList[c][a.options.rowFields.cells],k,l))}g=h;var h=d?Ic(c,g):{},l=a.columnList[k][a.options.columnFields.contentAlignment]?a.columnList[k][a.options.columnFields.contentAlignment]:"left",n;n=(n=a.columnList[k][a.options.columnFields.editorSettings])&&n.style?n.style:null;var p;if(d){if(p=
0,k==a.options.expandColIndex){p=c;var r=0,v=a.columnList[a.options.expandColIndex],z=a.getColumnWidth(v),x=z-a.indentList[p],x=0<=x?x:0,r={top:0,right:0,bottom:0,left:0};(v=a.getElemFromColumn(v,v[a.options.columnFields.fixed]))&&(v=a.getChildElement(v,"column-header-cell"))&&(r=f.getPadding(v[0]));r=r.left+a.indentList[p];0==x&&(r=z);p=r}}else p=0;z=g;d?(x=c,r=k,x=1==a.options.allowFocus&&1==a.options.allowCellFocus&&a.isRowEnabled(a.currentList[x])&&0<=r?a.getTabIndex().toString()+(x+1).toString()+
r.toString():""):x="";r=ac(k);if(d)var w=c,v=g,y=ac(k),w=Ic(w,v),v=0<=v&&y&&""!=y&&w&&void 0!=w[a.options.cellFields.templateObj]&&null!=w[a.options.cellFields.templateObj]?!0:!1;else v=!1;if(d)a:{if(0<=g&&(y=a.currentList[c][a.options.rowFields.cells],g<y.length)){y=y[g][a.options.cellFields.text];break a}y=""}else y="";if(d)a:{if(0<=g&&(w=a.currentList[c][a.options.rowFields.cells],g<w.length)){w=w[g][a.options.cellFields.value];break a}w=null}else w=null;g=d?0<=g?!0:!1:!1;var C;if(d){C=c;var D=
k,B=a.columnList[D],A=a.getColumnWidth(B),B=fc(B);A<B.min&&(A=B.min);A>B.max&&(A=B.max);D==a.options.expandColIndex&&(A-=a.indentList[C]);C=A=0<=A?A:0}else C=0;e.push({related:h,alignment:l,editorStyle:n,indent:p,index:z,style:{},tabindex:x,templateUrl:r,templateVisible:v,text:y,value:w,visible:g,width:C})}if(d){if(k="",a.options.showExpandBoxes){h=a.defaultStyle.row.expandBox.general;b[a.options.rowFields.style]&&b[a.options.rowFields.style].expandBox&&b[a.options.rowFields.style].expandBox.general!=
h?h+=" "+b[a.options.rowFields.style].expandBox.general:a.options.controlStyle.row.expandBox.general!=h&&(h+=" "+a.options.controlStyle.row.expandBox.general);l=a.getCurrentRowStyle(b);l=a.getExpandBoxStyle(l.expandBox);if(a.isThereChildRows||b&&b[a.options.rowFields.hasChildren])k=h;b&&(b[a.options.rowFields.hasChildren]||b[a.options.rowFields.rows]&&0<b[a.options.rowFields.rows].length&&a.isThereVisibleChildren(b))&&(0<=a.options.loadRows.indexOf(b)?k+=" "+l.animated:(k=b[a.options.rowFields.hasChildren]&&
void 0===b[a.options.rowFields.expanded]?k+(" "+l.expanded):!1!==b[a.options.rowFields.expanded]?k+(" "+l.collapsed):k+(" "+l.expanded),!0===a.options.rtl&&(k+="-rtl"),a.isRowEnabled(b)||(k+="-disabled")))}}else k="";h=d?a.isRowEnabled(b)&&a.isDragAllowed(b):!1;d?(l="",b.icon?l=b.icon:a.options.rowIcon&&(l=a.options.rowIcon)):l="";n=d?0!=a.options.showIcons&&(b.icon||a.options.rowIcon):!1;g=d?1==a.options.allowFocus&&0==a.options.allowCellFocus&&a.isRowEnabled(a.currentList[c])?a.getTabIndex().toString()+
(c+1).toString():"":"";return{cells:e,expandBox:k,draggable:h,icon:l,iconVisible:n,index:c,row:d?b:{},style:{},tabindex:g,updateContextMenu:d?null!=b[a.options.rowFields.contextMenu]:!1,visible:d}},Ac=function(){for(var b=[],c=0;c<a.columnList.length;c++)b.push(bd(a.columnList[c],c));return b},Cc=function(){for(var b=[],c=G;c<G+H;c++)b.push(cd(a.currentList[c],c,c<a.currentList.length));return b},Bc=function(){for(var b=0;b<a.columnList.length;b++)if(a.isFilteringAllowed(a.columnList[b])){var c=a.getElemFromColumn(a.columnList[b],
a.columnList[b][a.options.columnFields.fixed]);c&&(c=a.getChildElement(c,"column-header-cell"))&&(c=a.getContentElement(c,"filter-button"))&&(c.css("top",(D-parseInt(getComputedStyle(c[0]).height,10))/2-1+"px"),c.css("right","2px"))}a.isSortingAllowed()&&a.sortColumn&&(b=a.getElemFromColumn(a.sortColumn,a.sortColumn[a.options.columnFields.fixed]))&&(c=a.getChildElement(b,"column-header-cell"))&&(c=a.getContentElement(c,"sort-button"))&&(c.css("top",(D-parseInt(getComputedStyle(c[0]).height,10))/2-
1+"px"),a.isFilteringAllowed(a.sortColumn)?c.css("right","22px"):c.css("right","2px"))};a.getRowScope=function(){return x};var Kc=function(){E&&x&&(a.allowEvents=!1,Jc(!1),0<a.columnList.length&&(E.data=Ac(),x.data=Cc(),a.options.selectedRow&&!a.isRowEnabled(a.options.selectedRow)&&(a.options.selectedRow[a.options.rowFields.selected]=!1,a.options.selectedRow=null,a.updateSelectionList()),a.refresh(null,null,!1),E.$apply(),x.$apply(),Bc(),a.allowEvents=!0))};a.updateView=function(a){if(a)Kc();else var b=
n(function(){Kc();n.cancel(b)},1)};var Lc=function(b,c,d){var e={cell:"",content:"",general:"",label:""},f="";switch(c){case "column":d?(f=a.defaultStyle.column.footer.normal,a.options.controlStyle.column.footer.normal!=f&&(f+=" "+a.options.controlStyle.column.footer.normal),e.general=f,e.cell="iui-treegrid-column-footer-cell",f=a.defaultStyle.column.footer.content,a.options.controlStyle.column.footer.content!=f&&(f+=" "+a.options.controlStyle.column.footer.content)):(f=a.defaultStyle.column.header.normal,
a.options.controlStyle.column.header.normal!=f&&(f+=" "+a.options.controlStyle.column.header.normal),e.general=f,e.cell="iui-treegrid-column-header-cell",f=a.defaultStyle.column.header.content,a.options.controlStyle.column.header.content!=f&&(f+=" "+a.options.controlStyle.column.header.content));e.content=f;break;case "row":f=a.defaultStyle.row.general.normal;a.options.controlStyle.row.general.normal!=f&&(f+=" "+a.options.controlStyle.row.general.normal);e.general=f;break;case "cell":f=a.defaultStyle.row.cell.normal;
a.options.controlStyle.row.cell.normal!=f&&(f+=" "+a.options.controlStyle.row.cell.normal);switch(a.options.gridLines){case "none":f=b==G+H-1||b==a.currentList.length-1?f+" iui-treegrid-lines-horizontal":f+" iui-treegrid-lines-none";break;case "horizontal":f+=" iui-treegrid-lines-horizontal";break;case "vertical":f=b==G+H-1||b==a.currentList.length-1?f+" iui-treegrid-lines-both":f+" iui-treegrid-lines-vertical";break;default:f+=" iui-treegrid-lines-both"}e.general=f;f=a.defaultStyle.row.cell.content;
a.options.controlStyle.row.cell.content!=f&&(f+=" "+a.options.controlStyle.row.cell.content);e.content=f;e.label=a.getDefaultCellLabelClass()}return e},Kb=function(b,c,d,e){var f=a.getObjState(b);d=Lc(d,b.type,e);switch(b.type){case "column":e?(c=a.getCurrentColumnStyle(b,"footer",f),c!=a.options.controlStyle.column.footer.normal&&(d.general+=" "+c),b=a.getCurrentColumnStyle(b,"footer","content"),b!=a.options.controlStyle.column.footer.content&&(d.content+=" "+b)):(c=a.getCurrentColumnStyle(b,"header",
f),c!=a.options.controlStyle.column.header.normal&&(d.general+=" "+c),b=a.getCurrentColumnStyle(b,"header","content"),b!=a.options.controlStyle.column.header.content&&(d.content+=" "+b));break;case "row":b=a.getCurrentRowStyle(b,f);b!=a.options.controlStyle.row.general.normal&&(d.general+=" "+b);break;case "cell":e=a.getCurrentCellStyle(c,b,f),e!=a.options.controlStyle.row.cell.normal&&(d.general+=" "+e),b=a.getCurrentCellStyle(c,b,"content"),b!=a.options.controlStyle.row.cell.content&&(d.content+=
" "+b)}return d},gc=function(a,b,c){x.data[a].cells[b].style.cell=c.general;x.data[a].cells[b].style.content=c.content;x.data[a].cells[b].style.label=c.label},Mc=function(b){if(x&&(b-=G,0<=b&&b<x.data.length&&x.data[b].visible)){x.data[b].style=a.defaultStyle.row.general.normal;for(var c=0;c<a.columnList.length;c++)x.data[b].cells[c].style.cell=a.defaultStyle.row.cell.normal+" iui-treegrid-cell-empty"}};a.refreshColumns=function(){for(var b=0;b<a.columnList.length;b++)a.refresh(a.columnList[b],null,
!1)};a.refreshRows=function(){for(var b=G;b<G+H;b++)b<a.currentList.length?a.refresh(a.currentList[b],null,!1):Mc(b)};a.refresh=function(b,c,d){if(b)switch(b.type){case "column":if(E&&(c=a.getColumnCurrentIndex(b),0<=c&&c<E.data.length)){1==a.options.showHeader&&(E.data[c].style.header=Kb(b));1==a.options.showFooter&&(E.data[c].style.footer=Kb(b,null,-1,!0));var e=E.data[c].style,f="";if(a.isFilteringAllowed(b)){var g=a.getObjState(b),f="iui-filtering";"selected"==g?f+=" iui-filtering-selected":"hovered"==
g&&(f+=" iui-filtering-hovered")}e.filtering=f;c=E.data[c].style;e="";a.isSortingAllowed()&&b==a.sortColumn&&(b=a.getObjState(b),"ascending"==a.options.sorting?(e="iui-sort-ascending","selected"==b?e+=" iui-sort-ascending-selected":"hovered"==b&&(e+=" iui-sort-ascending-hovered")):(e="iui-sort-descending","selected"==b?e+=" iui-sort-descending-selected":"hovered"==b&&(e+=" iui-sort-descending-hovered")));c.sorting=e;void 0==d&&E&&E.$apply()}break;case "row":if(x&&(c=a.getRowCurrentIndex(b),e=c-G,
0<=e&&e<x.data.length&&x.data[e].visible)){x.data[e].style=Kb(b).general;f=Lc(c,"cell");for(g=0;g<a.columnList.length&&g<x.data[e].cells.length;g++){var h=x.data[e].cells[g].index;if(0<=h){var l=b[a.options.rowFields.cells];h<l.length?(h=Kb(l[h],b,c),gc(e,g,h)):gc(e,g,f)}else gc(e,g,f)}void 0==d&&x&&x.$apply()}}else{for(g=0;g<a.columnList.length;g++)a.refresh(a.columnList[g],null,!1);for(b=G;b<G+H;b++)b<a.currentList.length?a.refresh(a.currentList[b],null,!1):Mc(b);1==d&&x&&x.$apply()}};a.moveColumn=
function(b,c){if(b&&0!=a.callColumnPosChanging(b)){var d=a.columnList[0];0<=a.options.expandColIndex&&a.options.expandColIndex<a.columnList.length&&(d=a.columnList[a.options.expandColIndex]);var e=a.getColumnCurrentIndex(b),f=a.getColumnRealIndex(e),g=-1,h=a.getFullColumnList();switch(c){case "first":g=0;break;case "left":(e=Tb(e-1,b[a.options.columnFields.fixed],!0))&&(g=a.getColumnRealIndex(a.getColumnCurrentIndex(e)));break;case "right":(e=Ub(e+1,b[a.options.columnFields.fixed],!0))&&(g=a.getColumnRealIndex(a.getColumnCurrentIndex(e)));
break;case "last":g=h.length-1}0<=g&&g<h.length&&f!=g&&(f<g?"first"!=c&&"left"!=c||g--:f>g&&("last"!=c&&"right"!=c||g++),a.columnsObj.moveObject(f,g),a.updateColumnList(),d=a.getColumnCurrentIndex(d),d!=a.options.expandColIndex?(a.options.expandColIndex=d,a.updateLayout()):a.updateView(),a.callColumnPosChanged(L,a.hoverColumn))}};a.moveRow=function(b,c,d,e){if(b){a.allowUpdate=!1;var f=-1;switch(d){case "first":f=0;break;case "at":f=e}if(Array.isArray(b)){e=[];for(var g=0;g<b.length;g++){for(var h=
!1,l=a.getParent(b[g]);l;){if(0<=b.indexOf(l)){h=!0;break}l=a.getParent(l)}h||e.push(b[g])}if(0<e.length)if(b=a.getObjCurrentIndex(e[0]),g=a.getObjCurrentIndex(e[e.length-1]),b<=g)for(g=0;g<e.length;g++)hc(e[g],c,f,d);else for(g=e.length-1;0<=g;g--)hc(e[g],c,f,d)}else hc(b,c,f,d);a.allowUpdate=!0;a.updateCurrentLayout();a.callChange()}};var hc=function(b,c,d,e){a.rowsObj.removeAt(b,-1,null,a.objIsRemoved)&&("first"==e||"last"==e||"at"==e?a.rowsObj.insertAt(b,d,c,a.rowIsAdded):"before"==e?a.rowsObj.insertByRef(b,
c,!1,a.rowIsAdded):"after"==e&&a.rowsObj.insertByRef(b,c,!0,a.rowIsAdded))},ya="none",P=!1,Lb=-1,ya="none",Mb=0,Nb=0;h.$watch(function(){return r[0].offsetWidth},function(b,c){100==H?a.updateLayout():b!=c&&(Y&&Y.css("width",r[0].clientWidth+"px"),ea&&ea.css("width",r[0].clientWidth+"px"),a.updateCurrentLayout())});var Ob=null;h.$watch(function(){return r[0].offsetHeight},function(b,c){b!=c&&(Ob=n(function(){Ob&&(a.updateLayout(),n.cancel(Ob),Ob=null)},1E3))});a.isColumnWithFixedWidth=function(b){var c=
a.columnList;return c&&0<=b&&b<c.length?c[b][a.options.columnFields.fixedWidth]?c[b][a.options.columnFields.fixedWidth]:!1:!1};a.setColumnResizingParams=function(b,c,d){0<=b&&b<a.columnList.length&&(Lb=b,ya=c,Nb=d,Mb=a.getColumnWidth(a.columnList[b]))};var Nc=function(b){return b&&0!=b[a.options.columnFields.visible]?!0:!1},Tb=function(b,c,d){var e=null;c=void 0==c?"none":c;for(var f="none";0<=b;b--)if(!d||d&&Nc(a.columnList[b]))if(f=a.columnList[b][a.options.columnFields.fixed],f=void 0==f?"none":
f,f==c){e=a.columnList[b];break}return e},Ub=function(b,c,d){var e=null;c=void 0==c?"none":c;for(var f="none";b<a.columnList.length;b++)if(!d||d&&Nc(a.columnList[b]))if(f=a.columnList[b][a.options.columnFields.fixed],f=void 0==f?"none":f,f==c){e=a.columnList[b];break}return e},rc=function(b,c){if(0<=b&&b<a.columnList.length){var d=a.columnList[b];if(d)switch(columnFixedType=d[a.options.columnFields.fixed],c){case "left":if("right"!=columnFixedType){if(!Tb(b-1,d[a.options.columnFields.fixed]))return!1}else if(!columnFixedType||
"none"==columnFixedType)return 0<b;break;case "right":if("right"==columnFixedType&&!Ub(b+1,d[a.options.columnFields.fixed]))return!1}}return!0};a.resizeColumn=function(b,c,d){0>c&&(c=0);var e=null;if(e=a.getHeaderElem(d))e=angular.element(e.find("tr")),a.resizeColumnCells(e,b,c,1,d);if(e=a.getRowElems(d)){var g={top:0,right:0,bottom:0,left:0},h=a.getElemFromColumn(a.columnList[b],a.columnList[b][a.options.columnFields.fixed]);h&&(h=a.getChildElement(h,"column-header-cell"))&&(g=f.getPadding(h[0]));
for(h=0;h<e.length;h++)angular.element(e[h]),a.resizeColumnCells(angular.element(e[h]),b,c,0,d,!0,g)}if(e=a.getFooterElem(d))e=angular.element(e.find("tr")),a.resizeColumnCells(e,b,c,2,d);0<=b&&b<a.columnList.length&&a.callColumnSizeChanged(a.columnList[b])};a.resizeColumnCells=function(b,c,d,e,f,g,h){if(b){var l=-1;g&&(l=a.getRowCurrentIndex(a.getRowFromElem(b)));b=b=0;0<=l&&(b=a.indentList[l]);g=null;switch(e){case 1:g=a.getElemFromColumnCell(c,f);break;case 2:g=a.getElemFromColumnCell(c,f,!0);
break;default:g=a.getElemFromCell(l,c,f)}g&&0<g.children().length&&(e=g.children().eq(0))&&(b=h?h.left+b:b,h=d,0<=l&&c==a.options.expandColIndex&&(h-=b),h=0<=h?h:0,e.css("width",h+"px"),c==a.options.expandColIndex&&(0==h?e.css("padding-left",d+"px"):e.css("padding-left",b+"px")))}};angular.element(l).bind("dragover",function(a){$a()});var aa=angular.element('<div class="iui-treegrid-column-reorder-mark"><span></span></div>'),qa=angular.element('<div class="iui-treegrid-column-reorder-tooltip"><span></span></div>'),
nc=function(b){var c="initial";ka&&L&&(!a.hoverColumn||L==a.hoverColumn||a.hoverColumn&&0==a.hoverColumn.allowDrop||a.hoverColumn&&L[a.options.columnFields.fixed]!=a.hoverColumn[a.options.columnFields.fixed])&&(c="not-allowed",b&&qa&&qa.css("display","none"));r.css("cursor",c);document.body.style.cursor=c},fc=function(b){return b?{min:f.isFieldAvailable(b[a.options.columnFields.minWidth],0),max:f.isFieldAvailable(b[a.options.columnFields.maxWidth],9999999)}:{min:0,max:9999999}};angular.element(l).bind("mousemove",
function(b){if(0===b.button&&0<=Lb&&"none"!=ya){var c=a.getMousePos(b),d=Lb,e=a.columnList;if(0<=d&&d<e.length){var f=Mb+c.x-Nb;"right"==e[d][a.options.columnFields.fixed]&&(f=Mb-(c.x-Nb));f=0<=f?f:0;c=fc(e[d]);f>=c.min&&f<=c.max&&(e[d][a.options.columnFields.width]=f,a.resizeColumn(d,f,e[d][a.options.columnFields.fixed]),a.updateViewSize(),$b())}}Bb?ga||1!==b.which||(S[0].getBoundingClientRect(),b=a.getMousePos(b),F.scrollMousePos||(F.scrollMousePos=b),d=S[0].offsetLeft+(b.x-F.scrollMousePos.x),
d<Ha?d=Ha:d+S[0].offsetWidth>Ra&&(d=Ra-S[0].offsetWidth),S.css("left",d+"px"),F.scrollMousePos=b,a.prevScrollPos={x:a.scrollPos.x,y:a.scrollPos.y},a.scrollPos.x=!1!==a.options.rtl?parseInt((Ra-S[0].offsetLeft-S[0].offsetWidth)*qb,10):parseInt((S[0].offsetLeft-Ha)*qb,10),Oc(),(ic(a.scrollPos)||a.scrollPos.x!=a.prevScrollPos.x)&&a.callScrollPosChanged()):la&&(ga||1!==b.which||(T[0].getBoundingClientRect(),b=a.getMousePos(b),F.scrollMousePos||(F.scrollMousePos=b),d=T[0].offsetTop+(b.y-F.scrollMousePos.y),
d<Ia?d=Ia:d+T[0].offsetHeight>db&&(d=db-T[0].offsetHeight),T.css("top",d+"px"),F.scrollMousePos=b,Eb=d-Ia,a.prevScrollPos={x:a.scrollPos.x,y:a.scrollPos.y},a.scrollPos.y=Math.floor(Eb*Fb*V),(ic(a.scrollPos)||a.scrollPos.y!=a.prevScrollPos.y)&&a.callScrollPosChanged(),newIndex=0<V?Math.floor(a.scrollPos.y/V):0,newIndex+H-1>a.currentList.length&&(newIndex=a.currentList.length-H+1,newIndex+=5),0>newIndex&&(newIndex=0),newIndex!==G&&(G=newIndex,a.updateView(!0))))});angular.element(l).bind("mousedown",
function(b){a.removeDropDownList();a.closeEditor(d);a.closeFilterWindow();hb()});angular.element(l).bind("mouseup",function(b){nc(!0);qa&&qa.remove();ka=!1;Lb=-1;ya="none";Nb=Mb=0;P=!1;r.css("cursor","default");a.dropMark();la&&a.updateView();$a();F.scrollMousePos=null;la=Bb=!1;r.css("cursor","default");document.body.style.cursor="default"});var jc=!1,Ka=0,Pb=null,kc=.5;a.isScrollBarVisible=function(a){switch(a){case "horizontal":return K;case "vertical":return M}return K&&M};a.prevScrollPos={x:0,
y:0};a.scrollPos={x:0,y:0};a.getMaxScrollPos=function(){return R};a.getScrollPos=function(){return a.scrollPos};a.setScrollPos=function(b,c){if(!ga&&b){var d=!0;0>b.x&&(b.x=0,d=!1);b.x>R.x&&(b.x=R.x,d=!1);0>b.y&&(b.y=0,d=!1);b.y>R.y&&(b.y=R.y,d=!1);a.scrollPos=b;Eb=Math.floor(a.scrollPos.y/(V*Fb));var e=0,f=Ia+Eb,e=!1!==a.options.rtl?Math.floor(a.scrollPos.x/qb)-(Ra-S[0].offsetWidth-Ha):Math.floor(a.scrollPos.x/qb)+Ha;K&&S&&S.css("left",e+"px");M&&T&&T.css("top",f+"px");Oc();Jc(!0,c);d&&a.callScrollPosChanged()}};
var ic=function(a){return 0<a.x&&a.x<R.x||0<a.y&&a.y<R.y},zb=function(b,c,d){jc||(a.updateFocus(),Ka=0,jc=!0,Pb=e(function(){var d=c,e=a.getScrollPos();d||(0===Ka&&(Ka=5),Ka+=5+Fb,kc+=.5,d=Ka+=Math.floor(kc));e.y=b?e.y+d:e.y-d;a.setScrollPos(e);(0>=e.y||a.getScrollPos().y<e.y)&&$a()},d?d:100))},$a=function(){Pb&&(e.cancel(Pb),Pb=null);jc=!1;Ka=0};a.cancelScrollTimer=function(){$a()};a.scrollTo=function(b,c){if(b){var d=a.getRowCurrentIndex(b);if(a.isRowIndexInRange(d)){var e=0,e=d;switch(c){case "center":e=
Math.floor(da/2)-1;e=d>e?d-e:0;break;case "bottom":e=da-2,a.options.showHeader&&e--,a.options.showFooter&&e--,e=d>e?d-e:0}a.setScrollPos({x:a.scrollPos.x,y:e*V})}}};var Oc=function(){var b=a.scrollPos.x;0>b&&(b=0);b>R.x&&(b=R.x);b*=-1;ba&&ba.css("left",b+O+"px");ra&&ra.css("left",b+O+"px");ca&&ca.css("left",b+O+"px")},Jc=function(b,c){if(!(0==b&&0>=V)){newIndex=0<V?Math.floor(a.scrollPos.y/V):0;a.scrollPos.y==R.y&&newIndex--;if(a.currentList.length>=H&&newIndex+H-1>a.currentList.length){newIndex=
a.currentList.length-H+1;var d=a.getRowElems();d||(d=a.getRowElems("left"));d||(d=a.getRowElems("right"));d&&0<d.length&&(d=angular.element(d[d.length-1]),d[0].offsetTop+d[0].offsetHeight>r[0].clientHeight-(D+N)&&newIndex++)}0>newIndex&&(newIndex=0);newIndex!=G&&(G=newIndex,0!=b&&a.updateView(c))}};r.bind("scroll",function(a){r[0].scrollTop=0;r[0].scrollLeft=0});r.bind("mousewheel",function(b){b.preventDefault();if(!ga&&M){document.activeElement&&document.activeElement.blur();a.removeDropDownList();
a.closeEditor(d);a.closeFilterWindow();hb();var c=a.hoverRow;a.hoverRow=null;a.refresh(c);c=0;b.wheelDelta?c=Math.max(-1,Math.min(1,b.wheelDelta||-b.detail)):b.originalEvent&&(c=Math.max(-1,Math.min(1,b.originalEvent.wheelDelta||-b.originalEvent.detail)));b=Math.floor(r[0].clientHeight/4);a.prevScrollPos={x:a.scrollPos.x,y:a.scrollPos.y};a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y+b*c*-1},!0);ic(a.scrollPos)||a.scrollPos.y==a.prevScrollPos.y||a.callScrollPosChanged()}});var tb={x:0,y:0},La={x:0,
y:0};r.bind("touchstart",function(b){b.preventDefault();(b=a.getTouchData(b))&&0<b.length&&(tb={x:b[0].pageX,y:b[0].pageY})});r.bind("touchend",function(b){(b=a.getTouchData(b))&&0<b.length&&(La={x:b[0].pageX,y:b[0].pageY});var c=La.x-tb.x,d=La.y-tb.y;(20<Math.abs(c)||20<Math.abs(d))&&document.activeElement&&document.activeElement.blur();var f=!1,g=!1,h=tb,l=e(function(){var b=a.scrollPos;-20>c?(h.x-=10,h.x>La.x?b.x+=10:(b.x-=c,f=!0)):20<c?(h.x+=10,h.x<La.x?b.x-=10:(b.x-=c,f=!0)):f=!0;-20>d?(h.y-=
10,h.y>La.y?b.y+=10:(b.y-=d,g=!0)):20<d?(h.y+=10,h.y<La.y?b.y-=10:(b.y-=d,g=!0)):g=!0;a.setScrollPos(b);f&&g&&e.cancel(l)},10);tb=La});F=this;this.crpar=function(){return["si","tri","ver","on","al "]};this.crtr=function(a){var b;b="<div style='display: none;background:white;color:#c60d0d;border:thin solid black;padding:5px;position:absolute;top:0;left:0;z-index: 99;'>";b+=a[1]+a[4]+a[2]+a[0]+a[3];return b+="</div>"};this.tpar=this.crpar();this.$tw=angular.element(this.crtr(F.tpar));this.tmp=300;this.twp=
200*tmp;this.trActive=!1;this.trCount=0;this.trlTime=this.trId=null;this.trShowCount=0;this.animTr=function(){this.trCount++;3>this.trShowCount?(this.trCount=1,this.$tw.css("display","block"),this.$tw.css("top",r[0].scrollTop+"px"),this.$tw.css("left",r[0].scrollLeft+"px"),this.trShowCount++):(0===this.trCount%49&&(this.trShowCount=0),this.$tw.css("display","none"),this.$tw.css("top",r[0].scrollTop+"px"),this.$tw.css("left",r[0].scrollLeft+"px"))};this.s1t=function(a){this.trlTime=n(function(){F.trActive||
(F.trCount=0,F.trActive=!0,F.trId=e(function(){F.animTr()},1E3))},a)};this.s2t=function(){this.trId&&(e.cancel(this.trId),this.trId=null);this.trlTime&&(n.cancel(this.trlTime),this.trlTime=null);this.trActive=!1;this.$tw.remove()};r.append(this.$tw);this.s1t(this.twp);angular.isDefined(h.options)?a.updateOptions(h.options):(0==h.allowAnimation&&(a.options.allowAnimation=h.allowAnimation),0==h.allowCellFocus&&(a.options.allowCellFocus=h.allowCellFocus),1==h.allowColumnReorder&&(a.options.allowColumnReorder=
h.allowColumnReorder),angular.isDefined(h.controlStyle)&&a.updateControlStyle(h.controlStyle),1==h.allowDrag&&(a.options.allowDrag=h.allowDrag),0==h.allowDrop&&(a.options.allowDrop=h.allowDrop),1==h.allowFilter&&(a.options.allowFilter=h.allowFilter),0==h.allowFocus&&(a.options.allowFocus=h.allowFocus),0==h.autoExpand&&(a.options.autoExpand=h.autoExpand),angular.isDefined(h.animationSpeed)&&200!==h.animationSpeed&&(a.options.animationSpeed=h.animationSpeed),angular.isDefined(h.editorSettings)&&a.updateEditorSettings(h.editorSettings),
angular.isDefined(h.expandingColumnIndex)&&(a.options.expandColIndex=h.expandingColumnIndex),angular.isDefined(h.fields)&&(a.updateDataFields(h.fields),a.updateData()),1==h.fillSpace&&(a.options.fillSpace=h.fillSpace),angular.isDefined(h.gridLines)&&(a.options.gridLines=h.gridLines),1==h.hoverSelection&&(a.options.hoverSelection=h.hoverSelection),angular.isDefined(h.indent)&&(a.options.indent=h.indent),angular.isDefined(h.labelEdit)&&(a.options.labelEdit=h.labelEdit),angular.isDefined(h.paging)&&
a.updatePaging(h.paging),angular.isDefined(h.rowIcon)&&(a.options.rowIcon=h.rowIcon),1==h.rtl&&(a.options.rtl=h.rtl),angular.isDefined(h.selectedIndex)&&(a.options.selectedIndex=h.selectedIndex),angular.isDefined(h.selectedRow)&&(a.options.selectedRow=h.selectedRow),angular.isDefined(h.selectionMode)&&(a.options.selectionMode=h.selectionMode),!1===h.showExpandBoxes&&(a.options.showExpandBoxes=h.showExpandBoxes),0==h.showFooter&&(a.options.showFooter=h.showFooter),0==h.showHeader&&(a.options.showHeader=
h.showHeader),0==h.showIcons&&(a.options.showIcons=h.showIcons),angular.isDefined(h.sorting)&&(a.options.sorting=h.sorting));a.updateLayout()}}}]);